<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>百度地图开放平台 CRM</title>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ant Design CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/5.12.5/reset.min.css" />
    <!-- Ant Design JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.11.10/dayjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/antd/5.12.5/antd.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <!-- ECharts WordCloud Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #f5f7fa;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
            overflow: hidden;
        }

        /* 左侧深色侧边栏样式 */
        .dark-sider {
            background: #001529 !important;
            color: #fff;
        }

        .dark-sider .ant-menu {
            background: #001529 !important;
            color: rgba(255, 255, 255, 0.85);
            border-right: none;
        }

        .dark-sider .ant-menu-item,
        .dark-sider .ant-menu-submenu-title {
            color: rgba(255, 255, 255, 0.85) !important;
            margin: 4px 8px;
            border-radius: 4px;
            height: 40px;
            line-height: 40px;
        }

        .dark-sider .ant-menu-item:hover,
        .dark-sider .ant-menu-submenu-title:hover {
            background-color: rgba(255, 255, 255, 0.08) !important;
            color: #fff !important;
        }

        .dark-sider .ant-menu-item-selected {
            background-color: #1890ff !important;
            color: #fff !important;
        }

        .dark-sider .ant-menu-item-selected::after {
            display: none;
        }

        .dark-sider .ant-menu-submenu-selected > .ant-menu-submenu-title {
            color: #fff !important;
        }

        .dark-sider .ant-menu-submenu-open > .ant-menu-submenu-title {
            color: #fff !important;
        }

        .dark-sider .ant-menu-submenu-inline > .ant-menu-submenu-title .ant-menu-submenu-arrow {
            color: rgba(255, 255, 255, 0.65);
        }

        .dark-sider .ant-menu-submenu-inline.ant-menu-submenu-open > .ant-menu-submenu-title .ant-menu-submenu-arrow {
            color: #fff;
        }

        /* 重置所有菜单项的padding */
        .dark-sider .ant-menu-item,
        .dark-sider .ant-menu-submenu-title {
            padding-left: 16px !important;
        }

        /* 一级菜单项和submenu标题 - 所有一级菜单对齐 */
        .dark-sider .ant-menu-root > .ant-menu-item,
        .dark-sider .ant-menu-root > .ant-menu-submenu > .ant-menu-submenu-title {
            padding-left: 16px !important;
        }

        /* 二级菜单项 - 缩进一级（在一级submenu下的菜单项和submenu标题） */
        .dark-sider .ant-menu-submenu-inline > .ant-menu {
            background: transparent !important;
        }

        .dark-sider .ant-menu-submenu-inline > .ant-menu > .ant-menu-item,
        .dark-sider .ant-menu-submenu-inline > .ant-menu > .ant-menu-submenu > .ant-menu-submenu-title {
            padding-left: 48px !important;
        }

        /* 三级菜单项 - 再缩进一级（在二级submenu下的菜单项） */
        .dark-sider .ant-menu-submenu-inline > .ant-menu > .ant-menu-submenu-inline > .ant-menu > .ant-menu-item {
            padding-left: 72px !important;
        }

        .dark-sider .ant-menu-inline .ant-menu-item.ant-menu-item-selected {
            background-color: #1890ff !important;
        }

        /* Logo区域 */
        .sider-logo {
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        /* 菜单滚动容器 */
        .menu-scroll-container {
            /* 减去顶部 Logo(40px) 和底部 Trigger(48px) 的高度 */
            height: calc(100vh - 40px - 48px);
            overflow-y: auto;
            overflow-x: hidden;
        }

        .menu-scroll-container::-webkit-scrollbar {
            width: 6px;
        }

        .menu-scroll-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .menu-scroll-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        .menu-scroll-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* 顶部导航栏样式 */
        .light-header {
            background: #ffffff;
            color: #333;
            padding: 0 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 4px rgba(0,0,0,0.05);
            border-bottom: 1px solid #f0f0f0;
            height: 40px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .notification-icon {
            position: relative;
            cursor: pointer;
            padding: 6px;
            border-radius: 4px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 28px;
            width: 28px;
        }

        .notification-icon:hover {
            background-color: #f5f5f5;
        }

        .notification-badge {
            position: absolute;
            top: 3px;
            right: 3px;
            width: 6px;
            height: 6px;
            background: #ff4d4f;
            border-radius: 50%;
            border: 1.5px solid #fff;
        }

        /* 主内容区域 */
        .main-content {
            background: #f5f7fa;
            padding: 0;
            overflow-y: auto;
            height: calc(100vh - 40px);
        }

        .content-card {
            background: #fff;
            border-radius: 0;
            padding: 8px 12px;
            box-shadow: none;
        }
        
        /* 固定标题栏样式 */
        .fixed-header {
            position: sticky;
            top: 0;
            background: #fff;
            z-index: 100;
            padding: 16px 12px 12px;
            border-bottom: 1px solid #f0f0f0;
            margin: -8px -12px 16px -12px;
        }

        /* 搜索筛选区域 */
        .search-section {
            background: #fff;
            padding: 8px 12px;
            border-radius: 0;
            margin-bottom: 6px;
            box-shadow: none;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 8px 10px;
            flex-wrap: wrap;
        }

        .search-left {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .search-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* 表格操作按钮区域 */
        .table-actions {
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .table-actions-left {
            display: flex;
            gap: 12px;
        }

        .table-actions-right {
            display: flex;
            align-items: center;
            gap: 16px;
            color: #666;
            font-size: 14px;
        }

        .refresh-info .icon-btn {
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .refresh-info .icon-btn:hover {
            background-color: #f5f5f5;
        }

        /* 表格样式 */
        .ant-table-thead > tr > th {
            background-color: #fafafa !important;
            font-weight: 500 !important;
        }

        /* 表格固定列样式 */
        .ant-table-wrapper {
            position: relative;
        }

        .ant-table-container {
            overflow-x: auto !important;
        }

        .ant-table-body {
            overflow-x: auto !important;
        }

        .ant-table {
            min-width: 100%;
        }

        /* 固定左侧列（复选框列） */
        .ant-table-thead > tr > th:first-child,
        .ant-table-tbody > tr > td:first-child {
            position: sticky !important;
            left: 0 !important;
            z-index: 10 !important;
            background-color: #fafafa !important;
            box-shadow: 2px 0 4px rgba(0,0,0,0.05);
        }

        .ant-table-tbody > tr > td:first-child {
            background-color: #fff !important;
        }

        .ant-table-tbody > tr:hover > td:first-child {
            background-color: #fafafa !important;
        }

        .ant-table-tbody > tr.ant-table-row-selected > td:first-child {
            background-color: #e6f7ff !important;
        }

        /* 固定右侧列（操作列） */
        .ant-table-thead > tr > th:last-child,
        .ant-table-tbody > tr > td:last-child {
            position: sticky !important;
            right: 0 !important;
            z-index: 10 !important;
            background-color: #fafafa !important;
            box-shadow: -2px 0 4px rgba(0,0,0,0.05);
        }

        .ant-table-tbody > tr > td:last-child {
            background-color: #fff !important;
        }

        .ant-table-tbody > tr:hover > td:last-child {
            background-color: #fafafa !important;
        }

        .ant-table-tbody > tr.ant-table-row-selected > td:last-child {
            background-color: #e6f7ff !important;
        }

        /* 排序图标样式 */
        .rank-sorter {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            margin-left: 4px;
            vertical-align: middle;
        }

        .rank-sorter-icon {
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-bottom: 6px solid #bfbfbf;
            cursor: pointer;
            transition: all 0.3s;
        }

        .rank-sorter-icon:hover {
            border-bottom-color: #1890ff;
        }

        .rank-sorter-icon.active {
            border-bottom-color: #1890ff;
        }

        /* Lucide icon alignment */
        .lucide {
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
        }

        /* 侧边栏触发器 */
        .ant-layout-sider-trigger {
            background: #002140 !important;
            color: #fff;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .ant-layout-sider-trigger:hover {
            background: #001529 !important;
        }

        /* 分页组件样式优化 */
        .ant-pagination {
            margin: 8px 0 4px 0 !important;
        }

        /* 表格容器优化 */
        .ant-table-wrapper {
            margin-bottom: 0 !important;
        }

        .ant-table-container {
            margin-bottom: 0 !important;
        }

        /* 聊天详情样式 */
        .drawer-search-box {
            display: flex;
            align-items: center;
            background: #fff;
            border: 1px solid #d0d0d0;
            border-radius: 4px;
            padding: 4px 8px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            min-width: 250px;
            max-width: 350px;
        }

        .drawer-search-input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 13px;
            padding: 2px 4px;
            color: #333;
        }

        .drawer-search-input::placeholder {
            color: #999;
        }

        .drawer-search-navigation {
            display: flex;
            flex-direction: column;
            margin: 0 4px;
            border-left: 1px solid #e0e0e0;
            padding-left: 4px;
        }

        .drawer-search-nav-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 2px 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            transition: background-color 0.2s;
        }

        .drawer-search-nav-btn:hover:not(:disabled) {
            background-color: #f0f0f0;
        }

        .drawer-search-nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .drawer-search-count {
            font-size: 12px;
            color: #666;
            margin: 0 6px;
            min-width: 35px;
            text-align: center;
        }

        .drawer-search-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 2px 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            margin-left: 4px;
            border-left: 1px solid #e0e0e0;
            padding-left: 6px;
        }

        .drawer-search-close:hover {
            color: #333;
        }

        .search-highlight {
            background-color: #ffeb3b;
            padding: 0 2px;
            border-radius: 2px;
        }

        .search-match {
            background-color: #fff3cd;
            transition: background-color 0.3s;
        }

        .search-highlight-active {
            background-color: #ffc107 !important;
            animation: search-pulse 1s ease-in-out;
        }

        @keyframes search-pulse {
            0%, 100% { background-color: #ffc107; }
            50% { background-color: #ffeb3b; }
        }

        .chat-detail-container {
            padding: 16px;
            padding-bottom: 0;
            background-color: #ededed;
            flex: 1;
            overflow-y: auto;
            min-height: 0;
        }

        .chat-message {
            display: flex;
            margin-bottom: 16px;
            align-items: flex-start;
        }

        .chat-message.me {
            justify-content: flex-end;
        }

        .chat-avatar {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 16px;
            font-weight: bold;
        }

        .chat-avatar.me {
            background-color: #1890ff;
        }

        .chat-avatar.other {
            background-color: #52c41a;
        }

        .chat-content-wrapper {
            max-width: 60%;
            margin: 0 12px;
            display: flex;
            flex-direction: column;
        }

        .chat-message.me .chat-content-wrapper {
            align-items: flex-end;
        }

        .chat-message:not(.me) .chat-content-wrapper {
            align-items: flex-start;
        }

        .chat-name-time {
            font-size: 12px;
            color: #999;
            margin-bottom: 4px;
            padding: 0 4px;
        }

        .chat-bubble {
            padding: 8px 12px;
            border-radius: 8px;
            word-break: break-word;
            font-size: 14px;
            line-height: 1.5;
            position: relative;
        }

        .chat-bubble.me {
            background-color: #95ec69;
            color: #000;
        }

        .chat-bubble.other {
            background-color: #fff;
            color: #333;
        }

        .chat-bubble.recall {
            background-color: transparent;
            color: #999;
            font-style: italic;
            font-size: 12px;
        }

        /* 消息类型特殊样式 */
        .message-image, .message-video, .message-link, .message-card, .message-location {
            padding: 8px;
            background-color: rgba(0,0,0,0.05);
            border-radius: 4px;
            display: flex;
            align-items: center;
        }

        .message-voice {
            display: flex;
            align-items: center;
        }

        .message-file {
            display: flex;
            align-items: center;
            padding: 4px 0;
        }

        .message-redpack {
            padding: 12px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            border-radius: 8px;
            color: #fff;
            text-align: center;
            min-width: 120px;
        }

        .message-miniprogram {
            padding: 12px;
            background-color: #07c160;
            border-radius: 8px;
            color: #fff;
            min-width: 150px;
        }

        /* 图片消息样式 */
        .message-image-container {
            max-width: 200px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
        }

        .message-image-container img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* 语音消息样式 */
        .message-voice-container {
            display: flex;
            align-items: center;
            min-width: 120px;
            padding: 8px 12px;
        }

        .voice-play-btn {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-right: 8px;
            flex-shrink: 0;
        }

        .voice-duration {
            font-size: 14px;
            margin-right: 8px;
            min-width: 30px;
        }

        .voice-wave {
            flex: 1;
            height: 20px;
            background: repeating-linear-gradient(
                90deg,
                #999 0px,
                #999 2px,
                transparent 2px,
                transparent 4px
            );
            border-radius: 2px;
        }

        .voice-transcript {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid rgba(0,0,0,0.1);
            font-size: 12px;
            color: #666;
            line-height: 1.5;
        }

        .chat-bubble.me .voice-transcript {
            border-top-color: rgba(255,255,255,0.3);
            color: rgba(0,0,0,0.7);
        }

        /* 文件消息样式 */
        .message-file-container {
            display: flex;
            align-items: center;
            padding: 8px;
            background-color: rgba(0,0,0,0.03);
            border-radius: 4px;
            min-width: 200px;
        }

        .file-icon {
            width: 48px;
            height: 48px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .file-icon.pdf {
            background-color: #dc3545;
            color: #fff;
        }

        .file-info {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            word-break: break-all;
        }

        .file-size {
            font-size: 12px;
            color: #999;
        }

        /* 链接消息样式 */
        .message-link-card {
            width: 280px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: #fff;
            cursor: pointer;
        }

        .link-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            display: block;
        }

        .link-content {
            padding: 12px;
        }

        .link-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 6px;
            color: #333;
            line-height: 1.4;
        }

        .link-desc {
            font-size: 12px;
            color: #999;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* 红包消息样式 */
        .message-redpack-card {
            width: 200px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            border-radius: 8px;
            padding: 16px;
            color: #fff;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .redpack-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .redpack-amount {
            font-size: 24px;
            font-weight: bold;
            margin: 8px 0;
        }

        .redpack-text {
            font-size: 14px;
            opacity: 0.95;
        }

        .redpack-decor {
            position: absolute;
            top: -20px;
            right: -20px;
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }

        /* 名片消息样式 */
        .message-card-container {
            width: 240px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            background: #fff;
            cursor: pointer;
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .card-avatar {
            width: 40px;
            height: 40px;
            border-radius: 4px;
            margin-right: 10px;
            background-color: #1890ff;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .card-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 4px;
        }

        .card-info {
            flex: 1;
            min-width: 0;
        }

        .card-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
            color: #333;
        }

        .card-title {
            font-size: 12px;
            color: #999;
        }

        .card-company {
            font-size: 12px;
            color: #666;
            padding-top: 8px;
            border-top: 1px solid #f0f0f0;
            margin-top: 8px;
        }

        /* 位置消息样式 */
        .message-location-container {
            width: 280px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: #fff;
            cursor: pointer;
        }

        .location-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
        }

        .location-content {
            padding: 12px;
        }

        .location-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            color: #333;
        }

        .location-address {
            font-size: 12px;
            color: #999;
            line-height: 1.4;
        }

        /* 小程序消息样式 */
        .message-miniprogram-card {
            width: 280px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            background: #fff;
            cursor: pointer;
        }

        .mp-header {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #07c160;
            color: #fff;
        }

        .mp-icon {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .mp-title {
            font-size: 14px;
            font-weight: 500;
        }

        .mp-body {
            display: flex;
            padding: 12px;
        }

        .mp-image {
            width: 60px;
            height: 60px;
            border-radius: 4px;
            margin-right: 12px;
            flex-shrink: 0;
            object-fit: cover;
        }

        .mp-content {
            flex: 1;
            min-width: 0;
        }

        .mp-name {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            color: #333;
        }

        .mp-desc {
            font-size: 12px;
            color: #999;
            line-height: 1.4;
        }

        /* 撤回消息样式 */
        .message-recall {
            font-style: italic;
            opacity: 0.6;
            font-size: 12px;
        }

        .message-recall-content {
            margin-top: 6px;
            padding: 6px 8px;
            background-color: rgba(0,0,0,0.05);
            border-radius: 4px;
            font-size: 14px;
            font-style: normal;
            opacity: 0.8;
            line-height: 1.4;
        }

        .chat-bubble.me .message-recall-content {
            background-color: rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { Layout, Menu, Button, Input, Table, Select, Space, Badge, ConfigProvider, Form, Radio, TreeSelect, Tag, message, Drawer, Avatar, Modal } = antd;
        const { Header, Sider, Content } = Layout;
        const { Search } = Input;
        const { Option } = Select;
        const { RangePicker } = antd.DatePicker;
        const { TextArea } = Input;

        // 工作台组件
        const Workbench = () => {
            const stats = [
                { title: '私海客户数', value: 2 },
                { title: '商机用户数', value: 1 },
                { title: '成单客户数', value: 0 },
                { title: '申请商用授权数', value: 0 },
            ];

            return (
                <div style={{ padding: '8px 12px' }}>
                     <h2 className="text-xl font-semibold text-gray-800 mb-2" style={{ marginBottom: '6px' }}>工作台</h2>
                     
                     {/* 顶部卡片 */}
                     <div className="grid grid-cols-4 gap-4">
                         {stats.map((stat, index) => (
                             <div key={index} className="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                                 <div className="text-gray-500 text-sm mb-2">{stat.title}</div>
                                 <div className="text-3xl font-semibold text-gray-800">{stat.value}</div>
                             </div>
                         ))}
                     </div>

                     <div className="grid grid-cols-3 gap-4">
                         {/* 左侧两列 - 待办 */}
                         <div className="col-span-2 space-y-4">
                             <div className="bg-white p-4 rounded-lg shadow-sm border border-gray-100 h-full">
                                 <div className="text-base font-medium mb-4 text-gray-700">待办</div>
                                 <div className="grid grid-cols-2 gap-4">
                                     {/* 待办卡片 1 */}
                                     <div className="border border-gray-100 rounded-lg p-5 flex flex-col justify-between h-40 hover:shadow-md transition-shadow relative overflow-hidden">
                                         <div>
                                             <div className="flex items-center gap-2 mb-3">
                                                 <div className="w-8 h-8 rounded bg-green-50 text-green-600 flex items-center justify-center">
                                                     <i data-lucide="user-plus" className="w-5 h-5"></i>
                                                 </div>
                                                 <span className="font-medium text-gray-800">线索新增联系人</span>
                                             </div>
                                             <div className="text-gray-500 text-sm pl-1">您有<span className="font-bold text-gray-800 mx-1">1</span>条新增了联系人的线索待查看</div>
                                         </div>
                                         <a className="text-blue-500 text-sm hover:underline cursor-pointer font-medium mt-2 inline-block">查看</a>
                                     </div>
                                     {/* 待办卡片 2 */}
                                     <div className="border border-gray-100 rounded-lg p-5 flex flex-col justify-between h-40 hover:shadow-md transition-shadow relative overflow-hidden">
                                         <div>
                                             <div className="flex items-center gap-2 mb-3">
                                                 <div className="w-8 h-8 rounded bg-green-50 text-green-600 flex items-center justify-center">
                                                     <i data-lucide="clock" className="w-5 h-5"></i>
                                                 </div>
                                                 <span className="font-medium text-gray-800">线索即将到期</span>
                                             </div>
                                             <div className="text-gray-500 text-sm pl-1">您有<span className="font-bold text-gray-800 mx-1">1</span>条即将到期的线索待处理</div>
                                         </div>
                                         <a className="text-blue-500 text-sm hover:underline cursor-pointer font-medium mt-2 inline-block">查看</a>
                                     </div>
                                 </div>
                                 {/* 下方长卡片 */}
                                 <div className="mt-4 border border-gray-100 rounded-lg p-5 flex flex-col justify-between h-40 hover:shadow-md transition-shadow relative overflow-hidden">
                                      <div>
                                         <div className="flex items-center gap-2 mb-3">
                                             <div className="w-8 h-8 rounded bg-blue-50 text-blue-600 flex items-center justify-center">
                                                 <i data-lucide="folder-down" className="w-5 h-5"></i>
                                             </div>
                                             <span className="font-medium text-gray-800">新下发线索</span>
                                         </div>
                                         <div className="text-gray-500 text-sm pl-1">您有<span className="font-bold text-gray-800 mx-1">1</span>条新下发线索待查看</div>
                                     </div>
                                     <a className="text-blue-500 text-sm hover:underline cursor-pointer font-medium mt-2 inline-block">查看</a>
                                 </div>
                             </div>
                         </div>

                         {/* 右侧一列 - 计划和通知 */}
                         <div className="col-span-1 space-y-4">
                             {/* 本月计划 */}
                             <div className="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                                 <div className="text-base font-medium mb-5 text-gray-700">本月计划</div>
                                 <div className="mb-6">
                                     <div className="flex justify-between text-sm mb-2 font-medium text-gray-600">
                                         <span>本月联系计划</span>
                                         <span>10840 / 42113</span>
                                     </div>
                                     <div className="w-full bg-gray-100 rounded-full h-2">
                                         <div className="bg-blue-500 h-2 rounded-full" style={{width: '25%'}}></div>
                                     </div>
                                 </div>
                                 <div className="flex justify-between text-xs text-gray-500 pt-2">
                                     <div>今日有效联系数: <span className="text-gray-900 font-medium ml-1">348</span> 个</div>
                                     <div>今日有效通话总时长: <span className="text-gray-900 font-medium ml-1">12:51:39</span></div>
                                 </div>
                             </div>

                             {/* 通知 */}
                             <div className="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                                 <div className="flex justify-between items-center mb-4">
                                     <div className="text-base font-medium text-gray-700">通知</div>
                                     <a className="text-blue-500 text-xs hover:underline cursor-pointer">全部清空</a>
                                 </div>
                                 <div className="mb-4">
                                     <RangePicker size="middle" style={{width: '100%'}} placeholder={['开始日期', '结束日期']} />
                                 </div>
                                 <div className="space-y-4">
                                     {/* 通知列表项 */}
                                     {[
                                         { title: '新增关联客户', time: '2026-01-15 00:00', content: '' },
                                         { title: '官网咨询通知', time: '2026-01-14 15:25', content: '您好, 客户好奇宝宝(线索ID: 477958)在官网咨询了开放平台官网，请及时跟进。' },
                                         { title: '客户商用授权通知', time: '2026-01-14 14:55', content: '客户:好奇宝宝(ID:865693804)申请商用授权成功，商机(ID:22539)状态已更新，请及时沟通！' },
                                         { title: '官网咨询通知', time: '2026-01-14 12:10', content: '您好, 客户好奇宝宝(线索ID: 477958)在官网咨询了开放平台官网，请及时跟进。' }
                                     ].map((item, i) => (
                                         <div key={i} className="flex gap-3 items-start border-b border-gray-50 pb-4 last:border-0 last:pb-0 pt-1">
                                             <div className="w-8 h-8 rounded-full bg-teal-400 text-white flex items-center justify-center shrink-0 mt-1">
                                                 <i data-lucide="volume-2" className="w-4 h-4"></i>
                                             </div>
                                             <div className="flex-1 min-w-0">
                                                 <div className="flex justify-between items-start mb-1">
                                                     <div className="font-medium text-sm text-gray-800 truncate">{item.title}</div>
                                                 </div>
                                                 <div className="text-xs text-gray-400 mb-2">{item.time}</div>
                                                 {item.content && <div className="text-xs text-gray-500 leading-relaxed mb-2">{item.content}</div>}
                                                 <div className="text-right">
                                                      <a className="text-blue-500 text-xs hover:underline cursor-pointer">详情</a>
                                                 </div>
                                             </div>
                                         </div>
                                     ))}
                                 </div>
                             </div>
                         </div>
                     </div>
                     
                     <div className="text-center text-gray-400 text-xs mt-8 pb-4">
                         © 2026 百度地图开放平台CRM
                     </div>
                </div>
            );
        };

        // 占位组件 - 功能开发中
        const ComingSoon = () => (
            <div className="flex flex-col items-center justify-center h-full bg-white rounded-lg shadow-sm p-8" style={{ minHeight: 'calc(100vh - 112px)' }}>
                <div className="bg-blue-50 p-6 rounded-full mb-6">
                    <i data-lucide="hammer" className="w-12 h-12 text-blue-500"></i>
                </div>
                <h2 className="text-2xl font-medium text-gray-800 mb-3">功能开发中…</h2>
            </div>
        );

        // ========== 通用组件：通话详情抽屉 ==========
        const CallDetailDrawer = ({ 
            visible,           // 控制抽屉显示/隐藏
            onClose,           // 关闭回调
            callDetail,        // 通话详情数据对象
            callTranscripts,   // 通话转文字记录 {key: [messages]}
            activeTab,         // 当前激活的Tab（可选）
            onTabChange        // Tab切换回调（可选）
        }) => {
            const [internalTab, setInternalTab] = React.useState(activeTab || 'callDetail');
            
            // 同步外部Tab状态
            React.useEffect(() => {
                if (activeTab) {
                    setInternalTab(activeTab);
                }
            }, [activeTab]);
            
            // 重置Tab（抽屉打开时）
            React.useEffect(() => {
                if (visible) {
                    setInternalTab('callDetail');
                    onTabChange?.('callDetail');
                }
            }, [visible]);
            
            const handleTabChange = (tab) => {
                setInternalTab(tab);
                onTabChange?.(tab);
            };
            
            if (!callDetail) return null;
            const isConnected = callDetail.connectStatus === '已接通';
            
            return (
                <Drawer
                    title={
                        // Tab导航区
                        <div style={{ 
                            display: 'flex', 
                            borderBottom: '1px solid #e8e8e8',
                            marginTop: '8px',
                            marginLeft: '-24px',
                            marginRight: '-24px',
                            paddingLeft: '24px'
                        }}>
                            <div
                                onClick={() => handleTabChange('callDetail')}
                                style={{
                                    padding: '12px 16px',
                                    cursor: 'pointer',
                                    borderBottom: internalTab === 'callDetail' ? '2px solid #1890ff' : '2px solid transparent',
                                    color: internalTab === 'callDetail' ? '#1890ff' : '#666',
                                    fontWeight: internalTab === 'callDetail' ? 500 : 400,
                                    fontSize: '14px',
                                    transition: 'all 0.3s'
                                }}
                            >
                                通话详情
                            </div>
                            <div
                                onClick={() => handleTabChange('callSummary')}
                                style={{
                                    padding: '12px 16px',
                                    cursor: 'pointer',
                                    borderBottom: internalTab === 'callSummary' ? '2px solid #1890ff' : '2px solid transparent',
                                    color: internalTab === 'callSummary' ? '#1890ff' : '#666',
                                    fontWeight: internalTab === 'callSummary' ? 500 : 400,
                                    fontSize: '14px',
                                    transition: 'all 0.3s'
                                }}
                            >
                                通话总结
                            </div>
                        </div>
                    }
                    placement="right"
                    onClose={onClose}
                    open={visible}
                    width="66.666%"
                    closable={true}
                    style={{ zIndex: 1100 }}
                    bodyStyle={{ paddingTop: '8px' }}
                >
                    {callDetail && (
                        <div>
                            {/* ========== Tab 1: 通话详情 ========== */}
                            {internalTab === 'callDetail' && (
                                <div>
                                    {/* 外呼基本信息 */}
                                    <div style={{
                                        backgroundColor: '#fff',
                                        padding: '16px',
                                        marginBottom: '16px',
                                        borderRadius: '4px'
                                    }}>
                                        <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0, marginBottom: '16px' }}>外呼基本信息</h3>
                                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话ID:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.callId || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>联系人姓名:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.contactName || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>被叫号码:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.calleeNumber || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>任务名称:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.taskName || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>机器人名称:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.robotName || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>触发短信:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.smsTriggered || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话开始时间:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.callStartTime || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话时长:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.callDuration || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话结束时间:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.callEndTime || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>接通状态:</span><span style={{ marginLeft: '8px', fontSize: '14px', display: 'inline-flex', alignItems: 'center' }}><span style={{ width: '8px', height: '8px', borderRadius: '50%', backgroundColor: isConnected ? '#52c41a' : '#ff4d4f', marginRight: '6px' }}></span>{callDetail.connectStatus || '-'}</span></div>
                                            <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>未接通原因:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.noConnectReason || '-'}</span></div>
                                        </div>
                                    </div>

                                    {/* 通话录音 */}
                                    {callDetail.recordingUrl && (
                                        <div style={{ backgroundColor: '#fff', padding: '16px', marginBottom: '16px', borderRadius: '4px' }}>
                                            <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0, marginBottom: '16px' }}>通话录音</h3>
                                            <audio controls src={callDetail.recordingUrl} style={{ width: '100%', height: 40 }} />
                                        </div>
                                    )}

                                    {/* 通话转文字 */}
                                    {isConnected && callTranscripts && callTranscripts[callDetail.key] && (
                                        <div style={{ backgroundColor: '#fff', padding: '16px', marginBottom: '16px', borderRadius: '4px' }}>
                                            <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0, marginBottom: '16px' }}>通话转文字</h3>
                                            <div style={{ maxHeight: '300px', overflowY: 'auto', background: '#EDEDED', padding: '16px', borderRadius: '8px' }}>
                                                {callTranscripts[callDetail.key].map((msg) => {
                                                    const isRobot = msg.role === 'robot';
                                                    return (
                                                        <div key={msg.id} style={{ display: 'flex', justifyContent: isRobot ? 'flex-end' : 'flex-start', marginBottom: '12px' }}>
                                                            {!isRobot && <Avatar style={{ backgroundColor: '#ffffff', color: '#666', marginRight: '8px' }} size={28}><i data-lucide="user" style={{ width: '14px', height: '14px' }}></i></Avatar>}
                                                            <div style={{ maxWidth: '70%', backgroundColor: isRobot ? '#95EC69' : '#ffffff', color: '#000000', padding: '8px 12px', borderRadius: 12, borderTopLeftRadius: isRobot ? 12 : 2, borderTopRightRadius: isRobot ? 2 : 12, boxShadow: '0 1px 2px rgba(0,0,0,0.06)', fontSize: '13px', lineHeight: 1.6, whiteSpace: 'pre-wrap' }}>{msg.text}</div>
                                                            {isRobot && <Avatar style={{ backgroundColor: '#95EC69', color: '#000', marginLeft: '8px' }} size={28}><i data-lucide="bot" style={{ width: '14px', height: '14px' }}></i></Avatar>}
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        </div>
                                    )}

                                    {/* 未接通提示 */}
                                    {!isConnected && <div style={{ textAlign: 'center', padding: '40px 0', color: '#8c8c8c' }}><i data-lucide="phone-missed" style={{ width: '48px', height: '48px', marginBottom: '16px' }}></i><div style={{ fontSize: '14px' }}>通话未接通，暂无详细通话信息</div></div>}
                                </div>
                            )}

                            {/* ========== Tab 2: 通话总结 ========== */}
                            {internalTab === 'callSummary' && (
                                <div>
                                    {isConnected ? (
                                        <>
                                            {/* 大模型标签信息 */}
                                            <div style={{ backgroundColor: '#fff', padding: '16px', marginBottom: '16px', borderRadius: '4px' }}>
                                                <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0, marginBottom: '16px' }}>大模型标签信息</h3>
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>是否再次回电:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.callAgain || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>业务应用场景:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.businessScene || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>整体意向:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.overallIntent || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>竞品情况:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.competitorInfo || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>正面评价:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.positiveFeedback || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>负面评价:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.negativeFeedback || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>持续调用的原因:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.continueReason || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>项目情况:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.projectStatus || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>没有申请商用授权的原因:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.noCommercialReason || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>行业:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.industry || '-'}</span></div>
                                                    <div><span style={{ color: '#8c8c8c', fontSize: '14px' }}>客户采购预算:</span><span style={{ marginLeft: '8px', fontSize: '14px' }}>{callDetail.aiTags?.budget || '-'}</span></div>
                                                </div>
                                            </div>

                                            {/* 用户问题 */}
                                            <div style={{ backgroundColor: '#fff', padding: '16px', marginBottom: '16px', borderRadius: '4px' }}>
                                                <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0, marginBottom: '16px' }}>用户问题</h3>
                                                {callDetail.pendingQuestions && callDetail.pendingQuestions.length > 0 ? (
                                                    <div style={{ fontSize: '14px', color: '#595959' }}>
                                                        {callDetail.pendingQuestions.map((question, index) => <div key={index} style={{ marginBottom: '8px', paddingLeft: '12px', borderLeft: '2px solid #e8e8e8' }}>{question}</div>)}
                                                    </div>
                                                ) : <div style={{ fontSize: '14px', color: '#8c8c8c', fontStyle: 'italic' }}>暂无待明确问题</div>}
                                            </div>
                                        </>
                                    ) : (
                                        <div style={{ textAlign: 'center', padding: '40px 0', color: '#8c8c8c' }}><i data-lucide="phone-missed" style={{ width: '48px', height: '48px', marginBottom: '16px' }}></i><div style={{ fontSize: '14px' }}>通话未接通，暂无通话总结信息</div></div>
                                    )}
                                </div>
                            )}
                        </div>
                    )}
                </Drawer>
            );
        };
        // ========== 通用组件：通话详情抽屉结束 ==========

        // 我的线索页面组件
        const MyLeads = () => {
            const [activeTab, setActiveTab] = useState('pending'); // 'pending' 待处理, 'processed' 已处理
            const [refreshTime] = useState('2026-01-21 16:42'); // 静态刷新时间
            const [expanded, setExpanded] = useState(false);
            const [drawerVisible, setDrawerVisible] = useState(false);
            const [chatDetailVisible, setChatDetailVisible] = useState(false); // 聊天详情抽屉状态
            const [selectedLead, setSelectedLead] = useState(null);
            const [selectedCall, setSelectedCall] = useState(null); // 添加selectedCall状态
            const [detailTab, setDetailTab] = useState('leadRecord'); // 详情页标签
            const [timelineFilter, setTimelineFilter] = useState('all'); // 历史记录筛选
            const [activeCallAudioKey, setActiveCallAudioKey] = useState(null); // 智能外呼录音播放器展开行
            const [transcriptModalVisible, setTranscriptModalVisible] = useState(false); // 录音转文字弹窗
            const [currentTranscriptCallKey, setCurrentTranscriptCallKey] = useState(null); // 当前查看转写的通话key
            const [expandedAiTags, setExpandedAiTags] = useState({}); // 大模型标签信息展开状态
            const [expandedPendingQuestions, setExpandedPendingQuestions] = useState({}); // 待明确问题展开状态
            // 外呼记录详情抽屉状态
            const [outboundCallDetailVisible, setOutboundCallDetailVisible] = useState(false); 
            const [selectedOutboundCall, setSelectedOutboundCall] = useState(null);
            const [currentCallDetail, setCurrentCallDetail] = useState(null); // 当前查看的通话详情
            const [callDetailActiveTab, setCallDetailActiveTab] = useState('callDetail'); // 通话详情Tab：callDetail | callSummary
            
            // 聊天详情相关状态
            const [chatMessageTypeFilter, setChatMessageTypeFilter] = useState('全部');
            const [chatDateRangeFilter, setChatDateRangeFilter] = useState(null);
            const [chatSearchKeyword, setChatSearchKeyword] = useState('');
            const [chatMatchCount, setChatMatchCount] = useState(0);
            const [chatCurrentMatchIndex, setChatCurrentMatchIndex] = useState(0);
            const [chatMatchRefs, setChatMatchRefs] = useState([]);

            // 智能外呼记录（静态示例数据）
            const outboundCallRecords = [
                {
                    key: 'call_1',
                    callId: '2026020001',
                    leadId: '2026010123',
                    uid: '1001234567',
                    contactName: '王芳',
                    calleeNumber: '138****1234',
                    taskName: '线索唤醒-一轮外呼（工作日）',
                    robotName: '小度外呼-标准版',
                    smsTriggered: '是',
                    callStartTime: '2026/01/22 10:12:08',
                    callDuration: '2分18秒',
                    callEndTime: '2026/01/22 10:14:26',
                    connectStatus: '已接通',
                    noConnectReason: '-',
                    recordingUrl: 'https://www.w3schools.com/html/horse.mp3',
                    aiTags: {
                        callAgain: '是',
                        businessScene: '物流配送路线规划',
                        overallIntent: '高',
                        competitorInfo: '提到了高德地图',
                        positiveFeedback: '接口响应速度快, 文档详细易懂',
                        negativeFeedback: '部分地区POI数据不够准确',
                        continueReason: '项目急需地图服务, 免费额度满足当前需求',
                        projectStatus: '企业项目',
                        noCommercialReason: '目前处于测试阶段, 暂时使用免费额度',
                        industry: '物流运输',
                        budget: '5万-10万元'
                    },
                    pendingQuestions: [
                        '1. 如何批量导入大量POI数据到地图中？',
                        '2. 是否支持实时路况的API调用？',
                        '3. 商用授权的具体费用标准是什么？'
                    ]
                },
                {
                    key: 'call_2',
                    callId: '2026020002',
                    leadId: '2026010124',
                    uid: '1001234568',
                    contactName: '李强',
                    calleeNumber: '186****5566',
                    taskName: '线索唤醒-二轮外呼（未接通重拨）',
                    robotName: '小度外呼-标准版',
                    smsTriggered: '否',
                    callStartTime: '2026/01/23 15:32:41',
                    callDuration: '0分00秒',
                    callEndTime: '2026/01/23 15:32:41',
                    connectStatus: '未接通',
                    noConnectReason: '无人接听',
                    recordingUrl: '',
                    aiTags: {
                        callAgain: '否',
                        businessScene: '餐饮外卖配送',
                        overallIntent: '低',
                        competitorInfo: '未提到竞品',
                        positiveFeedback: '定位精度不错',
                        negativeFeedback: '价格偏高',
                        continueReason: '定位服务基本满足需求',
                        projectStatus: '个人创业',
                        noCommercialReason: '预算有限，优先考虑成本',
                        industry: '餐饮外卖',
                        budget: '1万-3万元'
                    },
                    pendingQuestions: [
                        '1. 免费额度用完后如何计费？',
                        '2. 是否支持配送员轨迹回放功能？'
                    ]
                },
                {
                    key: 'call_3',
                    callId: '2026020003', 
                    leadId: '2026010125',
                    uid: '1001234569',
                    contactName: '陈敏',
                    calleeNumber: '135****9087',
                    taskName: '商用授权-资料补充提醒',
                    robotName: '小度外呼-增强版',
                    smsTriggered: '是',
                    callStartTime: '2026/01/24 11:05:12',
                    callDuration: '1分07秒',
                    callEndTime: '2026/01/24 11:06:19',
                    connectStatus: '已接通',
                    noConnectReason: '-',
                    recordingUrl: 'https://www.w3schools.com/html/horse.mp3',
                    aiTags: {
                        callAgain: '是',
                        businessScene: '房地产楼盘展示',
                        overallIntent: '中等',
                        competitorInfo: '对比了腾讯地图',
                        positiveFeedback: '3D地图效果好, 数据更新及时',
                        negativeFeedback: 'API调用次数限制较严格',
                        continueReason: '3D展示功能独特, 符合房地产营销需求',
                        projectStatus: '房地产开发商',
                        noCommercialReason: '已有其他供应商, 正在评估性价比',
                        industry: '房地产',
                        budget: '10万-20万元'
                    },
                    pendingQuestions: [
                        '1. 3D地图渲染的性能优化方案？',
                        '2. 批量楼盘数据导入的最佳实践？',
                        '3. 移动端适配的具体技术要求？',
                        '4. 数据安全和隐私保护措施？'
                    ]
                },
                {
                    key: 'call_4',
                    callId: '2026020004',
                    leadId: '2026010126',
                    uid: '1001234570',
                    contactName: '刘洋',
                    calleeNumber: '187****2201',
                    taskName: '开放平台API试用-到期提醒',
                    robotName: '小度外呼-增强版',
                    smsTriggered: '否',
                    callStartTime: '2026/01/25 09:18:33',
                    callDuration: '0分00秒',
                    callEndTime: '2026/01/25 09:18:33',
                    connectStatus: '未接通',
                    noConnectReason: '用户忙',
                    recordingUrl: '',
                    aiTags: {
                        callAgain: '是',
                        businessScene: '共享单车位置追踪',
                        overallIntent: '很高',
                        competitorInfo: '正在使用高德地图',
                        positiveFeedback: '轨迹纠偏算法优秀',
                        negativeFeedback: '并发请求偶尔超时',
                        continueReason: '轨迹服务稳定可靠',
                        projectStatus: '独角兽公司',
                        noCommercialReason: '正在商务谈判阶段',
                        industry: '共享出行',
                        budget: '50万以上'
                    },
                    pendingQuestions: [
                        '1. 高并发场景下的API调用限制？',
                        '2. 电池消耗优化的具体方案？'
                    ]
                },
                {
                    key: 'call_5',
                    callId: '2026020005',
                    leadId: '2026010127',
                    uid: '1001234571',
                    contactName: '赵磊',
                    calleeNumber: '130****7719',
                    taskName: '产品回访-地图标注接口性能',
                    robotName: '小度外呼-标准版',
                    smsTriggered: '是',
                    callStartTime: '2026/01/25 16:42:10',
                    callDuration: '3分42秒',
                    callEndTime: '2026/01/25 16:45:52',
                    connectStatus: '已接通',
                    noConnectReason: '-',
                    recordingUrl: 'https://www.w3schools.com/html/horse.mp3',
                    aiTags: {
                        callAgain: '否',
                        businessScene: '旅游路线规划',
                        overallIntent: '一般',
                        competitorInfo: '使用谷歌地图较多',
                        positiveFeedback: '国内POI数据丰富',
                        negativeFeedback: '海外数据覆盖不足',
                        continueReason: '国内旅游应用需求',
                        projectStatus: '旅游APP开发',
                        noCommercialReason: '主要做国内市场',
                        industry: '旅游',
                        budget: '3万-8万元'
                    },
                    pendingQuestions: [
                        '1. 国际漫游场景的支持情况？',
                        '2. 离线地图包的下载限制？',
                        '3. 多语言界面的定制选项？'
                    ]
                },
                {
                    key: 'call_6',
                    callId: '2026020006',
                    leadId: '2026010128',
                    uid: '1001234572',
                    contactName: '周洁',
                    calleeNumber: '189****0432',
                    taskName: '线索唤醒-三轮外呼（晚间）',
                    robotName: '小度外呼-夜间专用',
                    smsTriggered: '否',
                    callStartTime: '2026/01/26 19:31:05',
                    callDuration: '0分00秒',
                    callEndTime: '2026/01/26 19:31:05',
                    connectStatus: '未接通',
                    noConnectReason: '关机',
                    recordingUrl: '',
                    aiTags: {
                        callAgain: '是',
                        businessScene: '校园导航服务',
                        overallIntent: '较低',
                        competitorInfo: '未明确提及',
                        positiveFeedback: '室内定位精度好',
                        negativeFeedback: '室外信号不稳定',
                        continueReason: '教育场景特殊需求',
                        projectStatus: '高校科研项目',
                        noCommercialReason: '学术研究用途',
                        industry: '教育',
                        budget: '未提及'
                    }
                },
                {
                    key: 'call_7',
                    callId: '2026020007',
                    leadId: '2026010129',
                    uid: '1001234573',
                    contactName: '孙浩',
                    calleeNumber: '133****6628',
                    taskName: '商机推进-方案沟通预约',
                    robotName: '小度外呼-增强版',
                    smsTriggered: '是',
                    callStartTime: '2026/01/27 14:09:44',
                    callDuration: '1分56秒',
                    callEndTime: '2026/01/27 14:11:40',
                    connectStatus: '已接通',
                    noConnectReason: '-',
                    recordingUrl: 'https://www.w3schools.com/html/horse.mp3',
                    aiTags: {
                        callAgain: '否',
                        businessScene: '智慧城市交通管理',
                        overallIntent: '非常高',
                        competitorInfo: '同时评估多家供应商',
                        positiveFeedback: '大数据处理能力强, 实时路况准确',
                        negativeFeedback: '定制化开发周期较长',
                        continueReason: '政府项目对稳定性要求极高',
                        projectStatus: '政府智慧城市项目',
                        noCommercialReason: '采用招投标方式',
                        industry: '政府/公共事业',
                        budget: '100万以上'
                    }
                },
                {
                    key: 'call_8',
                    callId: '2026020008',
                    leadId: '2026010130',
                    uid: '1001234574',
                    contactName: '黄婷',
                    calleeNumber: '155****1190',
                    taskName: '资料校验-企业认证信息确认',
                    robotName: '小度外呼-标准版',
                    smsTriggered: '否',
                    callStartTime: '2026/01/28 10:22:19',
                    callDuration: '0分00秒',
                    callEndTime: '2026/01/28 10:22:19',
                    connectStatus: '未接通',
                    noConnectReason: '停机',
                    recordingUrl: '',
                    aiTags: {
                        callAgain: '否',
                        businessScene: '电商物流跟踪',
                        overallIntent: '中等',
                        competitorInfo: '目前使用自家开发的GIS系统',
                        positiveFeedback: 'API接口标准化程度高',
                        negativeFeedback: '与现有系统集成复杂',
                        continueReason: '寻求技术升级方案',
                        projectStatus: '传统制造企业数字化转型',
                        noCommercialReason: 'IT预算审批流程复杂',
                        industry: '制造业',
                        budget: '20万-50万元'
                    }
                }
            ];

            // 通话录音转文字示例（从上往下为时间顺序，至少20轮对话）
            const callTranscripts = {
                call_1: [
                    { id: 1, role: 'robot', time: '2026/01/22 10:12:08', text: '您好，这里是百度地图开放平台客户服务中心。我们关注到贵公司正在使用我们的地图服务，现在做一个简单的回访，大约需要3分钟时间。请问您是负责地图接入的同事吗？' },
                    { id: 2, role: 'customer', time: '2026/01/22 10:12:14', text: '嗯，我这边是负责地图接口这块的，您说。' },
                    { id: 3, role: 'robot', time: '2026/01/22 10:12:20', text: '好的感谢您，我简单确认一下信息。现在是以公司名义在做接入，对吗？还是您个人在做一个小项目？' },
                    { id: 4, role: 'customer', time: '2026/01/22 10:12:27', text: '是公司项目，在我们技术部这边统一做地图接入。' },
                    { id: 5, role: 'robot', time: '2026/01/22 10:12:34', text: '明白，那目前百度地图主要是用在什么业务场景上呢？比如车辆定位、配送路线规划，还是门店位置查询之类的？' },
                    { id: 6, role: 'customer', time: '2026/01/22 10:12:43', text: '主要是做智能配送，司机端要看实时位置和路线规划，另外我们官网也有门店查询。' },
                    { id: 7, role: 'robot', time: '2026/01/22 10:12:52', text: '了解，物流配送加门店查询这个场景还是挺典型的。那目前一直在稳定调用百度地图，方便您整体评价一下吗？大概是哪一两个点，让您觉得可以一直用下去？' },
                    { id: 8, role: 'customer', time: '2026/01/22 10:13:01', text: '主要是比较稳定吧，我们线上跑了一年多没出过什么大问题，文档也还算清楚。' },
                    { id: 9, role: 'robot', time: '2026/01/22 10:13:10', text: '好的，那在接入过程中，具体哪一块体验会让您觉得比较好？比如是上手简单、文档示例多，还是接口稳定性、响应速度之类的？' },
                    { id: 10, role: 'customer', time: '2026/01/22 10:13:19', text: '定位和路径规划接口比较关键，这块我们感觉稳定性还不错，另外文档里有示例代码，新人上手会轻松一点。' },
                    { id: 11, role: 'robot', time: '2026/01/22 10:13:29', text: '明白，我这边也把您提到的“接口稳定、文档清晰”记录一下。那方便问下，目前一直没有提交商用授权的原因大概是什么呢？' },
                    { id: 12, role: 'customer', time: '2026/01/22 10:13:38', text: '主要是现在调用量不算特别大，一直觉得免费的额度还够，就没着急提这个事情。' },
                    { id: 13, role: 'robot', time: '2026/01/22 10:13:48', text: '好的我理解。是这样的，需要提醒您一下，根据百度地图开放平台的服务协议，像您现在这种对外提供业务使用地图服务的场景，是需要取得正式商用授权的，这个情况您之前有了解过吗？' },
                    { id: 14, role: 'customer', time: '2026/01/22 10:13:57', text: '大概知道一点，但是具体条款其实没有细看。' },
                    { id: 15, role: 'robot', time: '2026/01/22 10:14:07', text: '明白。我这边跟您正式说明一下：如果没有商用授权，调用请求在后续是有可能被限流或者拒绝的，会直接影响线上业务的稳定，而且还可能涉及侵权，有法律纠纷的风险。为了避免这些问题，建议您尽快提交商用授权申请。需要我给您简单介绍一下申请流程吗？' },
                    { id: 16, role: 'customer', time: '2026/01/22 10:14:18', text: '可以，您简单说一下，大概需要准备什么。' },
                    { id: 17, role: 'robot', time: '2026/01/22 10:14:28', text: '好的，流程比较简单：第一步，先在百度地图开放平台官网登录您现在在用的百度账号，进入控制台；第二步，在左侧菜单进入“商用授权”页面；第三步，点击申请商用授权，在表单里填一下您的业务场景和接口信息，提交后等待审核即可。' },
                    { id: 18, role: 'customer', time: '2026/01/22 10:14:40', text: '明白，那审核大概多久？还有就是价格这块有没有一个大概区间？' },
                    { id: 19, role: 'robot', time: '2026/01/22 10:14:51', text: '常规情况下审核会在1到3个工作日内完成，具体会根据您填的业务情况来评估。价格这边会结合调用量和功能范围来给方案，一般会有几个梯度，您这边如果有预估的预算区间，也可以先跟我说一下，我这边帮您备注给同事。' },
                    { id: 20, role: 'customer', time: '2026/01/22 10:15:02', text: '预算目前不是特别充裕，应该会先从比较低的档位试一下，后面看业务再调整。' },
                    { id: 21, role: 'robot', time: '2026/01/22 10:15:12', text: '好的，您的预算情况我这边已经记录，后续同事在出方案的时候会参考您的情况做下倾斜。最后再提醒您一下，尽快提交一下商用授权申请，避免后面因为限流影响到配送和门店查询。您这边还有其他关于地图接入或者授权的问题需要咨询吗？' },
                    { id: 22, role: 'customer', time: '2026/01/22 10:15:23', text: '暂时没有了，后面有问题我再在官网提工单就行。' },
                    { id: 23, role: 'robot', time: '2026/01/22 10:15:31', text: '好的，那今天就先不打扰您了。非常感谢您对百度地图开放平台的支持，祝您工作顺利，生活愉快，再见。' }
                ],
                // 商用授权资料补充提醒
                call_3: [
                    { id: 1, role: 'robot', time: '2026/01/24 11:05:12', text: '您好，这里是百度地图开放平台客户服务中心，打扰您一下。我们这边看到贵公司前两天提交了商用授权申请，现在想和您简单确认一下资料情况，大约也是3分钟时间，请问方便沟通吗？' },
                    { id: 2, role: 'customer', time: '2026/01/24 11:05:19', text: '可以的，您说。' },
                    { id: 3, role: 'robot', time: '2026/01/24 11:05:25', text: '好的感谢您。目前我们在审核时发现，贵公司业务场景描述那一栏写得比较简略，想再向您确认一下，目前地图主要用在什么场景上？是车辆定位还是门店查询这类？' },
                    { id: 4, role: 'customer', time: '2026/01/24 11:05:33', text: '主要是做出行服务，用户在App里叫车，需要用到实时位置和路线规划。' },
                    { id: 5, role: 'robot', time: '2026/01/24 11:05:41', text: '了解，那就是乘客端下单、司机端接单和导航都会用到地图，对吧？' },
                    { id: 6, role: 'customer', time: '2026/01/24 11:05:46', text: '对的，司机端这块用得比较多。' },
                    { id: 7, role: 'robot', time: '2026/01/24 11:05:53', text: '好的，那建议您在商用授权申请里，把“网约车出行服务、乘客叫车、司机导航”等关键词写清楚一些，有利于我们更快完成审核。您稍后方便登录控制台，在商用授权申请详情里补充一下这段描述吗？' },
                    { id: 8, role: 'customer', time: '2026/01/24 11:06:02', text: '可以，那我等下就去补充。补充完还需要重新提交吗？' },
                    { id: 9, role: 'robot', time: '2026/01/24 11:06:09', text: '您在原有申请里修改保存即可，不需要新建。一旦您保存，我们这边会自动同步最新内容，加快审核进度。' },
                    { id: 10, role: 'customer', time: '2026/01/24 11:06:15', text: '好的，那就麻烦你们了。' },
                    { id: 11, role: 'robot', time: '2026/01/24 11:06:19', text: '不客气，也感谢您选择百度地图。那今天就先这样，如果后续在接入或者授权方面还有问题，随时可以通过工单或热线联系我们。祝您工作顺利，再见。' }
                ],
                // 产品回访-地图标注接口性能
                call_5: [
                    { id: 1, role: 'robot', time: '2026/01/25 16:42:10', text: '您好，这里是百度地图开放平台客户服务中心。我们注意到贵公司最近在比较频繁地调用地图标注和路径规划接口，想做一个简单的使用体验回访，大概3分钟。请问方便沟通吗？' },
                    { id: 2, role: 'customer', time: '2026/01/25 16:42:18', text: '可以的，我这边正好有点时间。' },
                    { id: 3, role: 'robot', time: '2026/01/25 16:42:24', text: '好的感谢。先简单确认一下，现在地图主要是用在配送路线规划和司机位置展示，对吗？' },
                    { id: 4, role: 'customer', time: '2026/01/25 16:42:30', text: '对，我们有一个配送调度系统，司机位置和订单分配都会在地图上展示。' },
                    { id: 5, role: 'robot', time: '2026/01/25 16:42:38', text: '明白。那您整体看下来，对百度地图标注和路径规划这块的体验如何？有没有一到两个点是让您觉得比较好的？' },
                    { id: 6, role: 'customer', time: '2026/01/25 16:42:46', text: '路径规划还挺准的，特别是高峰期绕路这块，司机反馈还行。另外批量标注门店的时候，前端加载速度可以接受。' },
                    { id: 7, role: 'robot', time: '2026/01/25 16:42:55', text: '好的，这边把“高峰期路径规划效果好、批量标注加载速度可以接受”记录一下。那在使用过程中，有没有遇到过什么问题或者不太方便的地方？' },
                    { id: 8, role: 'customer', time: '2026/01/25 16:43:03', text: '偶尔会有个别地址解析不太准确，需要司机自己再确认一下，大部分还好。' },
                    { id: 9, role: 'robot', time: '2026/01/25 16:43:11', text: '了解，地址解析这块我们的底层数据也在持续优化。如果您后续有典型的错误地址样例，也可以整理后在工单里反馈，我们会优先排查。' },
                    { id: 10, role: 'customer', time: '2026/01/25 16:43:19', text: '行的，我这边收集一下。' },
                    { id: 11, role: 'robot', time: '2026/01/25 16:43:26', text: '另外再跟您确认一下，目前这块业务已经在正式对外提供服务了，对吗？' },
                    { id: 12, role: 'customer', time: '2026/01/25 16:43:32', text: '对，现在已经在线上跑了。' },
                    { id: 13, role: 'robot', time: '2026/01/25 16:43:39', text: '好的，那需要提醒您，根据百度地图开放平台的服务协议，这类对外提供配送服务的场景，需要尽快完成商用授权申请。您这边现在对商用授权的情况了解吗？' },
                    { id: 14, role: 'customer', time: '2026/01/25 16:43:48', text: '之前看过一点，大概知道要申请，但还没走流程。' },
                    { id: 15, role: 'robot', time: '2026/01/25 16:43:56', text: '明白。简单跟您再强调一下：如果长时间未取得商用授权，后续请求有可能被限流或者拒绝，直接影响到订单派发和司机导航，也存在侵权和法律风险。建议您这边尽快提一下申请。需要我再帮您过一遍申请入口吗？' },
                    { id: 16, role: 'customer', time: '2026/01/25 16:44:05', text: '不用了，入口大概知道，我让我们运维同事这两天安排。' },
                    { id: 17, role: 'robot', time: '2026/01/25 16:44:13', text: '好的，那这边就不多占用您时间了。后续如果在标注、路径规划或者授权方面有任何问题，欢迎随时联系我们。感谢您使用百度地图，祝工作顺利。' }
                ],
                // 商机推进-方案沟通预约
                call_7: [
                    { id: 1, role: 'robot', time: '2026/01/27 14:09:44', text: '您好，这里是百度地图开放平台客户服务中心。之前看到您在控制台里有提过商用合作的咨询，今天跟您再简单确认一下需求，大概3分钟。请问现在方便接听吗？' },
                    { id: 2, role: 'customer', time: '2026/01/27 14:09:51', text: '方便的，您说。' },
                    { id: 3, role: 'robot', time: '2026/01/27 14:09:58', text: '好的。先确认一下，贵公司是以公司主体在做地图接入，对吧？主要业务是做SaaS系统输出给其他企业使用？' },
                    { id: 4, role: 'customer', time: '2026/01/27 14:10:05', text: '对，我们有一套给连锁零售用的SaaS系统，里面有门店选址和客流分析，需要用到地图。' },
                    { id: 5, role: 'robot', time: '2026/01/27 14:10:13', text: '了解，那目前在地图这块，您主要会关注哪些点？是功能完整度，还是数据和价格方面？' },
                    { id: 6, role: 'customer', time: '2026/01/27 14:10:20', text: '功能和数据都比较重要吧，另外价格也会看一下整体成本。' },
                    { id: 7, role: 'robot', time: '2026/01/27 14:10:28', text: '好的。那我这边建议，后续可以安排一场和我们商务及技术同事的联合沟通，把您现在使用的接口、预估的调用量以及对比的竞品情况一起梳理一下，会更有针对性。您这边看是本周还是下周方便？' },
                    { id: 8, role: 'customer', time: '2026/01/27 14:10:37', text: '下周三下午吧，尽量安排在三点之后。' },
                    { id: 9, role: 'robot', time: '2026/01/27 14:10:45', text: '好的，我记录为“下周三 15:00 之后”，具体时间我们会再给您发个邮件或电话确认。到时候主要会介绍商用授权方案、价格区间以及和竞品的差异，您看可以吗？' },
                    { id: 10, role: 'customer', time: '2026/01/27 14:10:52', text: '可以的。' },
                    { id: 11, role: 'robot', time: '2026/01/27 14:10:59', text: '那今天先不占用您太多时间。稍后我会把会议信息和资料清单发到您在控制台留的邮箱里，您有时间也可以提前看一下。还有其他关于地图或授权的问题需要现在先沟通的吗？' },
                    { id: 12, role: 'customer', time: '2026/01/27 14:11:07', text: '暂时没有了，等下周会议上再详细聊吧。' },
                    { id: 13, role: 'robot', time: '2026/01/27 14:11:14', text: '好的，那感谢您抽时间接听电话，我们下周三再详聊。祝您工作顺利，再见。' }
                ]
            };

            // 线索动态记录数据
            const timelineRecords = [
                {
                    id: -1,
                    type: '跟进记录',
                    time: '2026-01-28 15:30',
                    status: '40% 客户内部评估',
                    operator: '外呼机器人',
                    action: '智能外呼',
                    hasDetailView: true, // 标记有详情视图
                    outboundCallDetail: {
                        callId: 'OC20260128001',
                        leadId: 'LX20260119001',
                        uid: '123456789',
                        contactName: '王芳',
                        calleeNumber: '138****1234',
                        taskName: '线索唤醒-一轮外呼（工作日）',
                        robotName: '小度外呼-标准版',
                        smsTriggered: '是',
                        callStartTime: '2026-01-28 15:30:00',
                        callDuration: '3分28秒',
                        callEndTime: '2026-01-28 15:33:28',
                        connectStatus: '已接通',
                        noConnectReason: '-',
                        recordingUrl: 'https://www.w3schools.com/html/horse.mp3',
                        aiTags: {
                            callAgain: '否',
                            businessScene: '地图API服务咨询',
                            overallIntent: '高意向',
                            competitorInfo: '无竞品提及',
                            positiveFeedback: '对批量标注接口感兴趣',
                            negativeFeedback: '无负面反馈',
                            continueReason: '',
                            projectStatus: '评估阶段',
                            noCommercialReason: '',
                            industry: '互联网',
                            budget: '10-50万'
                        },
                        pendingQuestions: [
                            '批量标注接口的具体性能指标是什么？',
                            '如何保证数据安全性和隐私保护？',
                            '技术支持和售后服务的具体内容？'
                        ]
                    },
                    details: {
                        contactName: '王芳',
                        phoneNumber: '138****1234',
                        recordingUrl: 'https://www.w3schools.com/html/horse.mp3',
                        communication: 'AI总结的通话内容摘要：客户对我们的地图API服务表现出浓厚兴趣，询问了关于批量标注接口的性能问题。机器人详细介绍了接口的技术规格和最佳实践，客户表示会安排技术团队进行评估，并希望下周能安排一次技术交流会议。整个通话过程流畅，客户反馈积极。'
                    }
                },
                {
                    id: 0,
                    type: '跟进记录',
                    time: '2026-01-20 14:43',
                    status: '40% 客户内部评估',
                    operator: 'v_tianbowen',
                    action: '微信',
                    details: {
                        communication: '客户就API接口问题进行了咨询，主要关注地图标注接口的批量操作性能。我方建议批量操作每次不超过100条以保证响应速度，客户表示理解。后续讨论了实施计划和技术文档，客户表示会安排技术团队评估。整体沟通顺畅，客户对产品表现出较高兴趣。'
                    }
                },
                {
                    id: 1,
                    type: '跟进记录',
                    time: '2026-01-22 10:31:52',
                    status: '40% 客户内部评估',
                    operator: 'v_tianbowen',
                    action: '手机',
                    details: {
                        situation: '技术/产品问题需要解决',
                        communication: '手机跟进记录'
                    }
                },
                {
                    id: 2,
                    type: '跟进记录',
                    time: '2026-01-22 10:30:32',
                    status: '40% 客户内部评估',
                    operator: 'v_tianbowen',
                    action: '微信',
                    details: {
                        situation: '技术/产品问题需要解决',
                        communication: '微信跟进记录'
                    },
                    attachment: '图片1'
                },
                {
                    id: 3,
                    type: '咨询记录',
                    time: '2026-01-17 10:20',
                    status: '20% 初步建联',
                    operator: 'v_tianbowen',
                    action: '官网留资',
                    details: {
                        leadSource: '企业认证',
                        remarks: '已初步沟通'
                    }
                },
                {
                    id: 4,
                    type: '系统变更',
                    time: '2026-01-16 14:15',
                    status: '40% 客户内部评估',
                    operator: '系统',
                    action: '创建商机',
                    details: {
                        change: '系统变更'
                    }
                }
            ];

            // 筛选后的记录
            const filteredRecords = timelineFilter === 'all' 
                ? timelineRecords 
                : timelineRecords.filter(record => {
                    if (timelineFilter === 'followUp') return record.type === '跟进记录';
                    if (timelineFilter === 'consult') return record.type === '咨询记录';
                    if (timelineFilter === 'system') return record.type === '系统变更';
                    return true;
                });
            
            // 初始化图标
            useEffect(() => {
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }, [drawerVisible, detailTab]);
            
            const handleRefresh = () => {
                // 刷新操作，但不更新时间
            };

            // 表格数据
            const [tableData] = useState([
                {
                    key: '1',
                    leadId: '477958',
                    uid: '865693804',
                    certName: '好奇宝宝',
                    customerStage: '商机阶段',
                    identifierName: '-',
                    strategyControl: '',
                    developerNote: '-',
                    certType: '企业认证',
                    leadStatus: '40% 客户内部评估',
                    leadSource: '企业认证',
                    actions: ['生成商机', '跟进记录', '外呼', '释放']
                }
            ]);

            // 表格列定义
            const columns = [
                {
                    title: '线索ID',
                    dataIndex: 'leadId',
                    key: 'leadId',
                    width: 100,
                    render: (text, record) => (
                        <a 
                            href="#" 
                            onClick={(e) => {
                                e.preventDefault();
                                setSelectedLead(record);
                                // 根据线索ID查找对应的外呼记录
                                const callRecord = outboundCallRecords.find(call => call.leadId === record.leadId);
                                setSelectedCall(callRecord || null);
                                setDrawerVisible(true);
                            }}
                            style={{ color: '#1890ff', cursor: 'pointer' }}
                        >
                            {text}
                        </a>
                    )
                },
                {
                    title: 'UID',
                    dataIndex: 'uid',
                    key: 'uid',
                    width: 120
                },
                {
                    title: '认证名称',
                    dataIndex: 'certName',
                    key: 'certName',
                    width: 200
                },
                {
                    title: '客户阶段',
                    dataIndex: 'customerStage',
                    key: 'customerStage',
                    width: 120,
                    render: (text) => (
                        <span>
                            <span style={{ 
                                display: 'inline-block',
                                width: '8px',
                                height: '8px',
                                borderRadius: '50%',
                                backgroundColor: '#1890ff',
                                marginRight: '6px'
                            }}></span>
                            {text}
                        </span>
                    )
                },
                {
                    title: '标识名称',
                    dataIndex: 'identifierName',
                    key: 'identifierName',
                    width: 120
                },
                {
                    title: '策略管控',
                    dataIndex: 'strategyControl',
                    key: 'strategyControl',
                    width: 120
                },
                {
                    title: '开发者标注',
                    dataIndex: 'developerNote',
                    key: 'developerNote',
                    width: 120
                },
                {
                    title: '认证类型',
                    dataIndex: 'certType',
                    key: 'certType',
                    width: 120
                },
                {
                    title: '线索状态',
                    dataIndex: 'leadStatus',
                    key: 'leadStatus',
                    width: 180,
                    render: (text) => (
                        <span>
                            <span style={{ 
                                display: 'inline-block',
                                width: '8px',
                                height: '8px',
                                borderRadius: '50%',
                                backgroundColor: '#1890ff',
                                marginRight: '6px'
                            }}></span>
                            {text}
                        </span>
                    )
                },
                {
                    title: '线索来源',
                    dataIndex: 'leadSource',
                    key: 'leadSource',
                    width: 120
                },
                {
                    title: '操作',
                    key: 'action',
                    width: 300,
                    fixed: 'right',
                    render: (_, record) => (
                        <Space>
                            {record.actions.map((action, index) => (
                                <a 
                                    key={index}
                                    href="#" 
                                    onClick={(e) => {
                                        e.preventDefault();
                                        // 可以添加点击事件
                                    }}
                                    style={{ color: '#1890ff', fontSize: '14px' }}
                                >
                                    {action}
                                </a>
                            ))}
                            <a 
                                href="#" 
                                onClick={(e) => {
                                    e.preventDefault();
                                    // 更多操作
                                }}
                                style={{ color: '#1890ff', fontSize: '14px' }}
                            >
                                <i data-lucide="more-horizontal" style={{ width: '16px', height: '16px' }}></i>
                            </a>
                        </Space>
                    )
                }
            ];

            return (
                <div className="content-card">
                    <h1 style={{ fontSize: '20px', fontWeight: 600, marginBottom: '2px', color: '#262626' }}>
                        我的线索
                    </h1>
                    
                    {/* 搜索筛选区域 */}
                    <div className="search-section">
                        <div className="search-left" style={{ whiteSpace: 'nowrap' }}>
                            <span style={{ color: '#666', marginRight: '8px', whiteSpace: 'nowrap' }}>认证名称:</span>
                            <Select
                                placeholder="认证名称"
                                style={{ width: 120 }}
                            >
                                <Option value="all">全部</Option>
                            </Select>
                            <Input
                                placeholder="请输入认证名称"
                                style={{ width: 200, marginLeft: '8px' }}
                            />
                            <span style={{ color: '#666', marginLeft: '8px', marginRight: '8px', whiteSpace: 'nowrap' }}>线索来源:</span>
                            <Input
                                placeholder="请选择线索来源"
                                style={{ width: 200 }}
                            />
                            <span style={{ color: '#666', marginLeft: '8px', marginRight: '8px', whiteSpace: 'nowrap' }}>公海来源:</span>
                            <Select
                                placeholder="请选择"
                                style={{ width: 120 }}
                            >
                                <Option value="all">全部</Option>
                            </Select>
                        </div>
                        <div className="search-right">
                            <Button>重置</Button>
                            <Button type="primary">查询</Button>
                            <Button onClick={() => setExpanded(!expanded)}>
                                展开 <i data-lucide={expanded ? "chevron-up" : "chevron-down"} style={{ width: '14px', height: '14px', marginLeft: '4px' }}></i>
                            </Button>
                        </div>
                    </div>

                    {/* 标签页和操作按钮 */}
                    <div style={{ 
                        display: 'flex', 
                        justifyContent: 'space-between', 
                        alignItems: 'center',
                        marginTop: '16px',
                        marginBottom: '16px'
                    }}>
                        <div style={{ display: 'flex', gap: '0' }}>
                            <div
                                onClick={() => setActiveTab('pending')}
                                style={{
                                    padding: '8px 16px',
                                    cursor: 'pointer',
                                    borderBottom: activeTab === 'pending' ? '2px solid #1890ff' : '2px solid transparent',
                                    color: activeTab === 'pending' ? '#1890ff' : '#666',
                                    fontWeight: activeTab === 'pending' ? 500 : 400
                                }}
                            >
                                待处理 1
                            </div>
                            <div
                                onClick={() => setActiveTab('processed')}
                                style={{
                                    padding: '8px 16px',
                                    cursor: 'pointer',
                                    borderBottom: activeTab === 'processed' ? '2px solid #1890ff' : '2px solid transparent',
                                    color: activeTab === 'processed' ? '#1890ff' : '#666',
                                    fontWeight: activeTab === 'processed' ? 500 : 400
                                }}
                            >
                                已处理 1
                            </div>
                        </div>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                            <span style={{ fontSize: '14px', color: '#666' }}>最近刷新时间: {refreshTime}</span>
                            <Button type="primary">新建线索</Button>
                            <div className="icon-btn" onClick={handleRefresh}>
                                <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>
                            </div>
                            <div className="icon-btn">
                                <i data-lucide="info" style={{ width: '16px', height: '16px' }}></i>
                            </div>
                            <div className="icon-btn">
                                <i data-lucide="settings" style={{ width: '16px', height: '16px' }}></i>
                            </div>
                        </div>
                    </div>

                    {/* 数据表格 */}
                    <div style={{ 
                        overflowX: 'auto',
                        overflowY: 'visible',
                        position: 'relative'
                    }}>
                        <Table
                            columns={columns}
                            dataSource={tableData}
                            pagination={{
                                total: tableData.length,
                                pageSize: 20,
                                showSizeChanger: true,
                                showTotal: (total, range) => `第 ${range[0]}-${range[1]} 条/总共 ${total} 条`,
                                showQuickJumper: true,
                                pageSizeOptions: ['10', '20', '50', '100']
                            }}
                            scroll={{ x: 'max-content', y: undefined }}
                        />
                    </div>

                    {/* 线索详情抽屉 */}
                    <Drawer
                        title={null}
                        placement="right"
                        onClose={() => {
                            setDrawerVisible(false);
                            setSelectedLead(null);
                            setSelectedCall(null);
                        }}
                        open={drawerVisible}
                        width="66.666%"
                        closable={true}
                        style={{ zIndex: 1000 }}
                    >
                        {selectedLead && drawerVisible ? (
                            <div style={{ height: '100%', display: 'flex', flexDirection: 'column' }}>
                                {/* 顶部标签页 */}
                                <div style={{ 
                                    display: 'flex', 
                                    borderBottom: '1px solid #e8e8e8',
                                    marginBottom: '16px',
                                    whiteSpace: 'nowrap',
                                    overflowX: 'auto'
                                }}>
                                    {[
                                        { key: 'leadRecord', label: '线索记录' },
                                        { key: 'userInfo', label: '用户信息' },
                                        { key: 'serviceUsage', label: '服务用量' },
                                        { key: 'customerProfile', label: '客户画像' },
                                        { key: 'referer', label: 'Referer' },
                                        { key: 'myOrders', label: '我的订单' },
                                        { key: 'orderRecord', label: '订单记录' },
                                        { key: 'strategyControl', label: '策略管控' },
                                        { key: 'behaviorAnalysis', label: '客户行为分析' },
                                        { key: 'relatedCustomers', label: '关联客户' }
                                    ].map(tab => (
                                        <div
                                            key={tab.key}
                                            onClick={() => setDetailTab(tab.key)}
                                            style={{
                                                padding: '12px 8px',
                                                cursor: 'pointer',
                                                borderBottom: detailTab === tab.key ? '2px solid #1890ff' : '2px solid transparent',
                                                color: detailTab === tab.key ? '#1890ff' : '#666',
                                                fontWeight: detailTab === tab.key ? 500 : 400,
                                                marginRight: '4px',
                                                whiteSpace: 'nowrap',
                                                flexShrink: 0
                                            }}
                                        >
                                            {tab.label}
                                        </div>
                                    ))}
                                </div>

                                {/* 内容区域 */}
                                <div style={{ flex: 1, overflowY: 'auto' }}>
                                    {detailTab === 'leadRecord' && (
                                        <div>
                                            {/* 线索进度条 */}
                                            <div style={{
                                                backgroundColor: '#fff',
                                                padding: '24px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{
                                                    position: 'relative',
                                                    padding: '20px 0'
                                                }}>
                                                    {/* 背景进度条 */}
                                                    <div style={{
                                                        position: 'absolute',
                                                        top: '28px',
                                                        left: '0',
                                                        right: '0',
                                                        height: '4px',
                                                        backgroundColor: '#e8e8e8',
                                                        borderRadius: '2px'
                                                    }}></div>
                                                    
                                                    {/* 已完成的进度条 */}
                                                    <div style={{
                                                        position: 'absolute',
                                                        top: '28px',
                                                        left: '0',
                                                        width: '40%', // 当前进度40%
                                                        height: '4px',
                                                        backgroundColor: '#1890ff',
                                                        borderRadius: '2px',
                                                        zIndex: 1
                                                    }}></div>
                                                    
                                                    {/* 进度节点 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        position: 'relative',
                                                        zIndex: 2
                                                    }}>
                                                        {[
                                                            { label: '0% 未建联', percent: 0 },
                                                            { label: '20% 初步建联', percent: 20 },
                                                            { label: '40% 客户内部评估', percent: 40, active: true },
                                                            { label: '60% 初步确认', percent: 60 },
                                                            { label: '80% 提交申请', percent: 80 },
                                                            { label: '100% 已成单', percent: 100 },
                                                            { label: '120% 到期不续签', percent: 120 }
                                                        ].map((stage, index) => (
                                                            <div key={index} style={{
                                                                display: 'flex',
                                                                flexDirection: 'column',
                                                                alignItems: 'center',
                                                                position: 'relative'
                                                            }}>
                                                                <div style={{
                                                                    width: '16px',
                                                                    height: '16px',
                                                                    borderRadius: '50%',
                                                                    backgroundColor: stage.active ? '#1890ff' : (stage.percent < 40 ? '#1890ff' : '#d9d9d9'),
                                                                    border: '3px solid #fff',
                                                                    boxShadow: '0 0 0 2px ' + (stage.active ? '#1890ff' : (stage.percent < 40 ? '#1890ff' : '#d9d9d9')),
                                                                    marginBottom: '8px',
                                                                    position: 'relative',
                                                                    zIndex: 3
                                                                }}></div>
                                                                <div style={{
                                                                    fontSize: '12px',
                                                                    color: stage.active ? '#1890ff' : (stage.percent < 40 ? '#1890ff' : '#8c8c8c'),
                                                                    textAlign: 'center',
                                                                    whiteSpace: 'nowrap'
                                                                }}>
                                                                    {stage.label}
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 线索信息 */}
                                            <div style={{
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{ 
                                                    display: 'flex', 
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    marginBottom: '16px'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>线索信息</h3>
                                                    <Button size="small" type="primary">编辑</Button>
                                                </div>
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>线索ID:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead.leadId}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>线索状态:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px', display: 'inline-flex', alignItems: 'center' }}>
                                                            <span style={{
                                                                display: 'inline-block',
                                                                width: '8px',
                                                                height: '8px',
                                                                borderRadius: '50%',
                                                                backgroundColor: '#1890ff',
                                                                marginRight: '6px'
                                                            }}></span>
                                                            {selectedLead.leadStatus}
                                                        </span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>创建时间:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>2026-01-13 17:46</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>线索来源:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead.leadSource}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>线索描述:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>客户阶段:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead.customerStage}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>关联客户:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 外呼基本信息 */}
                                            <div style={{
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{ 
                                                    display: 'flex', 
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    marginBottom: '16px'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>外呼基本信息</h3>
                                                </div>
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话ID:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.callId || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>联系人姓名:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.contactName || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>被叫号码:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.calleeNumber || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>任务名称:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.taskName || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>机器人名称:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.robotName || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>触发短信:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.smsTriggered || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话开始时间:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.callStartTime || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话时长:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.callDuration || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话结束时间:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.callEndTime || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>接通状态:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.connectStatus || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>未接通原因:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedCall?.noConnectReason || '-'}</span>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 关联微信 */}
                                            <div style={{ 
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{ 
                                                    display: 'flex', 
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    marginBottom: '16px'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>关联微信</h3>
                                                    <i
                                                        data-lucide="refresh-cw"
                                                        style={{ width: '16px', height: '16px', cursor: 'pointer' }}
                                                        title="刷新"
                                                        onClick={() => {
                                                            message.success('已刷新');
                                                            setTimeout(() => {
                                                                if (typeof lucide !== 'undefined') {
                                                                    lucide.createIcons();
                                                                }
                                                            }, 0);
                                                        }}
                                                    ></i>
                                                </div>
                                                <Table
                                                    columns={[
                                                        { 
                                                            title: <span style={{ whiteSpace: 'nowrap' }}>微信头像</span>, 
                                                            dataIndex: 'avatar', 
                                                            key: 'avatar', 
                                                            width: 80,
                                                            render: (avatar) => (
                                                                <img 
                                                                    src={avatar} 
                                                                    alt="头像"
                                                                    style={{ 
                                                                        width: '32px', 
                                                                        height: '32px', 
                                                                        borderRadius: '50%',
                                                                        objectFit: 'cover'
                                                                    }}
                                                                />
                                                            )
                                                        },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>微信昵称</span>, dataIndex: 'nickname', key: 'nickname', width: 120 },
                                                        { 
                                                            title: <span style={{ whiteSpace: 'nowrap' }}>备注</span>, 
                                                            dataIndex: 'remark', 
                                                            key: 'remark', 
                                                            width: 140,
                                                            render: (remark) => (
                                                                <span style={{ display: 'inline-flex', alignItems: 'center', gap: '6px' }}>
                                                                    <span>{remark}</span>
                                                                    {remark === '张明' && (
                                                                        <antd.Popover
                                                                            placement="top"
                                                                            trigger="hover"
                                                                            content={(
                                                                                <div style={{ fontSize: '12px', lineHeight: 1.6 }}>
                                                                                    <div style={{ display: 'grid', gridTemplateColumns: 'auto 1fr', columnGap: '8px', rowGap: '6px' }}>
                                                                                        <div style={{ color: '#8c8c8c' }}>添加人：</div>
                                                                                        <div>田博文</div>
                                                                                        <div style={{ color: '#8c8c8c' }}>备注：</div>
                                                                                        <div>技术负责人</div>
                                                                                        <div style={{ color: '#8c8c8c', marginTop: '4px' }}>添加人：</div>
                                                                                        <div style={{ marginTop: '4px' }}>王芳</div>
                                                                                        <div style={{ color: '#8c8c8c' }}>备注：</div>
                                                                                        <div>张工（对接人）</div>
                                                                                    </div>
                                                                                </div>
                                                                            )}
                                                                        >
                                                                            <span
                                                                                style={{
                                                                                    cursor: 'pointer',
                                                                                    color: '#8c8c8c',
                                                                                    fontSize: '12px',
                                                                                    lineHeight: 1,
                                                                                    padding: '0 6px',
                                                                                    border: '1px solid #d9d9d9',
                                                                                    borderRadius: '10px'
                                                                                }}
                                                                                title="更多备注"
                                                                            >
                                                                                更多
                                                                            </span>
                                                                        </antd.Popover>
                                                                    )}
                                                                </span>
                                                            )
                                                        },
                                                        { 
                                                            title: <span style={{ whiteSpace: 'nowrap' }}>联系人类型</span>, 
                                                            dataIndex: 'contactType', 
                                                            key: 'contactType', 
                                                            width: 120,
                                                            render: (type) => (
                                                                <span style={{ 
                                                                    color: type === '@微信' ? '#52c41a' : type === '@百度地图开放平台' ? '#ff9800' : '#1890ff'
                                                                }}>
                                                                    {type}
                                                                </span>
                                                            )
                                                        },
                                                        { 
                                                            title: <span style={{ whiteSpace: 'nowrap' }}>性别</span>, 
                                                            dataIndex: 'gender', 
                                                            key: 'gender', 
                                                            width: 80,
                                                            render: (gender) => (
                                                                <span style={{ 
                                                                    color: gender === '男' ? '#1890ff' : gender === '女' ? '#ff69b4' : '#8c8c8c'
                                                                }}>
                                                                    {gender === '男' ? '♂' : gender === '女' ? '♀' : '-'}
                                                                </span>
                                                            )
                                                        },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>关联的操作人</span>, dataIndex: 'operator', key: 'operator', width: 120 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>关联线索时间</span>, dataIndex: 'linkTime', key: 'linkTime', width: 160 }
                                                    ]}
                                                    dataSource={[
                                                        {
                                                            key: '1',
                                                            avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=faces',
                                                            nickname: '开心的老鹰🦅',
                                                            remark: '张明',
                                                            contactType: '@微信',
                                                            gender: '男',
                                                            operator: '田博文',
                                                            linkTime: '2026-01-15 10:25'
                                                        },
                                                        {
                                                            key: '2',
                                                            avatar: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=150&h=150&fit=crop&crop=faces',
                                                            nickname: '愤怒的小鸟😡',
                                                            remark: '王芳',
                                                            contactType: '@百度地图开放平台',
                                                            gender: '女',
                                                            operator: '张明',
                                                            linkTime: '2026-01-14 14:36'
                                                        },
                                                        {
                                                            key: '3',
                                                            avatar: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=faces',
                                                            nickname: '呆呆的兔子🐰',
                                                            remark: '李强',
                                                            contactType: '@微信',
                                                            gender: '男',
                                                            operator: '王芳',
                                                            linkTime: '2026-01-13 16:45'
                                                        }
                                                    ]}
                                                    pagination={{
                                                        total: 3,
                                                        pageSize: 20,
                                                        showTotal: (total) => `共${total}条`,
                                                        showSizeChanger: true,
                                                        pageSizeOptions: ['10', '20', '50', '100']
                                                    }}
                                                    scroll={{ x: 'max-content' }}
                                                />
                                            </div>

                                            {/* 外呼基本信息 */}
                                            <div style={{
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{ 
                                                    display: 'flex', 
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    marginBottom: '16px'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>外呼基本信息</h3>
                                                </div>
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话ID:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.callId || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>联系人姓名:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.contactName || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>被叫号码:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.calleeNumber || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>任务名称:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.taskName || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>机器人名称:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.robotName || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>触发短信:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.smsTriggered || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话开始时间:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.callStartTime || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话时长:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.callDuration || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>通话结束时间:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.callEndTime || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>接通状态:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.connectStatus || '-'}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>未接通原因:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead?.noConnectReason || '-'}</span>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 产品需求 */}
                                            <div style={{
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    marginBottom: '16px'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>产品需求</h3>
                                                    <Button size="small" type="primary">编辑</Button>
                                                </div>
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>商用授权:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>商用授权</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>DuGIS:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>慧眼:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>交通大数据:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>基础API:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>矢量数据运营行业:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>慧眼运营商行业:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>商场通:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>车位&停车场:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>-</span>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 智能外呼记录 */}
                                            <div style={{
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>智能外呼记录</h3>
                                                    <Button 
                                                        type="text" 
                                                        icon={<i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>}
                                                        onClick={() => {
                                                            // 刷新逻辑
                                                            console.log('刷新智能外呼记录');
                                                        }}
                                                        style={{ padding: '4px 8px' }}
                                                    />
                                                </div>
                                                <Table
                                                    columns={[
                                                        { 
                                                            title: '通话ID', 
                                                            dataIndex: 'callId', 
                                                            key: 'callId', 
                                                            width: 130 
                                                        },
                                                        { 
                                                            title: '联系人姓名', 
                                                            dataIndex: 'contactName', 
                                                            key: 'contactName', 
                                                            width: 120 
                                                        },
                                                        { 
                                                            title: '被叫号码', 
                                                            dataIndex: 'calleeNumber', 
                                                            key: 'calleeNumber', 
                                                            width: 140 
                                                        },
                                                        { title: '外呼任务名称', dataIndex: 'taskName', key: 'taskName', width: 180 },
                                                        { title: '外呼机器人', dataIndex: 'robotName', key: 'robotName', width: 140 },
                                                        { title: '触发短信', dataIndex: 'smsTriggered', key: 'smsTriggered', width: 100 },
                                                        { title: '通话开始时间', dataIndex: 'callStartTime', key: 'callStartTime', width: 170 },
                                                        { title: '通话时长', dataIndex: 'callDuration', key: 'callDuration', width: 110 },
                                                        { title: '通话结束时间', dataIndex: 'callEndTime', key: 'callEndTime', width: 170 },
                                                        { 
                                                            title: '接通状态', 
                                                            dataIndex: 'connectStatus', 
                                                            key: 'connectStatus', 
                                                            width: 110,
                                                            render: (text) => {
                                                                const isConnected = text === '已接通';
                                                                return (
                                                                    <span style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                                                                        <span style={{
                                                                            display: 'inline-block',
                                                                            width: '8px',
                                                                            height: '8px',
                                                                            borderRadius: '50%',
                                                                            backgroundColor: isConnected ? '#52c41a' : '#ff4d4f'
                                                                        }}></span>
                                                                        {text}
                                                                    </span>
                                                                );
                                                            }
                                                        },
                                                        { title: '未接通原因', dataIndex: 'noConnectReason', key: 'noConnectReason', width: 120 },
                                {
                                    title: '操作',
                                    key: 'action',
                                    width: 100,
                                    fixed: 'right',
                                    render: (_, record) => (
                                        <Button
                                            type="link"
                                            size="small"
                                            onClick={() => {
                                                setSelectedOutboundCall(record);
                                                setCallDetailActiveTab('callDetail'); // 重置为通话详情Tab
                                                setOutboundCallDetailVisible(true);
                                            }}
                                        >
                                            查看详情
                                        </Button>
                                    )
                                }
                                                    ]}
                                                    dataSource={outboundCallRecords}
                                                    pagination={{
                                                        total: outboundCallRecords.length,
                                                        pageSize: 5,
                                                        showSizeChanger: true,
                                                        pageSizeOptions: ['5', '10', '20'],
                                                        showTotal: (total) => `共${total}条`
                                                    }}
                                                    scroll={{ x: 'max-content' }}
                                                />
                                            </div>

                                            {/* 订单信息 */}
                                            <div style={{
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <h3 style={{ fontSize: '16px', fontWeight: 500, marginBottom: '16px' }}>订单信息</h3>
                                                <div style={{
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    gap: '8px',
                                                    marginBottom: '16px'
                                                }}>
                                                    <span style={{ color: '#8c8c8c', fontSize: '14px' }}>添加订单:</span>
                                                    <Input
                                                        placeholder="请输入订单号"
                                                        style={{ width: '300px' }}
                                                    />
                                                    <Button type="primary">添加</Button>
                                                </div>
                                                <Table
                                                    columns={[
                                                        { title: '订单号', dataIndex: 'orderNumber', key: 'orderNumber', width: 150 },
                                                        { title: '订单类型', dataIndex: 'orderType', key: 'orderType', width: 120 },
                                                        { title: '添加时间', dataIndex: 'addTime', key: 'addTime', width: 160 },
                                                        { title: '到期时间', dataIndex: 'expireTime', key: 'expireTime', width: 160 },
                                                        { title: '添加人', dataIndex: 'adder', key: 'adder', width: 120 },
                                                        {
                                                            title: '操作',
                                                            key: 'action',
                                                            width: 100,
                                                            render: () => (
                                                                <a href="#" style={{ color: '#1890ff' }}>删除</a>
                                                            )
                                                        }
                                                    ]}
                                                    dataSource={[]}
                                                    locale={{ emptyText: (
                                                        <div style={{ textAlign: 'center', padding: '40px', color: '#8c8c8c' }}>
                                                            <i data-lucide="inbox" style={{ width: '48px', height: '48px', marginBottom: '8px', opacity: 0.3 }}></i>
                                                            <div>暂无数据</div>
                                                        </div>
                                                    ) }}
                                                    pagination={false}
                                                />
                                            </div>

                                            {/* 历史记录 */}
                                            <div style={{ marginBottom: '24px' }}>
                                                <div style={{ 
                                                    display: 'flex', 
                                                    justifyContent: 'space-between', 
                                                    alignItems: 'center', 
                                                    marginBottom: '16px',
                                                    paddingLeft: '12px',
                                                    borderLeft: '4px solid #1890ff'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 600, margin: 0 }}>历史记录</h3>
                                                </div>

                                                <div style={{ marginBottom: '16px' }}>
                                                    <div style={{ marginBottom: '8px', fontSize: '14px', color: '#666' }}>记录筛选</div>
                                                    <Radio.Group 
                                                        value={timelineFilter} 
                                                        onChange={(e) => setTimelineFilter(e.target.value)}
                                                    >
                                                        <Radio value="all">全部记录</Radio>
                                                        <Radio value="followUp">跟进记录</Radio>
                                                        <Radio value="consult">咨询记录</Radio>
                                                        <Radio value="system">系统变更</Radio>
                                                    </Radio.Group>
                                                </div>

                                                <div style={{ position: 'relative', paddingLeft: '20px' }}>
                                                    <div style={{ 
                                                        position: 'absolute', 
                                                        left: '9px', 
                                                        top: '8px', 
                                                        bottom: '0', 
                                                        width: '2px', 
                                                        backgroundColor: '#f0f0f0' 
                                                    }}></div>

                                                    {filteredRecords.map((record, index) => (
                                                        <div key={record.id} style={{ 
                                                            position: 'relative', 
                                                            paddingBottom: '32px',
                                                            paddingLeft: '24px'
                                                        }}>
                                                            {/* 时间点图标 */}
                                                            <div style={{
                                                                position: 'absolute',
                                                                left: '-16px',
                                                                top: '0',
                                                                width: '10px',
                                                                height: '10px',
                                                                borderRadius: '50%',
                                                                border: '2px solid #1890ff',
                                                                backgroundColor: '#fff',
                                                                zIndex: 1
                                                            }}></div>

                                                            {/* 记录头部 */}
                                                            <div style={{ 
                                                                display: 'flex', 
                                                                alignItems: 'center', 
                                                                gap: '12px',
                                                                marginBottom: '8px'
                                                            }}>
                                                                <span style={{ fontSize: '14px', color: '#333' }}>{record.time}</span>
                                                                <span style={{ fontSize: '14px', fontWeight: 500, color: '#333' }}>{record.status}</span>
                                                            </div>

                                                            {/* 操作信息 */}
                                                            <div style={{ 
                                                                fontSize: '14px', 
                                                                color: '#333',
                                                                marginBottom: '8px'
                                                            }}>
                                                                操作人：<span style={{ fontWeight: 500 }}>{record.operator}</span>
                                                                {(record.action || (record.details.contactName && record.details.phoneNumber)) && (
                                                                    <div style={{ marginTop: '8px' }}>
                                                                        {record.action && (
                                                                            <span style={{ margin: '0 8px', color: '#1890ff' }}>[{record.action}]</span>
                                                                        )}
                                                                        {record.details.contactName && record.details.phoneNumber && (
                                                                            <>
                                                                                <span>{record.details.contactName}</span>
                                                                                <span style={{ margin: '0 8px' }}>{record.details.phoneNumber}</span>
                                                                                {activeCallAudioKey === record.id ? (
                                                                                    <span style={{ display: 'inline-flex', alignItems: 'center', gap: '8px' }}>
                                                                                        <audio
                                                                                            controls
                                                                                            src={record.details.recordingUrl}
                                                                                            style={{ height: 28, width: 170 }}
                                                                                        />
                                                                                        <a
                                                                                            href="#"
                                                                                            onClick={(e) => {
                                                                                                e.preventDefault();
                                                                                                setActiveCallAudioKey(null);
                                                                                            }}
                                                                                            style={{ color: '#1890ff', whiteSpace: 'nowrap' }}
                                                                                        >
                                                                                            收起
                                                                                        </a>
                                                                                        <span 
                                                                                            style={{ 
                                                                                                color: '#1890ff', 
                                                                                                cursor: 'pointer',
                                                                                                textDecoration: 'underline',
                                                                                                marginLeft: '8px'
                                                                                            }}
                                                                                            onClick={() => {
                                                                                                setTranscriptModalVisible(true);
                                                                                                setCurrentTranscriptCallKey('call_1');
                                                                                            }}
                                                                                        >
                                                                                            转文字
                                                                                        </span>
                                                                                    </span>
                                                                                ) : (
                                                                                    <>
                                                                                        <Button
                                                                                            size="small"
                                                                                            disabled={!record.details.recordingUrl}
                                                                                            onClick={() => {
                                                                                                if (record.details.recordingUrl) {
                                                                                                    setActiveCallAudioKey(record.id);
                                                                                                }
                                                                                            }}
                                                                                            style={{ marginRight: '8px' }}
                                                                                        >
                                                                                            获取通话录音
                                                                                        </Button>
                                                                                        <span 
                                                                                            style={{ 
                                                                                                color: '#1890ff', 
                                                                                                cursor: 'pointer',
                                                                                                textDecoration: 'underline'
                                                                                            }}
                                                                                            onClick={() => {
                                                                                                setTranscriptModalVisible(true);
                                                                                                setCurrentTranscriptCallKey('call_1');
                                                                                            }}
                                                                                        >
                                                                                            转文字
                                                                                        </span>
                                                                                    </>
                                                                                )}
                                                                            </>
                                                                        )}
                                                                    </div>
                                                                )}
                                                            </div>

                                                            {/* 详细内容 */}
                                                            {record.details && (
                                                                <div style={{ fontSize: '14px', color: '#666', lineHeight: 1.6 }}>
                                                                    {record.details.situation && (
                                                                        <div style={{ marginBottom: '4px' }}>
                                                                            <span style={{ color: '#333' }}>具体情况：</span>{record.details.situation}
                                                                        </div>
                                                                    )}
                                                                    {record.details.communication && (
                                                                        <div style={{ marginBottom: '4px' }}>
                                                                            <span style={{ color: '#333' }}>沟通记录：</span>{record.details.communication}
                                                                            {index === 1 && (
                                                                                <div style={{ marginTop: '8px' }}>
                                                                                    <span 
                                                                                        style={{ 
                                                                                            color: '#1890ff', 
                                                                                            cursor: 'pointer', 
                                                                                            fontSize: '14px',
                                                                                            display: 'inline-block'
                                                                                        }}
                                                                                        onClick={() => {
                                                                                            setChatDetailVisible(true);
                                                                                        }}
                                                                                    >
                                                                                        查看原文
                                                                                    </span>
                                                                                </div>
                                                                            )}
                                                                        </div>
                                                                    )}
                                                                    {record.details.leadSource && (
                                                                        <div style={{ marginBottom: '4px' }}>
                                                                            <span style={{ color: '#333' }}>线索来源：</span>{record.details.leadSource}
                                                                        </div>
                                                                    )}
                                                                    {record.details.remarks && (
                                                                        <div style={{ marginBottom: '4px' }}>
                                                                            <span style={{ color: '#333' }}>备注：</span>{record.details.remarks}
                                                                        </div>
                                                                    )}
                                                                    {record.details.change && (
                                                                        <div style={{ marginBottom: '4px' }}>
                                                                            <span style={{ color: '#333' }}>变更内容：</span>{record.details.change}
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            )}

                                                            {/* 附件 */}
                                                            {record.attachment && (
                                                                <div style={{ marginTop: '8px' }}>
                                                                    <div style={{ 
                                                                        display: 'inline-flex', 
                                                                        alignItems: 'center', 
                                                                        gap: '4px',
                                                                        color: '#1890ff',
                                                                        cursor: 'pointer',
                                                                        fontSize: '14px'
                                                                    }}>
                                                                        <i data-lucide="search" style={{ width: '14px', height: '14px' }}></i>
                                                                        {record.attachment}
                                                                    </div>
                                                                </div>
                                                            )}
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                    {detailTab === 'userInfo' && (
                                        <div>
                                            {/* 用户信息块 */}
                                            <div style={{ 
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{ 
                                                    display: 'flex', 
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    marginBottom: '16px'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>用户信息</h3>
                                                    <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px', cursor: 'pointer' }}></i>
                                                </div>
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '16px' }}>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>UID:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead.uid}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>认证类型:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead.certType}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>行业类别:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>出行</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>业务场景:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>产品经理自测研究,产品经理自测研究,产品经理自测研究,产品经理自测研究。</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>注册账户时间:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>2016-09-29 09:38:12</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>认证名称:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>{selectedLead.certName}</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>认证地址:</span>
                                                        <span style={{ marginLeft: '8px', fontSize: '14px' }}>北京市-北京市</span>
                                                    </div>
                                                    <div>
                                                        <span style={{ color: '#8c8c8c', fontSize: '14px' }}>营业执照:</span>
                                                        <a href="#" style={{ marginLeft: '8px', color: '#1890ff' }}>查看</a>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 联系人块 */}
                                            <div style={{ 
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <div style={{ 
                                                    display: 'flex', 
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    marginBottom: '16px'
                                                }}>
                                                    <h3 style={{ fontSize: '16px', fontWeight: 500, margin: 0 }}>联系人</h3>
                                                    <div style={{ display: 'flex', gap: '8px' }}>
                                                        <Button size="small">申请明文手机号</Button>
                                                        <Button size="small" type="primary">编辑</Button>
                                                    </div>
                                                </div>
                                                <Table
                                                    columns={[
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>联系人姓名</span>, dataIndex: 'name', key: 'name', width: 120 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>手机号</span>, dataIndex: 'phone', key: 'phone', width: 120 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>邮箱</span>, dataIndex: 'email', key: 'email', width: 180 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>是否关键联系人</span>, dataIndex: 'isKey', key: 'isKey', width: 120 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>角色</span>, dataIndex: 'role', key: 'role', width: 100 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>部门</span>, dataIndex: 'department', key: 'department', width: 100 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>上次沟通情况</span>, dataIndex: 'lastComm', key: 'lastComm', width: 140 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>来源</span>, dataIndex: 'source', key: 'source', width: 200 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>变更类型</span>, dataIndex: 'changeType', key: 'changeType', width: 120 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>更新时间</span>, dataIndex: 'updateTime', key: 'updateTime', width: 160 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>是否推荐</span>, dataIndex: 'isRecommended', key: 'isRecommended', width: 100 },
                                                        { title: <span style={{ whiteSpace: 'nowrap' }}>推荐原因</span>, dataIndex: 'recommendReason', key: 'recommendReason', width: 120 },
                                                        { 
                                                            title: <span style={{ whiteSpace: 'nowrap' }}>最近沟通记录</span>, 
                                                            dataIndex: 'lastCommRecord', 
                                                            key: 'lastCommRecord', 
                                                            width: 120,
                                                            render: () => (
                                                                <a 
                                                                    href="#" 
                                                                    onClick={(e) => {
                                                                        e.preventDefault();
                                                                        // 可以添加查看沟通记录的逻辑
                                                                    }}
                                                                    style={{ color: '#1890ff', cursor: 'pointer' }}
                                                                >
                                                                    查看
                                                                </a>
                                                            )
                                                        }
                                                    ]}
                                                    dataSource={[
                                                        {
                                                            key: '1',
                                                            name: '田博文',
                                                            phone: '*******8894',
                                                            email: '454727918@qq.com',
                                                            isKey: '否',
                                                            role: '-',
                                                            department: '-',
                                                            lastComm: '-',
                                                            source: '开发者中心的联系方式(更新)',
                                                            changeType: '无变更',
                                                            updateTime: '2026-01-13 17:37',
                                                            isRecommended: '否',
                                                            recommendReason: '-',
                                                            lastCommRecord: ''
                                                        }
                                                    ]}
                                                    pagination={{
                                                        total: 1,
                                                        pageSize: 20,
                                                        showTotal: (total) => `共${total}条`,
                                                        showSizeChanger: true,
                                                        pageSizeOptions: ['10', '20', '50', '100']
                                                    }}
                                                    scroll={{ x: 'max-content' }}
                                                />
                                            </div>

                                            {/* 加入客户微信群块 */}
                                            <div style={{ 
                                                backgroundColor: '#fff',
                                                padding: '16px',
                                                marginBottom: '16px',
                                                borderRadius: '4px'
                                            }}>
                                                <h3 style={{ fontSize: '16px', fontWeight: 500, marginBottom: '16px' }}>加入客户微信群</h3>
                                                <Table
                                                    columns={[
                                                        { title: '序号', dataIndex: 'index', key: 'index', width: 80 },
                                                        { title: '群聊人数', dataIndex: 'memberCount', key: 'memberCount', width: 100 },
                                                        { title: '成员', dataIndex: 'members', key: 'members', width: 200 },
                                                        { title: '创建时间', dataIndex: 'createTime', key: 'createTime', width: 160 },
                                                        { title: '最近联系时间', dataIndex: 'lastContactTime', key: 'lastContactTime', width: 160 },
                                                        { title: '群聊二维码', dataIndex: 'qrCode', key: 'qrCode', width: 120 }
                                                    ]}
                                                    dataSource={[]}
                                                    locale={{ emptyText: (
                                                        <div style={{ textAlign: 'center', padding: '40px', color: '#8c8c8c' }}>
                                                            <i data-lucide="folder" style={{ width: '48px', height: '48px', marginBottom: '16px', opacity: 0.3 }}></i>
                                                            <div>暂无数据</div>
                                                        </div>
                                                    ) }}
                                                    pagination={false}
                                                />
                                            </div>
                                        </div>
                                    )}
                                    {detailTab !== 'userInfo' && (
                                        <div style={{ textAlign: 'center', padding: '40px', color: '#8c8c8c' }}>
                                            功能开发中...
                                        </div>
                                    )}
                                </div>
                            </div>
                        ) : (
                            <div style={{ 
                                textAlign: 'center', 
                                padding: '60px 20px', 
                                color: '#8c8c8c',
                                height: '100%',
                                display: 'flex',
                                flexDirection: 'column',
                                justifyContent: 'center'
                            }}>
                                <div style={{ fontSize: '48px', marginBottom: '16px' }}>📋</div>
                                <h3>请选择一条线索查看详情</h3>
                                <p>点击表格中的"查看详情"按钮</p>
                            </div>
                        )}
                        {/* 聊天详情抽屉 */}
                        <Drawer
                            title={
                                <div style={{
                                    display: 'flex',
                                    flexDirection: 'column',
                                    gap: '12px',
                                    width: '100%',
                                    paddingRight: '24px'
                                }}>
                                    <div style={{ fontSize: '16px', fontWeight: 500, marginBottom: '4px' }}>详情</div>
                                    {/* 筛选栏 - 消息类型、日期范围、搜索框在同一行 */}
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '12px',
                                        flexWrap: 'nowrap',
                                        overflow: 'hidden',
                                        width: '100%'
                                    }}>
                                        {/* 消息类型下拉选择框 */}
                                        <Select
                                            value={chatMessageTypeFilter}
                                            onChange={(value) => setChatMessageTypeFilter(value)}
                                            style={{ width: 150, flexShrink: 0 }}
                                            size="small"
                                        >
                                            <Select.Option value="全部">全部</Select.Option>
                                            <Select.Option value="文本">文本</Select.Option>
                                            <Select.Option value="表情">表情</Select.Option>
                                            <Select.Option value="语音">语音</Select.Option>
                                            <Select.Option value="图片">图片</Select.Option>
                                            <Select.Option value="视频">视频</Select.Option>
                                            <Select.Option value="文件">文件</Select.Option>
                                            <Select.Option value="链接">链接</Select.Option>
                                            <Select.Option value="红包">红包</Select.Option>
                                            <Select.Option value="名片">名片</Select.Option>
                                            <Select.Option value="位置">位置</Select.Option>
                                            <Select.Option value="小程序消息">小程序消息</Select.Option>
                                            <Select.Option value="撤回消息">撤回消息</Select.Option>
                                        </Select>
                                        
                                        {/* 日期范围选择 */}
                                        <RangePicker
                                            value={chatDateRangeFilter}
                                            onChange={(dates) => setChatDateRangeFilter(dates)}
                                            showTime={{ format: 'HH:mm:ss' }}
                                            format="YYYY/MM/DD HH:mm:ss"
                                            placeholder={['开始日期', '结束日期']}
                                            style={{ width: 360, flexShrink: 0 }}
                                            size="small"
                                        />
                                        
                                        {/* 搜索框 */}
                                        <div style={{ flex: '1 1 auto', minWidth: 0, display: 'flex', alignItems: 'center', gap: '8px' }}>
                                            <ChatSearchBox 
                                                searchKeyword={chatSearchKeyword}
                                                setSearchKeyword={setChatSearchKeyword}
                                                matchCount={chatMatchCount}
                                                setMatchCount={setChatMatchCount}
                                                currentMatchIndex={chatCurrentMatchIndex}
                                                setCurrentMatchIndex={setChatCurrentMatchIndex}
                                                matchRefs={chatMatchRefs}
                                                setMatchRefs={setChatMatchRefs}
                                                containerSelector=".chat-detail-container"
                                            />
                                        </div>
                                    </div>
                                </div>
                            }
                            placement="right"
                            onClose={() => {
                                // 清除搜索高亮
                                const container = document.querySelector('.chat-detail-container');
                                if (container) {
                                    container.querySelectorAll('.search-highlight').forEach(mark => {
                                        const parent = mark.parentNode;
                                        if (parent) {
                                            parent.replaceChild(document.createTextNode(mark.textContent), mark);
                                            parent.normalize();
                                        }
                                    });
                                    container.querySelectorAll('.search-match').forEach(el => {
                                        el.classList.remove('search-match');
                                    });
                                }
                                // 重置搜索状态
                                setChatSearchKeyword('');
                                setChatMatchCount(0);
                                setChatCurrentMatchIndex(0);
                                setChatMatchRefs([]);
                                setChatDetailVisible(false);
                            }}
                            open={chatDetailVisible}
                            width="66.67%"
                            maskClosable={true}
                            style={{ zIndex: 1100 }}
                        >
                            {/* 这里使用 mock 的 record 数据，与之前静态展示的李明数据一致 */}
                            <ChatDetail 
                                record={{
                                    sender: 'Weeki Tian',
                                    receiver: 'LiMing'
                                }} 
                                messageTypeFilter={chatMessageTypeFilter} 
                                dateRangeFilter={chatDateRangeFilter} 
                            />
                        </Drawer>
                        
                        {/* 外呼记录详情抽屉 - 复用智能外呼记录的Drawer实现 */}
                        <Drawer
                            title={null}
                            placement="right"
                            onClose={() => {
                                setOutboundCallDetailVisible(false);
                                setSelectedOutboundCall(null);
                            }}
                            open={outboundCallDetailVisible}
                            width="66.666%"
                            closable={true}
                            style={{ zIndex: 1000 }}
                            bodyStyle={{ padding: 0, height: '100%', overflow: 'hidden' }}
                            headerStyle={{ display: 'none' }}
                        >
                            {selectedOutboundCall && (
                                <div style={{ display: 'flex', height: '100%' }}>
                                    {/* 左侧通话内容区域 */}
                                    <div style={{ flex: 1, display: 'flex', flexDirection: 'column', borderRight: '1px solid #f0f0f0' }}>
                                        {/* 顶部标题栏 */}
                                        <div style={{ 
                                            padding: '16px 20px', 
                                            borderBottom: '1px solid #f0f0f0',
                                            display: 'flex',
                                            alignItems: 'center',
                                            background: '#fff'
                                        }}>
                                            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                                <span style={{ fontSize: '16px', fontWeight: 600, color: '#262626' }}>通话详情</span>
                                            </div>
                                        </div>

                                        {/* 通话内容滚动区域 */}
                                        <div style={{ 
                                            flex: 1, 
                                            overflow: 'auto', 
                                            padding: '20px',
                                            background: '#f5f5f5'
                                        }}>
                                            {/* 检查接通状态 */}
                                            {selectedOutboundCall.connectStatus === '未接通' ? (
                                                <div style={{ textAlign: 'center', padding: '60px 20px', color: '#8c8c8c' }}>
                                                    <i data-lucide="phone-off" style={{ width: '48px', height: '48px', marginBottom: '16px', color: '#d9d9d9' }}></i>
                                                    <h4 style={{ fontSize: '16px', marginBottom: '8px', color: '#262626' }}>未接通</h4>
                                                    <p>通话未能接通，没有录音记录</p>
                                                    <p style={{ fontSize: '12px', marginTop: '4px', color: '#999' }}>
                                                        未接通原因：{selectedOutboundCall.noConnectReason || '未知'}
                                                    </p>
                                                </div>
                                            ) : (
                                                <>
                                                    {/* 时间标记 - 仅已接通显示 */}
                                                    <div style={{ textAlign: 'center', marginBottom: '20px' }}>
                                                        <span style={{ 
                                                            fontSize: '12px', 
                                                            color: '#8c8c8c', 
                                                            background: '#e8e8e8',
                                                            padding: '4px 12px',
                                                            borderRadius: '10px'
                                                        }}>
                                                            {selectedOutboundCall.callStartTime}
                                                        </span>
                                                    </div>

                                                    {/* 对话消息列表 - 仅已接通显示 */}
                                                    {callTranscripts[selectedOutboundCall.key] && callTranscripts[selectedOutboundCall.key].length > 0 ? (
                                                        callTranscripts[selectedOutboundCall.key].map((msg, index) => {
                                                            const isRobot = msg.role === 'robot';
                                                            return (
                                                                <div 
                                                                    key={msg.id || index}
                                                                    style={{ 
                                                                        display: 'flex', 
                                                                        justifyContent: isRobot ? 'flex-end' : 'flex-start',
                                                                        marginBottom: '16px'
                                                                    }}
                                                                >
                                                                    {/* 被叫用户消息 - 左侧 */}
                                                                    {!isRobot && (
                                                                        <div style={{ display: 'flex', maxWidth: '70%' }}>
                                                                            <Avatar 
                                                                                style={{ 
                                                                                    backgroundColor: '#52c41a', 
                                                                                    marginRight: '8px',
                                                                                    flexShrink: 0
                                                                                }} 
                                                                                size={36}
                                                                                icon={<i data-lucide="user" style={{ width: '16px', height: '16px' }}></i>}
                                                                            />
                                                                            <div>
                                                                                <div style={{ fontSize: '12px', color: '#8c8c8c', marginBottom: '4px' }}>
                                                                                    被叫用户
                                                                                </div>
                                                                                <div style={{ 
                                                                                    background: '#fff', 
                                                                                    padding: '10px 14px', 
                                                                                    borderRadius: '0 12px 12px 12px',
                                                                                    fontSize: '14px',
                                                                                    lineHeight: 1.6,
                                                                                    color: '#262626',
                                                                                    boxShadow: '0 1px 2px rgba(0,0,0,0.06)'
                                                                                }}>
                                                                                    {msg.text}
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    )}

                                                                    {/* 机器人消息 - 右侧 */}
                                                                    {isRobot && (
                                                                        <div style={{ display: 'flex', maxWidth: '70%' }}>
                                                                            <div style={{ textAlign: 'right' }}>
                                                                                <div style={{ fontSize: '12px', color: '#8c8c8c', marginBottom: '4px' }}>
                                                                                    机器人名称
                                                                                </div>
                                                                                <div style={{ 
                                                                                    background: '#1890ff', 
                                                                                    padding: '10px 14px', 
                                                                                    borderRadius: '12px 0 12px 12px',
                                                                                    fontSize: '14px',
                                                                                    lineHeight: 1.6,
                                                                                    color: '#fff',
                                                                                    boxShadow: '0 1px 2px rgba(0,0,0,0.1)'
                                                                                }}>
                                                                                    {msg.text}
                                                                                </div>
                                                                            </div>
                                                                            <Avatar 
                                                                                style={{ 
                                                                                    backgroundColor: '#722ed1',
                                                                                    marginLeft: '8px',
                                                                                    flexShrink: 0
                                                                                }} 
                                                                                size={36}
                                                                                icon={<i data-lucide="bot" style={{ width: '16px', height: '16px' }}></i>}
                                                                            />
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            );
                                                        })
                                                    ) : (
                                                        <div style={{ textAlign: 'center', padding: '40px', color: '#8c8c8c' }}>
                                                            <i data-lucide="message-square" style={{ width: '32px', height: '32px', marginBottom: '12px', color: '#d9d9d9' }}></i>
                                                            <p>暂无通话记录内容</p>
                                                        </div>
                                                    )}
                                                </>
                                            )}
                                        </div>

                                        {/* 底部音频播放器 */}
                                        {selectedOutboundCall.connectStatus === '已接通' && selectedOutboundCall.recordingUrl && (
                                            <div style={{ 
                                                padding: '12px 20px', 
                                                borderTop: '1px solid #f0f0f0',
                                                background: '#fff',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '12px'
                                            }}>
                                                <Button type="primary" shape="circle" icon={<i data-lucide="play" style={{ width: '14px', height: '14px' }}></i>} />
                                                <div style={{ flex: 1 }}>
                                                    <audio 
                                                        controls 
                                                        src={selectedOutboundCall.recordingUrl}
                                                        style={{ width: '100%', height: '32px' }}
                                                    />
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    {/* 右侧信息面板 */}
                                    <div style={{ width: '320px', display: 'flex', flexDirection: 'column', background: '#fff' }}>
                                        {/* 右侧选项卡 */}
                                        <div style={{ 
                                            display: 'flex', 
                                            borderBottom: '1px solid #f0f0f0',
                                            padding: '0 16px'
                                        }}>
                                            <div
                                                onClick={() => setCallDetailActiveTab('callDetail')}
                                                style={{
                                                    padding: '12px 16px',
                                                    cursor: 'pointer',
                                                    borderBottom: callDetailActiveTab === 'callDetail' ? '2px solid #1890ff' : '2px solid transparent',
                                                    color: callDetailActiveTab === 'callDetail' ? '#1890ff' : '#666',
                                                    fontWeight: callDetailActiveTab === 'callDetail' ? 500 : 400,
                                                    marginBottom: '-1px',
                                                    fontSize: '14px'
                                                }}
                                            >
                                                通话详情
                                            </div>
                                            <div
                                                onClick={() => setCallDetailActiveTab('callSummary')}
                                                style={{
                                                    padding: '12px 16px',
                                                    cursor: 'pointer',
                                                    borderBottom: callDetailActiveTab === 'callSummary' ? '2px solid #1890ff' : '2px solid transparent',
                                                    color: callDetailActiveTab === 'callSummary' ? '#1890ff' : '#666',
                                                    fontWeight: callDetailActiveTab === 'callSummary' ? 500 : 400,
                                                    marginBottom: '-1px',
                                                    fontSize: '14px'
                                                }}
                                            >
                                                通话总结
                                            </div>
                                        </div>

                                        {/* 右侧内容区域 */}
                                        <div style={{ flex: 1, overflow: 'auto', padding: '16px' }}>
                                            {callDetailActiveTab === 'callDetail' && (
                                                <div>
                                                    {/* 基本信息 */}
                                                    <div style={{ marginBottom: '24px' }}>
                                                        <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>基本信息</h4>
                                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话ID</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {selectedOutboundCall.callId || '无'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>线索ID</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.leadId || '无'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>客户ID</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.uid || '无'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>联系人姓名</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.contactName || '-'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>被叫号码</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.calleeNumber || '-'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>外呼任务名称</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.taskName || '未知任务'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>外呼机器人</span>
                                                                <span style={{ color: '#1890ff', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.robotName || '默认机器人'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>触发短信</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.smsTriggered || '否'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话开始时间</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.callStartTime || '-'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话时长</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.callDuration || '0分0秒'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话结束时间</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{selectedOutboundCall.callEndTime || '-'}</span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>接通状态</span>
                                                                <span style={{ 
                                                                    color: selectedOutboundCall.connectStatus === '已接通' ? '#52c41a' : '#ff4d4f', 
                                                                    fontSize: '13px',
                                                                    marginLeft: '10px'
                                                                }}>
                                                                    {selectedOutboundCall.connectStatus || '未知'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>未接通原因</span>
                                                                <span style={{ 
                                                                    color: selectedOutboundCall.connectStatus === '未接通' ? '#ff4d4f' : '#8c8c8c', 
                                                                    fontSize: '13px',
                                                                    marginLeft: '10px'
                                                                }}>
                                                                    {selectedOutboundCall.noConnectReason || '-'}
                                                                </span>
                                                            </div>

                                                        </div>
                                                    </div>

                                                    {/* 意向标签 */}
                                                    <div style={{ marginBottom: '24px' }}>
                                                        <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>意向标签</h4>
                                                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                                                            <Tag color="green">{selectedOutboundCall.aiTags?.overallIntent || '高'}意向</Tag>
                                                            <Tag>{selectedOutboundCall.aiTags?.industry || '未知行业'}</Tag>
                                                            {selectedOutboundCall.aiTags?.businessScene && (
                                                                <Tag color="blue">{selectedOutboundCall.aiTags.businessScene}</Tag>
                                                            )}
                                                        </div>
                                                    </div>

                                                </div>
                                            )}

                                            {callDetailActiveTab === 'callSummary' && (
                                                <div>
                                                    {/* 大模型标签信息 */}
                                                    <div style={{ marginBottom: '24px' }}>
                                                        <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>大模型标签信息</h4>
                                                        {selectedOutboundCall.connectStatus === '已接通' ? (
                                                            <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>是否再次回电</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.callAgain || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>业务应用场景</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.businessScene || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>整体意向</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.overallIntent || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>竞品情况</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.competitorInfo || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>正面评价</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.positiveFeedback || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>负面评价</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.negativeFeedback || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>持续调用的原因</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.continueReason || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>项目情况</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.projectStatus || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>没有申请商用授权的原因</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.noCommercialReason || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>行业</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.industry || '未获取'}
                                                                    </span>
                                                                </div>
                                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                    <span style={{ color: '#8c8c8c', fontSize: '13px' }}>客户采购预算</span>
                                                                    <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                        {selectedOutboundCall.aiTags?.budget || '未获取'}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        ) : (
                                                            <div style={{ fontSize: '13px', color: '#8c8c8c', fontStyle: 'italic', padding: '12px 0' }}>
                                                                未接通通话无大模型分析标签
                                                            </div>
                                                        )}
                                                    </div>

                                                    {/* 用户问题 */}
                                                    <div>
                                                        <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>用户问题</h4>
                                                        {selectedOutboundCall.connectStatus === '已接通' ? (
                                                            <div style={{ fontSize: '13px', color: '#595959' }}>
                                                                {selectedOutboundCall.pendingQuestions && selectedOutboundCall.pendingQuestions.length > 0 ? (
                                                                    selectedOutboundCall.pendingQuestions.map((question, index) => (
                                                                        <div key={index} style={{ marginBottom: '8px', paddingLeft: '12px', borderLeft: '2px solid #e8e8e8' }}>
                                                                            {question}
                                                                        </div>
                                                                    ))
                                                                ) : (
                                                                    <div style={{ color: '#8c8c8c', fontStyle: 'italic' }}>暂无待明确问题</div>
                                                                )}
                                                            </div>
                                                        ) : (
                                                            <div style={{ fontSize: '13px', color: '#8c8c8c', fontStyle: 'italic', padding: '12px 0' }}>
                                                                未接通通话无用户问题记录
                                                            </div>
                                                        )}
                                                    </div>

                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            )}
                        </Drawer>
                        
                        {/* 录音转文字弹窗 */}
                        <Modal
                            title="录音转文字"
                            open={transcriptModalVisible}
                            onCancel={() => {
                                setTranscriptModalVisible(false);
                                setCurrentTranscriptCallKey(null);
                            }}
                            footer={null}
                            width={720}
                            centered
                            maskClosable={true}
                            bodyStyle={{ padding: '16px 24px', maxHeight: '520px', overflowY: 'auto', background: '#EDEDED' }}
                        >
                            <div style={{ paddingTop: '8px' }}>
                                {(callTranscripts[currentTranscriptCallKey] || []).length === 0 ? (
                                    <div style={{ textAlign: 'center', color: '#999', padding: '40px 0' }}>
                                        暂无转写内容
                                    </div>
                                ) : (
                                    callTranscripts[currentTranscriptCallKey].map((msg) => {
                                        const isRobot = msg.role === 'robot';
                                        return (
                                            <div
                                                key={msg.id}
                                                style={{
                                                    display: 'flex',
                                                    justifyContent: isRobot ? 'flex-end' : 'flex-start',
                                                    marginBottom: '12px'
                                                }}
                                            >
                                                {!isRobot && (
                                                    <Avatar
                                                        style={{
                                                            backgroundColor: '#ffffff',
                                                            color: '#666',
                                                            marginRight: '8px'
                                                        }}
                                                        size={28}
                                                    >
                                                        <i data-lucide="user" style={{ width: '14px', height: '14px' }}></i>
                                                    </Avatar>
                                                )}
                                                <div
                                                    style={{
                                                        maxWidth: '70%',
                                                        backgroundColor: isRobot ? '#95EC69' : '#ffffff',
                                                        color: '#000000',
                                                        padding: '8px 12px',
                                                        borderRadius: 12,
                                                        borderTopLeftRadius: isRobot ? 12 : 2,
                                                        borderTopRightRadius: isRobot ? 2 : 12,
                                                        boxShadow: '0 1px 2px rgba(0,0,0,0.06)',
                                                        fontSize: '13px',
                                                        lineHeight: 1.6,
                                                        whiteSpace: 'pre-wrap'
                                                    }}
                                                >
                                                    {msg.text}
                                                </div>
                                                {isRobot && (
                                                    <Avatar
                                                        style={{
                                                            backgroundColor: '#95EC69',
                                                            color: '#000',
                                                            marginLeft: '8px'
                                                        }}
                                                        size={28}
                                                    >
                                                        <i data-lucide="bot" style={{ width: '14px', height: '14px' }}></i>
                                                    </Avatar>
                                                )}
                                            </div>
                                        );
                                    })
                                )}
                            </div>
                        </Modal>
                    </Drawer>
                </div>
            );
        };

        // 企业微信客户端页面
        const WeChatClientPage = ({ onBack }) => {
            const [selectedContact, setSelectedContact] = useState(null);
            const [timelineFilter, setTimelineFilter] = useState('全部');
            const [showBackToTop, setShowBackToTop] = useState(false);
            const [leadDetailTab, setLeadDetailTab] = useState('detail'); // 线索详情Tab：'detail' 或 'timeline'
            const [isEditingLeadDetail, setIsEditingLeadDetail] = useState(false); // 是否正在编辑线索详情
            const [leadDescription, setLeadDescription] = useState('客户计划开发一款智能物流配送管理系统，需要集成地图API实现实时车辆定位、路径规划、配送路线优化等功能。主要应用场景包括：配送员位置追踪、最优配送路径计算、电子围栏监控、地址解析与逆解析等。希望通过地图服务提升配送效率，降低运营成本。'); // 线索描述内容
            const [originalLeadDescription, setOriginalLeadDescription] = useState(''); // 原始线索描述内容（用于取消时恢复）
            const sidebarScrollRef = React.useRef(null);
            const sidebarContainerRef = React.useRef(null);
            const [showLeadSelection, setShowLeadSelection] = useState(false);
            const [showRebindSelection, setShowRebindSelection] = useState(false);
            const [leadSearchKeyword, setLeadSearchKeyword] = useState('');
            const [selectedLeadId, setSelectedLeadId] = useState(null);
            // 通知销售跟进处理函数
            const handleNotifySales = () => {
                if (!sidebarContainerRef.current) return;
                
                // 创建遮罩层和弹窗
                const confirmDiv = document.createElement('div');
                confirmDiv.style.cssText = 'position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
                
                const dialog = document.createElement('div');
                dialog.style.cssText = 'background: #fff; padding: 24px; border-radius: 8px; max-width: 280px; width: 90%; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
                const dialogId = 'notify-dialog-' + Date.now();
                dialog.id = dialogId;
                dialog.innerHTML = `
                    <div style="margin-bottom: 20px; font-size: 14px; color: #262626; line-height: 1.5;">请确认此用户有商用授权需求，点击”确认“将发送通知给销售人员。</div>
                    <div style="display: flex; gap: 12px; justify-content: flex-end;">
                        <button id="cancel-btn-${dialogId}" style="padding: 8px 16px; border: 1px solid #d9d9d9; background: #fff; border-radius: 4px; cursor: pointer; font-size: 14px; color: #262626; transition: all 0.2s;">取消</button>
                        <button id="confirm-btn-${dialogId}" style="padding: 8px 16px; border: none; background: #1890ff; color: #fff; border-radius: 4px; cursor: pointer; font-size: 14px; transition: all 0.2s;">确认</button>
                    </div>
                `;
                confirmDiv.appendChild(dialog);
                sidebarContainerRef.current.appendChild(confirmDiv);
                
                // 取消按钮逻辑
                const cancelBtn = document.getElementById(`cancel-btn-${dialogId}`);
                cancelBtn.onclick = () => {
                    if (sidebarContainerRef.current && sidebarContainerRef.current.contains(confirmDiv)) {
                        sidebarContainerRef.current.removeChild(confirmDiv);
                    }
                };
                cancelBtn.onmouseenter = (e) => {
                    e.target.style.borderColor = '#1890ff';
                    e.target.style.color = '#1890ff';
                };
                cancelBtn.onmouseleave = (e) => {
                    e.target.style.borderColor = '#d9d9d9';
                    e.target.style.color = '#262626';
                };
                
                // 确认按钮逻辑
                const confirmBtn = document.getElementById(`confirm-btn-${dialogId}`);
                confirmBtn.onclick = () => {
                    if (sidebarContainerRef.current && sidebarContainerRef.current.contains(confirmDiv)) {
                        sidebarContainerRef.current.removeChild(confirmDiv);
                    }
                    
                    // 显示成功提示（在侧边栏内）
                    const toast = document.createElement('div');
                    toast.textContent = '发送通知成功';
                    toast.style.cssText = 'position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: #52c41a; padding: 12px 24px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000; font-size: 14px; color: #fff; pointer-events: none;';
                    sidebarContainerRef.current.appendChild(toast);
                    setTimeout(() => {
                        if (sidebarContainerRef.current && sidebarContainerRef.current.contains(toast)) {
                            sidebarContainerRef.current.removeChild(toast);
                        }
                    }, 2000);
                };
                confirmBtn.onmouseenter = (e) => {
                    e.target.style.backgroundColor = '#40a9ff';
                };
                confirmBtn.onmouseleave = (e) => {
                    e.target.style.backgroundColor = '#1890ff';
                };
            };
            
            // 当选中联系人改变时，如果正在子页面，则关闭子页面
            React.useEffect(() => {
                if (selectedContact && (showLeadSelection || showRebindSelection)) {
                    setShowLeadSelection(false);
                    setShowRebindSelection(false);
                    setLeadSearchKeyword('');
                    setSelectedLeadId(null);
                }
            }, [selectedContact]);

            // 线索数据（用于关联线索功能）
            const leadDataList = [
                { id: 139, uid: '123456789', certName: '福建省某科技有限公司', business: 'wangxuefei01', createTime: '2022-07-05 11:01:12' },
                { id: 13, uid: '987654321', certName: '宁夏回族自治区某企业', business: 'zhouyuanyuan03', createTime: '2022-07-05 11:01:14' },
                { id: 20, uid: '456789123', certName: '-', business: 'tianbowen', createTime: '2022-07-05 11:01:15' },
                { id: 14, uid: '789123456', certName: '福建省某信息公司', business: 'guoweiting', createTime: '2022-07-05 11:01:26' },
                { id: 21, uid: '321654987', certName: '福建省某网络公司', business: 'yangbencheng', createTime: '2022-07-05 11:01:31' },
                { id: 22, uid: '654987321', certName: '重庆市某科技公司', business: 'liuwei91', createTime: '2022-07-05 11:01:41' },
                { id: 23, uid: '147258369', certName: '重庆市某技术公司', business: 'wangya06', createTime: '2022-07-05 11:01:54' },
                { id: 24, uid: '258369147', certName: '重庆中盛天喻科技有限公司', business: 'wangjianjun04', createTime: '2022-07-05 11:01:56' },
                { id: 15, uid: '369147258', certName: '北京市某科技公司', business: 'zhangwei05', createTime: '2022-07-05 11:02:10' },
                { id: 16, uid: '741852963', certName: '上海市某信息公司', business: 'lisi08', createTime: '2022-07-05 11:02:25' },
                { id: 17, uid: '852963741', certName: '广东省某网络公司', business: 'wangwu09', createTime: '2022-07-05 11:02:38' },
                { id: 18, uid: '963741852', certName: '江苏省某技术公司', business: 'zhaoliu10', createTime: '2022-07-05 11:02:45' }
            ];

            // 筛选线索数据
            const filteredLeads = React.useMemo(() => {
                if (!leadDataList || !Array.isArray(leadDataList)) return [];
                if (!leadSearchKeyword) return leadDataList;
                const keyword = leadSearchKeyword.toLowerCase();
                return leadDataList.filter(lead => {
                    return (
                        (lead.certName && lead.certName !== '-' && typeof lead.certName === 'string' && lead.certName.toLowerCase().includes(keyword)) ||
                        (lead.id && lead.id.toString().includes(keyword)) ||
                        (lead.uid && lead.uid.toString().includes(keyword))
                    );
                });
            }, [leadSearchKeyword, leadDataList]);
            
            // 微信客户数据
            const wechatContacts = [
                {
                    id: 1,
                    name: '张伟',
                    nickname: 'Weeki Tian',
                    avatar: 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=150&h=150&fit=crop&crop=faces',
                    gender: '♂',
                    phone: '13897888894',
                    addTime: '2026-01-20 16:00',
                    source: '通过搜索手机号添加',
                    remark: '大张伟',
                    tags: ['VIP客户', '高意向'],
                    lastMessage: '您好!感谢您选...',
                    lastTime: '8分钟前',
                    contactType: 'wechat', // 'wechat' 或 'enterprise'
                    messages: [
                        { type: 'system', content: '我通过了你的联系人验证请求,现在我们可以开始聊天了' },
                        { type: 'system', content: '你已添加了 Weeki Tian,现在可以开始聊天了。' },
                        { type: 'received', content: '您好!感谢您选择百度地图开放平台。为了优化我们的服务并改善与您的沟通，我们邀请您参与一个30秒的简短调研。您的反馈对我们非常重要，将帮助我们更好地为您服务。请点击以下链接参与调研：https://iwenjuan.baidu.com/?code=qo1bw9 祝您有愉快的一天!😊' },
                        { type: 'sent', content: '好的，我会抽时间填写调研的。' },
                        { type: 'received', content: '非常感谢您的配合！' }
                    ]
                },
                {
                    id: 2,
                    name: '李明',
                    nickname: 'LiMing',
                    avatar: 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=150&h=150&fit=crop&crop=faces',
                    gender: '♂',
                    phone: '13912345678',
                    addTime: '2026-01-19 14:30',
                    source: '通过名片添加',
                    remark: '李明',
                    tags: ['重要客户', '已合作'],
                    lastMessage: '关于API接口的问题...',
                    lastTime: '15分钟前',
                    contactType: 'enterprise', // 'wechat' 或 'enterprise'
                    messages: [
                        { type: 'system', content: '你已添加了 LiMing,现在可以开始聊天了。' },
                        { type: 'sent', content: '您好，关于上次讨论的API接口问题，我想再确认一下。' },
                        { type: 'received', content: '好的，您说具体是哪个接口？' },
                        { type: 'sent', content: '主要是地图标注接口，想了解一下批量操作的性能。' },
                        { type: 'received', content: '批量操作建议每次不超过100条，这样可以保证响应速度。' },
                        { type: 'sent', content: '明白了，谢谢！' }
                    ]
                }
            ];

            // 线索动态记录数据
            const timelineRecords = [
                {
                    id: 0,
                    type: '跟进记录',
                    time: '2026-01-20 14:43',
                    status: '40% 客户内部评估',
                    operator: 'v_tianbowen',
                    action: '微信',
                    details: {
                        communication: '客户就API接口问题进行了咨询，主要关注地图标注接口的批量操作性能。我方建议批量操作每次不超过100条以保证响应速度，客户表示理解。后续讨论了实施计划和技术文档，客户表示会安排技术团队评估。整体沟通顺畅，客户对产品表现出较高兴趣。'
                    }
                },
                {
                    id: 1,
                    type: '跟进记录',
                    time: '2026-01-19 12:05',
                    status: '40% 客户内部评估',
                    operator: 'v_tianbowen',
                    action: '当面拜访',
                    details: {
                        visitTime: '2026-01-19 12:05',
                        reason: '评估价格',
                        enterpriseInfo: '客户未告知',
                        communication: '沟通详情'
                    },
                    attachment: '图片1'
                },
                {
                    id: 2,
                    type: '跟进记录',
                    time: '2026-01-18 15:30',
                    status: '40% 客户内部评估',
                    operator: 'v_tianbowen',
                    action: '电话沟通',
                    details: {
                        reason: '了解需求',
                        communication: '客户对API接口性能有较高要求，需要进一步评估'
                    }
                },
                {
                    id: 3,
                    type: '咨询记录',
                    time: '2026-01-17 10:20',
                    status: '20% 初步建联',
                    operator: 'v_tianbowen',
                    action: '官网留资',
                    details: {
                        companyName: '北京百度网讯科技有限公司',
                        contactName: '李明',
                        contactPhone: '139****5678',
                        contactEmail: 'liming@baidu.com',
                        leadSource: '企业认证',
                        remarks: '已初步沟通'
                    }
                },
                {
                    id: 4,
                    type: '系统变更',
                    time: '2026-01-16 14:15',
                    status: '40% 客户内部评估',
                    operator: '系统',
                    action: '创建商机',
                    details: {
                        change: '系统变更'
                    }
                },
                {
                    id: 5,
                    type: '跟进记录',
                    time: '2026-01-15 09:45',
                    status: '20% 初步建联',
                    operator: 'v_tianbowen',
                    action: '邮件发送',
                    details: {
                        reason: '发送产品资料',
                        communication: '已发送API接口文档和技术方案'
                    },
                    attachment: '文档1'
                },
                {
                    id: 6,
                    type: '咨询记录',
                    time: '2026-01-14 16:30',
                    status: '20% 初步建联',
                    operator: 'v_tianbowen',
                    action: '官网留资',
                    details: {
                        companyName: '北京百度网讯科技有限公司',
                        contactName: '李明',
                        contactPhone: '139****5678',
                        contactEmail: 'liming@baidu.com',
                        leadSource: '企业认证',
                        remarks: '首次咨询'
                    }
                },
                {
                    id: 7,
                    type: '系统变更',
                    time: '2026-01-13 19:46',
                    status: '20% 初步建联',
                    operator: '系统',
                    action: '创建商机',
                    details: {
                        change: '系统变更'
                    }
                },
                {
                    id: 8,
                    type: '系统变更',
                    time: '2026-01-13 17:46',
                    status: '0% 未建联',
                    operator: '系统',
                    action: '所属人变更',
                    details: {
                        change: '系统变更'
                    }
                },
                {
                    id: 9,
                    type: '跟进记录',
                    time: '2026-01-12 11:20',
                    status: '20% 初步建联',
                    operator: 'v_tianbowen',
                    action: '微信沟通',
                    details: {
                        reason: '初步了解',
                        communication: '客户对地图服务感兴趣，需要进一步沟通'
                    }
                },
                {
                    id: 10,
                    type: '咨询记录',
                    time: '2026-01-11 14:55',
                    status: '20% 初步建联',
                    operator: 'v_tianbowen',
                    action: '官网留资',
                    details: {
                        companyName: '北京百度网讯科技有限公司',
                        contactName: '李明',
                        contactPhone: '139****5678',
                        contactEmail: 'liming@baidu.com',
                        leadSource: '企业认证',
                        remarks: '-'
                    }
                },
                {
                    id: 11,
                    type: '跟进记录',
                    time: '2026-01-10 08:30',
                    status: '20% 初步建联',
                    operator: 'v_tianbowen',
                    action: '电话沟通',
                    details: {
                        reason: '首次联系',
                        communication: '介绍产品和服务'
                    }
                },
                {
                    id: 12,
                    type: '系统变更',
                    time: '2026-01-09 10:15',
                    status: '0% 未建联',
                    operator: '系统',
                    action: '线索创建',
                    details: {
                        change: '系统变更'
                    }
                }
            ];

            // 筛选后的记录
            const filteredRecords = timelineFilter === '全部' 
                ? timelineRecords 
                : timelineRecords.filter(record => record.type === timelineFilter);

            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            // 监听侧边栏滚动
            useEffect(() => {
                const handleScroll = () => {
                    const scrollContainer = sidebarScrollRef.current;
                    if (scrollContainer) {
                        setShowBackToTop(scrollContainer.scrollTop > 100);
                    }
                };

                const scrollContainer = sidebarScrollRef.current;
                if (scrollContainer) {
                    scrollContainer.addEventListener('scroll', handleScroll);
                    return () => {
                        scrollContainer.removeEventListener('scroll', handleScroll);
                    };
                }
            }, [selectedContact]);

            // 回到顶部
            const scrollToTop = () => {
                if (sidebarScrollRef.current) {
                    sidebarScrollRef.current.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
            };

            // 默认选中第一个客户
            useEffect(() => {
                if (wechatContacts.length > 0 && !selectedContact) {
                    setSelectedContact(wechatContacts[0]);
                }
            }, [selectedContact]);

            return (
                <div style={{ 
                    position: 'fixed',
                    top: 0,
                    left: 0,
                    right: 0,
                    bottom: 0,
                    backgroundColor: '#f5f5f5',
                    zIndex: 1000,
                    display: 'flex',
                    flexDirection: 'column'
                }}>
                    {/* 顶部栏 */}
                    <div style={{
                        height: '40px',
                        backgroundColor: '#fff',
                        borderBottom: '1px solid #e0e0e0',
                        display: 'flex',
                        alignItems: 'center',
                        padding: '0 16px',
                        boxShadow: '0 1px 4px rgba(0,0,0,0.05)'
                    }}>
                        {/* 返回按钮 */}
                        <button
                            onClick={onBack}
                            style={{
                                display: 'flex',
                                alignItems: 'center',
                                gap: '6px',
                                background: 'none',
                                border: 'none',
                                cursor: 'pointer',
                                padding: '4px 8px',
                                borderRadius: '4px',
                                fontSize: '14px',
                                color: '#333',
                                transition: 'background-color 0.2s'
                            }}
                            onMouseEnter={(e) => {
                                e.currentTarget.style.backgroundColor = '#f5f5f5';
                            }}
                            onMouseLeave={(e) => {
                                e.currentTarget.style.backgroundColor = 'transparent';
                            }}
                        >
                            <i data-lucide="arrow-left" style={{ width: '16px', height: '16px' }}></i>
                            <span>返回系统</span>
                        </button>
                        
                        {/* 标题 */}
                        <div style={{ 
                            flex: 1, 
                            textAlign: 'center', 
                            fontSize: '16px', 
                            fontWeight: 500,
                            color: '#262626'
                        }}>
                            企业微信端
                        </div>
                        
                        {/* 右侧占位 */}
                        <div style={{ width: '100px' }}></div>
                    </div>

                    {/* 内容区域 */}
                    <div style={{
                        flex: 1,
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        padding: '20px',
                        overflow: 'hidden',
                        position: 'relative',
                        minHeight: 0
                    }}>
                        {/* Mac版企业微信客户端 */}
                        <div style={{
                            width: '100%',
                            height: '100%',
                            maxWidth: '1200px',
                            maxHeight: '800px',
                            backgroundColor: '#fff',
                            borderRadius: '8px',
                            boxShadow: '0 4px 20px rgba(0,0,0,0.15)',
                            display: 'flex',
                            overflow: 'hidden',
                            position: 'relative'
                        }}>
                            {/* 左侧：导航栏 */}
                            <div style={{
                                width: '60px',
                                backgroundColor: '#2c2c2c',
                                display: 'flex',
                                flexDirection: 'column',
                                alignItems: 'center',
                                paddingTop: '20px',
                                gap: '20px'
                            }}>
                                <div style={{
                                    width: '40px',
                                    height: '40px',
                                    borderRadius: '50%',
                                    backgroundColor: '#4a90e2',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    color: '#fff',
                                    fontSize: '18px',
                                    fontWeight: 'bold'
                                }}>
                                    田
                                </div>
                                <div style={{ display: 'flex', flexDirection: 'column', gap: '16px', alignItems: 'center' }}>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px', backgroundColor: '#4a90e2' }}>
                                        <i data-lucide="message-circle" style={{ width: '20px', height: '20px', color: '#fff' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="mail" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="file-text" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="calendar" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="video" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="grid" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="layout-grid" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="users" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                    <div style={{ width: '32px', height: '32px', display: 'flex', alignItems: 'center', justifyContent: 'center', cursor: 'pointer', borderRadius: '4px' }}>
                                        <i data-lucide="more-horizontal" style={{ width: '20px', height: '20px', color: '#999' }}></i>
                                    </div>
                                </div>
                                <div style={{ marginTop: 'auto', marginBottom: '20px' }}>
                                    <i data-lucide="home" style={{ width: '20px', height: '20px', color: '#999', cursor: 'pointer' }}></i>
                                </div>
                            </div>

                            {/* 中间：会话列表 */}
                            <div style={{
                                width: '280px',
                                backgroundColor: '#f7f7f7',
                                borderRight: '1px solid #e0e0e0',
                                display: 'flex',
                                flexDirection: 'column'
                            }}>
                                {/* 搜索栏 */}
                                <div style={{
                                    padding: '12px',
                                    borderBottom: '1px solid #e0e0e0',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}>
                                    <div style={{
                                        flex: 1,
                                        display: 'flex',
                                        alignItems: 'center',
                                        backgroundColor: '#fff',
                                        borderRadius: '4px',
                                        padding: '6px 10px',
                                        gap: '6px'
                                    }}>
                                        <i data-lucide="search" style={{ width: '14px', height: '14px', color: '#999' }}></i>
                                        <input
                                            type="text"
                                            placeholder="搜索"
                                            style={{
                                                border: 'none',
                                                outline: 'none',
                                                flex: 1,
                                                fontSize: '14px',
                                                backgroundColor: 'transparent'
                                            }}
                                        />
                                    </div>
                                    <div style={{
                                        width: '24px',
                                        height: '24px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px'
                                    }}>
                                        <i data-lucide="plus" style={{ width: '18px', height: '18px', color: '#666' }}></i>
                                    </div>
                                </div>

                                {/* 会话列表 */}
                                <div style={{
                                    flex: 1,
                                    overflowY: 'auto'
                                }}>
                                    {/* 微信客户 */}
                                    {wechatContacts.map((contact) => (
                                        <div
                                            key={contact.id}
                                            onClick={() => setSelectedContact(contact)}
                                            style={{
                                                padding: '12px',
                                                backgroundColor: selectedContact?.id === contact.id ? '#e8f4ff' : 'transparent',
                                                borderLeft: selectedContact?.id === contact.id ? '3px solid #4a90e2' : 'none',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '12px',
                                                cursor: 'pointer',
                                                borderBottom: '1px solid #f0f0f0'
                                            }}
                                            onMouseEnter={(e) => {
                                                if (selectedContact?.id !== contact.id) {
                                                    e.currentTarget.style.backgroundColor = '#f0f0f0';
                                                }
                                            }}
                                            onMouseLeave={(e) => {
                                                if (selectedContact?.id !== contact.id) {
                                                    e.currentTarget.style.backgroundColor = 'transparent';
                                                }
                                            }}
                                        >
                                            <img
                                                src={contact.avatar}
                                                alt={contact.name}
                                                style={{
                                                    width: '44px',
                                                    height: '44px',
                                                    borderRadius: '4px',
                                                    objectFit: 'cover',
                                                    flexShrink: 0
                                                }}
                                                onError={(e) => {
                                                    e.target.style.display = 'none';
                                                    const fallback = document.createElement('div');
                                                    fallback.style.cssText = `width: 44px; height: 44px; border-radius: 4px; background: #4a90e2; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 18px; font-weight: bold;`;
                                                    fallback.textContent = contact.name.charAt(0);
                                                    e.target.parentNode.insertBefore(fallback, e.target);
                                                }}
                                            />
                                            <div style={{ flex: 1, minWidth: 0 }}>
                                                <div style={{
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'space-between',
                                                    marginBottom: '4px',
                                                    gap: '8px'
                                                }}>
                                                    <span style={{ 
                                                        fontSize: '14px', 
                                                        fontWeight: 500, 
                                                        color: '#262626',
                                                        flex: 1,
                                                        minWidth: 0,
                                                        overflow: 'hidden',
                                                        textOverflow: 'ellipsis',
                                                        whiteSpace: 'nowrap'
                                                    }}>
                                                        {contact.nickname} <span style={{ 
                                                            color: contact.contactType === 'enterprise' ? '#ff9800' : '#52c41a', 
                                                            fontWeight: 400 
                                                        }}>
                                                            {contact.contactType === 'enterprise' ? '@百度地图开放平台' : '@微信'}
                                                        </span>
                                                    </span>
                                                    <span style={{ 
                                                        fontSize: '12px', 
                                                        color: '#8c8c8c',
                                                        flexShrink: 0,
                                                        whiteSpace: 'nowrap'
                                                    }}>{contact.lastTime}</span>
                                                </div>
                                                <div style={{ fontSize: '12px', color: '#8c8c8c', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
                                                    {contact.lastMessage}
                                                </div>
                                            </div>
                                        </div>
                                    ))}

                                    {/* 其他会话 */}
                                    {[
                                        { name: '文件传输助手', icon: '📤', preview: '你在电脑登录...', time: '20分钟前', color: '#52c41a' },
                                        { name: '企业微信团队', icon: '💬', preview: '企业微信管理后...', time: '18分钟前', color: '#1890ff' },
                                        { name: '高级功能', icon: '⭐', preview: '你已经成为超级管理...', time: '昨天', color: '#ff9800' }
                                    ].map((item, index) => (
                                        <div
                                            key={index}
                                            style={{
                                                padding: '12px',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '12px',
                                                cursor: 'pointer',
                                                borderBottom: '1px solid #f0f0f0'
                                            }}
                                            onMouseEnter={(e) => {
                                                e.currentTarget.style.backgroundColor = '#f0f0f0';
                                            }}
                                            onMouseLeave={(e) => {
                                                e.currentTarget.style.backgroundColor = 'transparent';
                                            }}
                                        >
                                            <div style={{
                                                width: '44px',
                                                height: '44px',
                                                borderRadius: '4px',
                                                backgroundColor: item.color,
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                fontSize: '20px',
                                                flexShrink: 0
                                            }}>
                                                {item.icon}
                                            </div>
                                            <div style={{ flex: 1, minWidth: 0 }}>
                                                <div style={{
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'space-between',
                                                    marginBottom: '4px'
                                                }}>
                                                    <span style={{ fontSize: '14px', fontWeight: 500, color: '#262626' }}>
                                                        {item.name}
                                                    </span>
                                                    <span style={{ fontSize: '12px', color: '#8c8c8c' }}>{item.time}</span>
                                                </div>
                                                <div style={{ fontSize: '12px', color: '#8c8c8c', overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>
                                                    {item.preview}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* 右侧：聊天窗口和联系人详情 */}
                            <div style={{
                                flex: 1,
                                display: 'flex',
                                flexDirection: 'column',
                                backgroundColor: '#fff'
                            }}>
                                {/* 聊天窗口顶部栏 */}
                                <div style={{
                                    height: '50px',
                                    borderBottom: '1px solid #e0e0e0',
                                    display: 'flex',
                                    alignItems: 'center',
                                    padding: '0 16px',
                                    justifyContent: 'space-between'
                                }}>
                                    <span style={{ fontSize: '16px', fontWeight: 500, color: '#262626' }}>
                                        {selectedContact ? (
                                            <>
                                                {selectedContact.nickname} <span style={{ 
                                                    color: selectedContact.contactType === 'enterprise' ? '#ff9800' : '#52c41a', 
                                                    fontWeight: 400 
                                                }}>
                                                    {selectedContact.contactType === 'enterprise' ? '@百度地图开放平台' : '@微信'}
                                                </span>
                                            </>
                                        ) : '请选择联系人'}
                                    </span>
                                    <div style={{ display: 'flex', gap: '12px' }}>
                                        <i data-lucide="phone" style={{ width: '18px', height: '18px', color: '#666', cursor: 'pointer' }}></i>
                                        <i data-lucide="video" style={{ width: '18px', height: '18px', color: '#666', cursor: 'pointer' }}></i>
                                        <i data-lucide="more-horizontal" style={{ width: '18px', height: '18px', color: '#666', cursor: 'pointer' }}></i>
                                    </div>
                                </div>

                                {/* 聊天内容区域 */}
                                {(() => {
                                    const chatContentRef = React.useRef(null);
                                    
                                    // 滚动到底部（默认显示最新消息）
                                    React.useEffect(() => {
                                        if (chatContentRef.current && selectedContact) {
                                            chatContentRef.current.scrollTop = chatContentRef.current.scrollHeight;
                                        }
                                    }, [selectedContact]);
                                    
                                    return (
                                        <div 
                                            ref={chatContentRef}
                                            style={{
                                                flex: 1,
                                                overflowY: 'auto',
                                                padding: '20px',
                                                backgroundColor: '#ededed',
                                                display: 'flex',
                                                flexDirection: 'column',
                                                gap: '16px'
                                            }}
                                        >
                                    {selectedContact ? (
                                        selectedContact.messages.map((msg, index) => {
                                            if (msg.type === 'system') {
                                                return (
                                                    <div key={index} style={{
                                                        textAlign: 'center',
                                                        fontSize: '12px',
                                                        color: '#8c8c8c',
                                                        marginBottom: '8px'
                                                    }}>
                                                        {msg.content}
                                                    </div>
                                                );
                                            } else if (msg.type === 'received') {
                                                return (
                                                    <div key={index} style={{
                                                        display: 'flex',
                                                        gap: '8px',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <img
                                                            src={selectedContact.avatar}
                                                            alt={selectedContact.name}
                                                            style={{
                                                                width: '36px',
                                                                height: '36px',
                                                                borderRadius: '4px',
                                                                objectFit: 'cover',
                                                                flexShrink: 0
                                                            }}
                                                            onError={(e) => {
                                                                e.target.style.display = 'none';
                                                                const fallback = document.createElement('div');
                                                                fallback.style.cssText = `width: 36px; height: 36px; border-radius: 4px; background: #4a90e2; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 16px; font-weight: bold;`;
                                                                fallback.textContent = selectedContact.name.charAt(0);
                                                                e.target.parentNode.insertBefore(fallback, e.target);
                                                            }}
                                                        />
                                                        <div style={{
                                                            maxWidth: '60%',
                                                            backgroundColor: '#fff',
                                                            padding: '10px 14px',
                                                            borderRadius: '4px',
                                                            fontSize: '14px',
                                                            color: '#262626',
                                                            lineHeight: '1.5'
                                                        }}>
                                                            {msg.content}
                                                        </div>
                                                    </div>
                                                );
                                            } else if (msg.type === 'sent') {
                                                return (
                                                    <div key={index} style={{
                                                        display: 'flex',
                                                        gap: '8px',
                                                        alignItems: 'flex-start',
                                                        flexDirection: 'row-reverse'
                                                    }}>
                                                        <div style={{
                                                            width: '36px',
                                                            height: '36px',
                                                            borderRadius: '4px',
                                                            backgroundColor: '#07c160',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            color: '#fff',
                                                            fontSize: '16px',
                                                            fontWeight: 'bold',
                                                            flexShrink: 0
                                                        }}>
                                                            我
                                                        </div>
                                                        <div style={{
                                                            maxWidth: '60%',
                                                            backgroundColor: '#95ec69',
                                                            padding: '10px 14px',
                                                            borderRadius: '4px',
                                                            fontSize: '14px',
                                                            color: '#262626',
                                                            lineHeight: '1.5'
                                                        }}>
                                                            {msg.content}
                                                        </div>
                                                    </div>
                                                );
                                            }
                                            return null;
                                        })
                                    ) : (
                                        <div style={{
                                            textAlign: 'center',
                                            color: '#8c8c8c',
                                            padding: '40px',
                                            fontSize: '14px'
                                        }}>
                                            请从左侧选择联系人开始聊天
                                        </div>
                                    )}

                                    {/* 企业名片 */}
                                    {selectedContact && (
                                    <div style={{
                                        display: 'flex',
                                        gap: '8px',
                                        alignItems: 'flex-start'
                                    }}>
                                        <div style={{
                                            width: '36px',
                                            height: '36px',
                                            borderRadius: '4px',
                                            backgroundColor: '#4a90e2',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            color: '#fff',
                                            fontSize: '16px',
                                            fontWeight: 'bold',
                                            flexShrink: 0
                                        }}>
                                            W
                                        </div>
                                        <div style={{
                                            maxWidth: '60%',
                                            backgroundColor: '#fff',
                                            padding: '12px',
                                            borderRadius: '4px',
                                            border: '1px solid #e0e0e0'
                                        }}>
                                            <div style={{
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '10px',
                                                marginBottom: '8px'
                                            }}>
                                                <div style={{
                                                    width: '40px',
                                                    height: '40px',
                                                    borderRadius: '4px',
                                                    backgroundColor: '#1890ff',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    color: '#fff',
                                                    fontSize: '18px',
                                                    fontWeight: 'bold'
                                                }}>
                                                    百
                                                </div>
                                                <div>
                                                    <div style={{
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        gap: '4px',
                                                        marginBottom: '2px'
                                                    }}>
                                                        <span style={{ fontSize: '14px', fontWeight: 500, color: '#262626' }}>
                                                            百度地图开放平台商务
                                                        </span>
                                                        <span style={{
                                                            fontSize: '10px',
                                                            color: '#52c41a',
                                                            backgroundColor: '#f6ffed',
                                                            padding: '1px 4px',
                                                            borderRadius: '2px',
                                                            border: '1px solid #b7eb8f'
                                                        }}>
                                                            企业名片
                                                        </span>
                                                    </div>
                                                    <div style={{ fontSize: '12px', color: '#8c8c8c' }}>
                                                        北京百度智图科技有限公司
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    )}

                                    {/* 链接消息 */}
                                    {selectedContact && (
                                    <div style={{
                                        display: 'flex',
                                        gap: '8px',
                                        alignItems: 'flex-start'
                                    }}>
                                        <div style={{
                                            width: '36px',
                                            height: '36px',
                                            borderRadius: '4px',
                                            backgroundColor: '#4a90e2',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            color: '#fff',
                                            fontSize: '16px',
                                            fontWeight: 'bold',
                                            flexShrink: 0
                                        }}>
                                            W
                                        </div>
                                        <div style={{
                                            maxWidth: '60%',
                                            backgroundColor: '#fff',
                                            borderRadius: '4px',
                                            border: '1px solid #e0e0e0',
                                            overflow: 'hidden'
                                        }}>
                                            <div style={{
                                                width: '280px',
                                                height: '150px',
                                                backgroundColor: '#1890ff',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                color: '#fff',
                                                fontSize: '14px'
                                            }}>
                                                链接预览图
                                            </div>
                                            <div style={{ padding: '12px' }}>
                                                <div style={{ fontSize: '14px', fontWeight: 500, color: '#262626', marginBottom: '4px' }}>
                                                    百度地图开放平台满意度调研(企微)
                                                </div>
                                                <div style={{ fontSize: '12px', color: '#8c8c8c' }}>
                                                    iwenjuan.baidu.com
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    )}
                                        </div>
                                    );
                                })()}

                                {/* 工具栏 */}
                                <div style={{
                                    height: '48px',
                                    borderTop: '1px solid #e0e0e0',
                                    display: 'flex',
                                    alignItems: 'center',
                                    padding: '0 16px',
                                    gap: '4px',
                                    backgroundColor: '#fff'
                                }}>
                                    {/* 表情按钮 */}
                                    <div style={{
                                        width: '32px',
                                        height: '32px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="smile" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                    </div>

                                    {/* 剪切按钮 */}
                                    <div style={{
                                        width: '32px',
                                        height: '32px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="scissors" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                    </div>

                                    {/* 图片按钮（带下拉） */}
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative',
                                        padding: '4px 2px'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="image" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                        <i data-lucide="chevron-down" style={{ width: '12px', height: '12px', color: '#999', marginLeft: '2px' }}></i>
                                    </div>

                                    {/* 文档/笔记按钮 */}
                                    <div style={{
                                        width: '32px',
                                        height: '32px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="file-text" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                    </div>

                                    {/* 日历/日程按钮（带下拉） */}
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative',
                                        padding: '4px 2px'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="calendar-check" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                        <i data-lucide="chevron-down" style={{ width: '12px', height: '12px', color: '#999', marginLeft: '2px' }}></i>
                                    </div>

                                    {/* 文件夹/文件按钮（带下拉） */}
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative',
                                        padding: '4px 2px'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="folder" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                        <i data-lucide="chevron-down" style={{ width: '12px', height: '12px', color: '#999', marginLeft: '2px' }}></i>
                                    </div>

                                    {/* 电话按钮（带下拉） */}
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative',
                                        padding: '4px 2px'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="phone" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                        <i data-lucide="chevron-down" style={{ width: '12px', height: '12px', color: '#999', marginLeft: '2px' }}></i>
                                    </div>

                                    {/* 语音/提醒按钮 */}
                                    <div style={{
                                        width: '32px',
                                        height: '32px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="message-square" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                    </div>

                                    {/* 快速会议按钮 */}
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '4px',
                                        padding: '6px 12px',
                                        backgroundColor: 'transparent',
                                        borderRadius: '4px',
                                        cursor: 'pointer',
                                        color: '#666',
                                        fontSize: '14px'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="zap" style={{ width: '16px', height: '16px', color: '#666' }}></i>
                                        <span>快速会议</span>
                                    </div>

                                    {/* 企业微信侧边栏按钮 */}
                                    <div style={{
                                        width: '32px',
                                        height: '32px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        cursor: 'pointer',
                                        borderRadius: '4px',
                                        position: 'relative',
                                        marginLeft: 'auto'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.backgroundColor = '#f5f5f5';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.backgroundColor = 'transparent';
                                    }}
                                    >
                                        <i data-lucide="panel-right" style={{ width: '20px', height: '20px', color: '#666' }}></i>
                                    </div>
                                </div>

                                {/* 输入栏 */}
                                <div style={{
                                    height: '100px',
                                    borderTop: '1px solid #e0e0e0',
                                    display: 'flex',
                                    alignItems: 'flex-start',
                                    padding: '8px 16px',
                                    backgroundColor: '#fff'
                                }}>
                                    {/* 输入框 */}
                                    <textarea
                                        placeholder="输入消息..."
                                        style={{
                                            flex: 1,
                                            border: 'none',
                                            outline: 'none',
                                            fontSize: '14px',
                                            padding: '8px 12px',
                                            minWidth: 0,
                                            height: '84px',
                                            resize: 'none',
                                            fontFamily: 'inherit',
                                            lineHeight: '1.5'
                                        }}
                                    />
                                </div>
                            </div>

                            {/* 右侧：联系人详情面板 */}
                            <div 
                                ref={sidebarContainerRef}
                                style={{
                                    width: '300px',
                                    backgroundColor: '#fafafa',
                                    borderLeft: '1px solid #e0e0e0',
                                    display: 'flex',
                                    flexDirection: 'column',
                                    position: 'relative'
                                }}
                            >
                                {/* Tab页签 - 始终显示 */}
                                <div style={{
                                    display: 'flex',
                                    borderBottom: '1px solid #e0e0e0',
                                    backgroundColor: '#fff',
                                    flexWrap: 'nowrap',
                                    overflow: 'hidden',
                                    flexShrink: 0
                                }}>
                                    {['企业名片', '快捷回复', '客户详情', '智能客服'].map((tab, index) => (
                                        <div
                                            key={index}
                                            style={{
                                                padding: '10px 6px',
                                                textAlign: 'center',
                                                fontSize: '12px',
                                                color: index === 2 ? '#1890ff' : '#666',
                                                borderBottom: index === 2 ? '2px solid #1890ff' : '2px solid transparent',
                                                cursor: 'pointer',
                                                whiteSpace: 'nowrap',
                                                flexShrink: 0,
                                                minWidth: 'fit-content'
                                            }}
                                        >
                                            {tab}
                                        </div>
                                    ))}
                                    <div style={{
                                        padding: '10px 6px',
                                        cursor: 'pointer',
                                        flexShrink: 0,
                                        marginLeft: 'auto'
                                    }}>
                                        <i data-lucide="chevron-down" style={{ width: '14px', height: '14px', color: '#666' }}></i>
                                    </div>
                                </div>

                                {/* 内容区域 - 根据状态切换 */}
                                <div 
                                    ref={sidebarScrollRef}
                                    style={{
                                        flex: 1,
                                        overflowY: 'auto',
                                        padding: (showLeadSelection || showRebindSelection) ? '0' : '5px',
                                        display: 'flex',
                                        flexDirection: 'column',
                                        position: 'relative'
                                    }}
                                >
                                    {!(showLeadSelection || showRebindSelection) ? (
                                    <div>
                                    {/* 上半部分：客户信息卡片 */}
                                    {selectedContact ? (
                                        <div>
                                        <div style={{
                                            backgroundColor: '#fff',
                                            borderRadius: '8px',
                                            padding: '10px',
                                            marginBottom: '12px',
                                            boxShadow: '0 2px 8px rgba(0,0,0,0.06)'
                                        }}>
                                            {/* 顶部：头像、昵称、备注区域 */}
                                            <div style={{
                                                display: 'flex',
                                                gap: '12px',
                                                marginBottom: '12px'
                                            }}>
                                                {/* 头像 */}
                                                <div style={{
                                                    width: '64px',
                                                    height: '64px',
                                                    borderRadius: '8px',
                                                    overflow: 'hidden',
                                                    flexShrink: 0,
                                                    border: '1px solid #f0f0f0'
                                                }}>
                                                    <img
                                                        src={selectedContact.avatar}
                                                        alt="头像"
                                                        style={{
                                                            width: '100%',
                                                            height: '100%',
                                                            objectFit: 'cover'
                                                        }}
                                                        onError={(e) => {
                                                            e.target.src = 'https://api.dicebear.com/7.x/avataaars/svg?seed=zhangwei&backgroundColor=b6e3f4&hair=shortHairShortCurly&hairColor=000000&skinColor=fdbcb4&clothing=shirtVNeck&clothingColor=262e33';
                                                        }}
                                                    />
                                                </div>

                                                {/* 昵称、备注区域 */}
                                                <div style={{ flex: 1, minWidth: 0 }}>
                                                    {/* 昵称和@微信 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        gap: '6px',
                                                        marginBottom: '4px',
                                                        minWidth: 0
                                                    }}>
                                                        <span style={{
                                                            fontSize: '18px',
                                                            fontWeight: 600,
                                                            color: '#262626',
                                                            lineHeight: '1.4',
                                                            flex: 1,
                                                            minWidth: 0,
                                                            overflow: 'hidden',
                                                            textOverflow: 'ellipsis',
                                                            whiteSpace: 'nowrap'
                                                        }}>
                                                            {selectedContact.nickname} <span style={{
                                                                fontSize: '14px',
                                                                color: selectedContact.contactType === 'enterprise' ? '#ff9800' : '#52c41a',
                                                                fontWeight: 400
                                                            }}>
                                                                {selectedContact.contactType === 'enterprise' ? '@百度地图开放平台' : '@微信'}
                                                            </span>
                                                        </span>
                                                        <span style={{
                                                            fontSize: '16px',
                                                            color: '#1890ff',
                                                            lineHeight: '1',
                                                            flexShrink: 0
                                                        }}>
                                                            {selectedContact.gender}
                                                        </span>
                                                    </div>

                                                    {/* 备注 */}
                                                    <div style={{
                                                        fontSize: '13px',
                                                        color: '#595959',
                                                        lineHeight: '1.5'
                                                    }}>
                                                        {selectedContact.remark}
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 标签 - 独占一行，与头像左侧对齐 */}
                                            <div style={{
                                                display: 'flex',
                                                flexWrap: 'wrap',
                                                gap: '6px',
                                                marginLeft: '0',
                                                marginBottom: '12px'
                                            }}>
                                                {selectedContact.tags.map((tag, index) => (
                                                    <span key={index} style={{
                                                        fontSize: '12px',
                                                        color: '#1890ff',
                                                        backgroundColor: '#e6f7ff',
                                                        padding: '3px 8px',
                                                        borderRadius: '4px',
                                                        border: '1px solid #91d5ff'
                                                    }}>
                                                        {tag}
                                                    </span>
                                                ))}
                                            </div>

                                            {/* 信息列表 */}
                                            <div style={{
                                                display: 'flex',
                                                flexDirection: 'column',
                                                gap: '12px',
                                                paddingTop: '12px',
                                                borderTop: '1px solid #f0f0f0'
                                            }}>
                                                {/* 备注的手机号码 */}
                                                <div style={{
                                                    display: 'flex',
                                                    alignItems: 'flex-start',
                                                    gap: '10px'
                                                }}>
                                                    <div style={{
                                                        width: '36px',
                                                        height: '36px',
                                                        borderRadius: '6px',
                                                        backgroundColor: '#f0f7ff',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        flexShrink: 0
                                                    }}>
                                                        <i data-lucide="phone" style={{ width: '18px', height: '18px', color: '#1890ff' }}></i>
                                                    </div>
                                                    <div style={{ flex: 1 }}>
                                                        <div style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginBottom: '2px'
                                                        }}>
                                                            备注的手机号码
                                                        </div>
                                                        <div style={{
                                                            fontSize: '15px',
                                                            color: '#262626',
                                                            fontWeight: 500,
                                                            lineHeight: '1.4'
                                                        }}>
                                                            {selectedContact.phone}
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* 添加时间 */}
                                                <div style={{
                                                    display: 'flex',
                                                    alignItems: 'flex-start',
                                                    gap: '10px'
                                                }}>
                                                    <div style={{
                                                        width: '36px',
                                                        height: '36px',
                                                        borderRadius: '6px',
                                                        backgroundColor: '#f6ffed',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        flexShrink: 0
                                                    }}>
                                                        <i data-lucide="clock" style={{ width: '18px', height: '18px', color: '#52c41a' }}></i>
                                                    </div>
                                                    <div style={{ flex: 1 }}>
                                                        <div style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginBottom: '2px'
                                                        }}>
                                                            添加时间
                                                        </div>
                                                        <div style={{
                                                            fontSize: '15px',
                                                            color: '#262626',
                                                            fontWeight: 500,
                                                            lineHeight: '1.4'
                                                        }}>
                                                            {selectedContact.addTime}
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* 来源 */}
                                                <div style={{
                                                    display: 'flex',
                                                    alignItems: 'flex-start',
                                                    gap: '10px'
                                                }}>
                                                    <div style={{
                                                        width: '36px',
                                                        height: '36px',
                                                        borderRadius: '6px',
                                                        backgroundColor: '#fff7e6',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        flexShrink: 0
                                                    }}>
                                                        <i data-lucide="user-plus" style={{ width: '18px', height: '18px', color: '#faad14' }}></i>
                                                    </div>
                                                    <div style={{ flex: 1 }}>
                                                        <div style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginBottom: '2px'
                                                        }}>
                                                            来源
                                                        </div>
                                                        <div style={{
                                                            fontSize: '15px',
                                                            color: '#262626',
                                                            fontWeight: 500,
                                                            lineHeight: '1.4'
                                                        }}>
                                                            {selectedContact.source}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* 通知销售跟进按钮 */}
                                            <div style={{ marginTop: '12px', paddingTop: '12px', borderTop: '1px solid #f0f0f0' }}>
                                                <Button type="primary" block onClick={handleNotifySales}>
                                                    通知销售跟进
                                                </Button>
                                            </div>

                                        </div>

                                        {/* 线索详情和线索动态合并卡片 - 仅liming显示 */}
                                        {selectedContact && selectedContact.id === 2 && (
                                            <div style={{
                                                backgroundColor: '#fff',
                                                borderRadius: '8px',
                                                padding: '12px',
                                                marginBottom: '12px',
                                                boxShadow: '0 2px 8px rgba(0,0,0,0.06)',
                                                position: 'relative'
                                            }}>
                                                {/* Tab页签 */}
                                                <div style={{
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center',
                                                    gap: '0',
                                                    marginBottom: '12px',
                                                    borderBottom: '1px solid #f0f0f0',
                                                    position: 'relative'
                                                }}>
                                                    <div style={{ display: 'flex', gap: '0' }}>
                                                        <div
                                                            onClick={() => setLeadDetailTab('detail')}
                                                            style={{
                                                                padding: '8px 16px',
                                                                cursor: 'pointer',
                                                                borderBottom: leadDetailTab === 'detail' ? '2px solid #1890ff' : '2px solid transparent',
                                                                color: leadDetailTab === 'detail' ? '#1890ff' : '#666',
                                                                fontSize: '14px',
                                                                fontWeight: leadDetailTab === 'detail' ? 500 : 400,
                                                                transition: 'all 0.2s',
                                                                whiteSpace: 'nowrap'
                                                            }}
                                                        >
                                                            线索详情
                                                        </div>
                                                        <div
                                                            onClick={() => setLeadDetailTab('timeline')}
                                                            style={{
                                                                padding: '8px 16px',
                                                                cursor: 'pointer',
                                                                borderBottom: leadDetailTab === 'timeline' ? '2px solid #1890ff' : '2px solid transparent',
                                                                color: leadDetailTab === 'timeline' ? '#1890ff' : '#666',
                                                                fontSize: '14px',
                                                                fontWeight: leadDetailTab === 'timeline' ? 500 : 400,
                                                                transition: 'all 0.2s',
                                                                whiteSpace: 'nowrap'
                                                            }}
                                                        >
                                                            线索动态
                                                        </div>
                                                    </div>
                                                    {leadDetailTab === 'detail' && (
                                                        <button
                                                            onClick={() => {
                                                                setOriginalLeadDescription(leadDescription);
                                                                setIsEditingLeadDetail(true);
                                                            }}
                                                            style={{
                                                                display: 'flex',
                                                                alignItems: 'center',
                                                                justifyContent: 'center',
                                                                width: '32px',
                                                                height: '32px',
                                                                padding: 0,
                                                                border: 'none',
                                                                background: 'transparent',
                                                                cursor: 'pointer',
                                                                borderRadius: '4px',
                                                                transition: 'all 0.2s',
                                                                flexShrink: 0
                                                            }}
                                                            onMouseEnter={(e) => {
                                                                e.currentTarget.style.backgroundColor = '#f5f5f5';
                                                            }}
                                                            onMouseLeave={(e) => {
                                                                e.currentTarget.style.backgroundColor = 'transparent';
                                                            }}
                                                        >
                                                            <i data-lucide="pencil" style={{ width: '16px', height: '16px', color: '#1890ff' }}></i>
                                                        </button>
                                                    )}
                                                </div>

                                                {/* Tab内容区域 */}
                                                {leadDetailTab === 'detail' ? (
                                                    /* 线索详情内容 */
                                                    <div style={{ position: 'relative' }}>
                                                        {/* 字段列表 */}
                                                        <div style={{
                                                            display: 'flex',
                                                            flexDirection: 'column',
                                                            gap: '10px'
                                                        }}>
                                                    {/* 线索ID */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>线索ID</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>LX20260119001</span>
                                                    </div>

                                                    {/* UID */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>UID</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>123456789</span>
                                                    </div>

                                                    {/* 认证名称 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>认证名称</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>北京百度网讯科技有限公司</span>
                                                    </div>

                                                    {/* 认证类型 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>认证类型</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>企业认证</span>
                                                    </div>

                                                    {/* 认证地址 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>认证地址</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>北京市-北京市</span>
                                                    </div>

                                                    {/* 行业类别 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>行业类别</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>互联网/IT服务</span>
                                                    </div>

                                                    {/* 业务场景 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>业务场景</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>地图导航、位置服务</span>
                                                    </div>

                                                    {/* 线索状态 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>线索状态</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#52c41a',
                                                            textAlign: 'right',
                                                            flex: 1,
                                                            fontWeight: 500
                                                        }}>40% 客户内部评估</span>
                                                    </div>

                                                    {/* 线索来源 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>线索来源</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>企业认证</span>
                                                    </div>

                                                    {/* 创建时间 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>创建时间</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            textAlign: 'right',
                                                            flex: 1
                                                        }}>2026-01-19 14:30</span>
                                                    </div>

                                                    {/* 线索描述 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        alignItems: 'flex-start',
                                                        position: 'relative'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            flexShrink: 0,
                                                            width: '80px'
                                                        }}>线索描述</span>
                                                        <div style={{ flex: 1, position: 'relative' }}>
                                                            {isEditingLeadDetail && (
                                                                <div style={{
                                                                    position: 'absolute',
                                                                    top: '-40px',
                                                                    right: '0',
                                                                    display: 'flex',
                                                                    gap: '8px',
                                                                    zIndex: 10
                                                                }}>
                                                                    <button
                                                                        onClick={() => {
                                                                            // 保存逻辑
                                                                            setIsEditingLeadDetail(false);
                                                                            // 显示保存成功吐司
                                                                            if (sidebarContainerRef.current) {
                                                                                const toast = document.createElement('div');
                                                                                toast.textContent = '保存成功';
                                                                                toast.style.cssText = 'position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: #52c41a; padding: 12px 24px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000; font-size: 14px; color: #fff; pointer-events: none;';
                                                                                sidebarContainerRef.current.appendChild(toast);
                                                                                setTimeout(() => {
                                                                                    if (sidebarContainerRef.current && sidebarContainerRef.current.contains(toast)) {
                                                                                        sidebarContainerRef.current.removeChild(toast);
                                                                                    }
                                                                                }, 2000);
                                                                            }
                                                                            // 这里可以添加保存到后端的逻辑
                                                                        }}
                                                                        style={{
                                                                            height: '32px',
                                                                            padding: '0 16px',
                                                                            backgroundColor: '#1890ff',
                                                                            color: '#fff',
                                                                            border: 'none',
                                                                            borderRadius: '4px',
                                                                            fontSize: '13px',
                                                                            fontWeight: 500,
                                                                            cursor: 'pointer',
                                                                            transition: 'all 0.2s',
                                                                            boxShadow: '0 2px 4px rgba(0,0,0,0.1)'
                                                                        }}
                                                                        onMouseEnter={(e) => {
                                                                            e.currentTarget.style.backgroundColor = '#40a9ff';
                                                                        }}
                                                                        onMouseLeave={(e) => {
                                                                            e.currentTarget.style.backgroundColor = '#1890ff';
                                                                        }}
                                                                    >
                                                                        保存
                                                                    </button>
                                                                    <button
                                                                        onClick={() => {
                                                                            // 取消编辑，恢复原值
                                                                            setLeadDescription(originalLeadDescription);
                                                                            setIsEditingLeadDetail(false);
                                                                        }}
                                                                        style={{
                                                                            height: '32px',
                                                                            padding: '0 16px',
                                                                            backgroundColor: '#fff',
                                                                            color: '#666',
                                                                            border: '1px solid #d9d9d9',
                                                                            borderRadius: '4px',
                                                                            fontSize: '13px',
                                                                            fontWeight: 500,
                                                                            cursor: 'pointer',
                                                                            transition: 'all 0.2s'
                                                                        }}
                                                                        onMouseEnter={(e) => {
                                                                            e.currentTarget.style.backgroundColor = '#f5f5f5';
                                                                        }}
                                                                        onMouseLeave={(e) => {
                                                                            e.currentTarget.style.backgroundColor = '#fff';
                                                                        }}
                                                                    >
                                                                        取消
                                                                    </button>
                                                                </div>
                                                            )}
                                                            {isEditingLeadDetail ? (
                                                                <Input.TextArea
                                                                    value={leadDescription}
                                                                    onChange={(e) => setLeadDescription(e.target.value)}
                                                                    placeholder="请输入线索描述"
                                                                    autoSize={{ minRows: 3, maxRows: 6 }}
                                                                    style={{
                                                                        flex: 1,
                                                                        fontSize: '13px',
                                                                        lineHeight: '1.6'
                                                                    }}
                                                                />
                                                            ) : (
                                                                <div style={{
                                                                    fontSize: '13px',
                                                                    color: '#262626',
                                                                    textAlign: 'left',
                                                                    flex: 1,
                                                                    lineHeight: '1.6',
                                                                    whiteSpace: 'pre-wrap',
                                                                    wordBreak: 'break-word'
                                                                }}>
                                                                    {leadDescription}
                                                                </div>
                                                            )}
                                                        </div>
                                                    </div>
                                                    </div>
                                                    </div>
                                                ) : (
                                                    /* 线索动态内容 */
                                                    <div>
                                                        {/* 筛选标签 */}
                                                        <div style={{
                                                            display: 'flex',
                                                            gap: '8px',
                                                            marginBottom: '12px',
                                                            flexWrap: 'wrap'
                                                        }}>
                                                    {['全部', '跟进记录', '咨询记录', '系统变更'].map((filter) => (
                                                        <div
                                                            key={filter}
                                                            onClick={() => setTimelineFilter(filter)}
                                                            style={{
                                                                padding: '4px 12px',
                                                                fontSize: '12px',
                                                                borderRadius: '4px',
                                                                cursor: 'pointer',
                                                                transition: 'all 0.2s',
                                                                backgroundColor: timelineFilter === filter ? '#1890ff' : '#f5f5f5',
                                                                color: timelineFilter === filter ? '#fff' : '#666',
                                                                border: timelineFilter === filter ? '1px solid #1890ff' : '1px solid #e0e0e0'
                                                            }}
                                                            onMouseEnter={(e) => {
                                                                if (timelineFilter !== filter) {
                                                                    e.currentTarget.style.backgroundColor = '#e6f7ff';
                                                                    e.currentTarget.style.borderColor = '#91d5ff';
                                                                }
                                                            }}
                                                            onMouseLeave={(e) => {
                                                                if (timelineFilter !== filter) {
                                                                    e.currentTarget.style.backgroundColor = '#f5f5f5';
                                                                    e.currentTarget.style.borderColor = '#e0e0e0';
                                                                }
                                                            }}
                                                        >
                                                            {filter}
                                                        </div>
                                                    ))}
                                                        </div>

                                                        {/* 时间轴记录列表 */}
                                                        <div style={{
                                                            display: 'flex',
                                                            flexDirection: 'column',
                                                            gap: '16px'
                                                        }}>
                                                            {filteredRecords.map((record, index) => (
                                                                <div key={record.id} style={{
                                                                    position: 'relative',
                                                                    paddingLeft: '24px'
                                                                }}>
                                                            {/* 时间轴线条 */}
                                                            {index < filteredRecords.length - 1 && (
                                                                <div style={{
                                                                    position: 'absolute',
                                                                    left: '7px',
                                                                    top: '20px',
                                                                    width: '2px',
                                                                    height: 'calc(100% + 16px)',
                                                                    backgroundColor: '#e0e0e0'
                                                                }}></div>
                                                            )}

                                                            {/* 时间轴节点 */}
                                                            <div style={{
                                                                position: 'absolute',
                                                                left: '0',
                                                                top: '4px',
                                                                width: '16px',
                                                                height: '16px',
                                                                borderRadius: '50%',
                                                                backgroundColor: '#1890ff',
                                                                border: '2px solid #fff',
                                                                boxShadow: '0 0 0 2px #1890ff',
                                                                zIndex: 1
                                                            }}></div>

                                                            {/* 时间 */}
                                                            <div style={{
                                                                fontSize: '12px',
                                                                color: record.id === 0 ? '#ff4d4f' : '#8c8c8c',
                                                                marginBottom: '4px',
                                                                fontWeight: record.id === 0 ? 500 : 400
                                                            }}>
                                                                {record.time}
                                                            </div>

                                                            {/* 状态 */}
                                                            <div style={{
                                                                fontSize: '13px',
                                                                color: '#262626',
                                                                fontWeight: 500,
                                                                marginBottom: '6px'
                                                            }}>
                                                                {record.status}
                                                            </div>

                                                            {/* 操作人 */}
                                                            <div style={{
                                                                fontSize: '12px',
                                                                color: '#8c8c8c',
                                                                marginBottom: '6px'
                                                            }}>
                                                                操作人: {record.operator}
                                                            </div>

                                                            {/* 操作链接 */}
                                                            <div style={{
                                                                fontSize: '12px',
                                                                color: '#1890ff',
                                                                marginBottom: '6px',
                                                                cursor: 'pointer'
                                                            }} onClick={() => {
                                                                // 如果是外呼记录且有详情视图，则打开外呼记录详情抽屉
                                                                if (record.hasDetailView && record.outboundCallDetail) {
                                                                    setSelectedOutboundCall(record.outboundCallDetail);
                                                                    setOutboundCallDetailVisible(true);
                                                                }
                                                            }}>
                                                                [{record.action}]
                                                            </div>

                                                            {/* 附件 */}
                                                            {record.attachment && (
                                                                <div style={{
                                                                    display: 'flex',
                                                                    alignItems: 'center',
                                                                    gap: '4px',
                                                                    fontSize: '12px',
                                                                    color: '#1890ff',
                                                                    marginBottom: '8px',
                                                                    cursor: 'pointer'
                                                                }}>
                                                                    <i data-lucide="search" style={{ width: '14px', height: '14px' }}></i>
                                                                    {record.attachment}
                                                                </div>
                                                            )}

                                                            {/* 详细信息 */}
                                                            <div style={{
                                                                fontSize: '12px',
                                                                color: '#595959',
                                                                lineHeight: '1.6'
                                                            }}>
                                                                {record.type === '跟进记录' && record.details.visitTime && (
                                                                    <>
                                                                        <div>当面拜访时间: {record.details.visitTime}</div>
                                                                        {record.details.reason && <div>具体原因: {record.details.reason}</div>}
                                                                        {record.details.enterpriseInfo && <div>企业信息挖掘: {record.details.enterpriseInfo}</div>}
                                                                        {record.details.communication && <div>沟通记录: {record.details.communication}</div>}
                                                                    </>
                                                                )}
                                                                {record.type === '跟进记录' && !record.details.visitTime && (
                                                                    <>
                                                                        {record.details.reason && <div>具体原因: {record.details.reason}</div>}
                                                                        {record.details.communication && <div>沟通记录: {record.details.communication}</div>}
                                                                    </>
                                                                )}
                                                                {record.type === '咨询记录' && (
                                                                    <>
                                                                        {record.details.companyName && <div>公司名称: {record.details.companyName}</div>}
                                                                        {record.details.contactName && <div>联系人名称: {record.details.contactName}</div>}
                                                                        {record.details.contactPhone && <div>联系人电话: {record.details.contactPhone}</div>}
                                                                        {record.details.contactEmail && <div>联系人邮箱: {record.details.contactEmail}</div>}
                                                                        {record.details.leadSource && <div>线索来源: {record.details.leadSource}</div>}
                                                                        {record.details.remarks && <div>备注: {record.details.remarks}</div>}
                                                                    </>
                                                                )}
                                                                {record.type === '系统变更' && (
                                                                    <div>{record.action}系统变更</div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    ))}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        )}
                                    </div>
                                    ) : (
                                        <div style={{
                                            backgroundColor: '#fff',
                                            borderRadius: '8px',
                                            padding: '40px',
                                            marginBottom: '12px',
                                            textAlign: 'center',
                                            color: '#8c8c8c',
                                            fontSize: '14px'
                                        }}>
                                            请从左侧选择联系人查看信息
                                        </div>
                                    )}
                                    </div>
                                    ) : (
                                    <div style={{ display: 'flex', flexDirection: 'column', height: '100%', width: '100%' }}>
                                    {/* 子页面顶部栏 */}
                                    <div style={{
                                        height: '40px',
                                        backgroundColor: '#fff',
                                        borderBottom: '1px solid #e0e0e0',
                                        display: 'flex',
                                        alignItems: 'center',
                                        padding: '0 12px',
                                        gap: '12px',
                                        flexShrink: 0
                                    }}>
                                        {/* 返回按钮 */}
                                        <button
                                            onClick={() => {
                                                setShowLeadSelection(false);
                                                setShowRebindSelection(false);
                                                setLeadSearchKeyword('');
                                                setSelectedLeadId(null);
                                                // 滚动到顶部
                                                if (sidebarScrollRef.current) {
                                                    sidebarScrollRef.current.scrollTop = 0;
                                                }
                                            }}
                                            style={{
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                background: 'none',
                                                border: 'none',
                                                cursor: 'pointer',
                                                padding: '4px',
                                                borderRadius: '4px',
                                                transition: 'background-color 0.2s'
                                            }}
                                            onMouseEnter={(e) => {
                                                e.currentTarget.style.backgroundColor = '#f5f5f5';
                                            }}
                                            onMouseLeave={(e) => {
                                                e.currentTarget.style.backgroundColor = 'transparent';
                                            }}
                                        >
                                            <i data-lucide="arrow-left" style={{ width: '18px', height: '18px', color: '#333' }}></i>
                                        </button>
                                        
                                        {/* 标题 */}
                                        <div style={{
                                            fontSize: '14px',
                                            fontWeight: 500,
                                            color: '#262626'
                                        }}>
                                            {showRebindSelection ? '选择线索' : '选择线索'}
                                        </div>
                                    </div>
                                    
                                    {/* 搜索框 */}
                                    <div style={{
                                        padding: '12px',
                                        backgroundColor: '#fff',
                                        borderBottom: '1px solid #e0e0e0',
                                        flexShrink: 0
                                    }}>
                                        <div style={{
                                            display: 'flex',
                                            alignItems: 'center',
                                            backgroundColor: '#f5f5f5',
                                            borderRadius: '4px',
                                            padding: '6px 10px',
                                            gap: '8px'
                                        }}>
                                            <i data-lucide="search" style={{ width: '14px', height: '14px', color: '#999' }}></i>
                                            <input
                                                type="text"
                                                id="lead-search-input"
                                                name="leadSearch"
                                                placeholder="搜索认证名称、线索ID、UID"
                                                value={leadSearchKeyword}
                                                onChange={(e) => setLeadSearchKeyword(e.target.value)}
                                                style={{
                                                    border: 'none',
                                                    outline: 'none',
                                                    flex: 1,
                                                    fontSize: '13px',
                                                    backgroundColor: 'transparent',
                                                    color: '#262626'
                                                }}
                                            />
                                        </div>
                                    </div>

                                    {/* 线索列表 */}
                                    <div style={{
                                        flex: 1,
                                        overflowY: 'auto',
                                        padding: '12px'
                                    }}>
                                        {filteredLeads.length === 0 ? (
                                            <div style={{
                                                textAlign: 'center',
                                                padding: '40px 20px',
                                                color: '#8c8c8c',
                                                fontSize: '14px'
                                            }}>
                                                暂无数据
                                            </div>
                                        ) : (
                                            filteredLeads.map((lead, index) => {
                                                const isSelected = selectedLeadId === lead.id;
                                                return (
                                                <div
                                                    key={`lead-${lead.id}-${lead.uid}-${index}`}
                                                    onClick={() => setSelectedLeadId(lead.id)}
                                                    style={{
                                                        backgroundColor: '#fff',
                                                        borderRadius: '6px',
                                                        padding: '12px',
                                                        marginBottom: '8px',
                                                        border: isSelected ? '2px solid #1890ff' : '1px solid #e0e0e0',
                                                        cursor: 'pointer',
                                                        transition: 'all 0.2s',
                                                        position: 'relative'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        if (!isSelected) {
                                                            e.currentTarget.style.borderColor = '#1890ff';
                                                            e.currentTarget.style.boxShadow = '0 2px 4px rgba(0,0,0,0.08)';
                                                        }
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        if (!isSelected) {
                                                            e.currentTarget.style.borderColor = '#e0e0e0';
                                                            e.currentTarget.style.boxShadow = 'none';
                                                        }
                                                    }}
                                                >
                                                    {/* 选中图标 - 右上角 */}
                                                    {isSelected && (
                                                        <div style={{
                                                            position: 'absolute',
                                                            top: '8px',
                                                            right: '8px',
                                                            width: '20px',
                                                            height: '20px',
                                                            borderRadius: '50%',
                                                            backgroundColor: '#1890ff',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            boxShadow: '0 2px 4px rgba(24, 144, 255, 0.3)'
                                                        }}>
                                                            <i data-lucide="check" style={{ width: '12px', height: '12px', color: '#fff' }}></i>
                                                        </div>
                                                    )}
                                                    {/* 线索ID */}
                                                    <div style={{
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        marginBottom: '8px'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginRight: '8px',
                                                            width: '60px',
                                                            flexShrink: 0
                                                        }}>线索ID</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#1890ff',
                                                            fontWeight: 500
                                                        }}>{lead.id}</span>
                                                    </div>

                                                    {/* UID */}
                                                    <div style={{
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        marginBottom: '8px'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginRight: '8px',
                                                            width: '60px',
                                                            flexShrink: 0
                                                        }}>UID</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626'
                                                        }}>{lead.uid}</span>
                                                    </div>

                                                    {/* 认证名称 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        marginBottom: '8px'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginRight: '8px',
                                                            width: '60px',
                                                            flexShrink: 0
                                                        }}>认证名称</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626',
                                                            flex: 1,
                                                            overflow: 'hidden',
                                                            textOverflow: 'ellipsis',
                                                            whiteSpace: 'nowrap'
                                                        }}>{lead.certName}</span>
                                                    </div>

                                                    {/* 所属商务 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        marginBottom: '8px'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginRight: '8px',
                                                            width: '60px',
                                                            flexShrink: 0
                                                        }}>所属商务</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626'
                                                        }}>{lead.business}</span>
                                                    </div>

                                                    {/* 创建时间 */}
                                                    <div style={{
                                                        display: 'flex',
                                                        alignItems: 'center'
                                                    }}>
                                                        <span style={{
                                                            fontSize: '12px',
                                                            color: '#8c8c8c',
                                                            marginRight: '8px',
                                                            width: '60px',
                                                            flexShrink: 0
                                                        }}>创建时间</span>
                                                        <span style={{
                                                            fontSize: '13px',
                                                            color: '#262626'
                                                        }}>{lead.createTime}</span>
                                                    </div>
                                                </div>
                                                );
                                            })
                                        )}
                                    </div>
                                    </div>
                                    )}
                                </div>

                                {/* 子页面底部按钮栏 - 仅在子页面时显示 */}
                                {(showLeadSelection || showRebindSelection) && (
                                <div style={{
                                    borderTop: '1px solid #e0e0e0',
                                    padding: '12px 16px',
                                    backgroundColor: '#fff',
                                    display: 'flex',
                                    gap: '8px',
                                    flexShrink: 0
                                }}>
                                    <button 
                                        onClick={() => {
                                            if (!selectedLeadId) {
                                                // 显示提示：请选择一条线索数据（在侧边栏内）
                                                if (!sidebarContainerRef.current) return;
                                                const toast = document.createElement('div');
                                                toast.textContent = '请选择一条线索数据';
                                                toast.style.cssText = 'position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: #ff4d4f; padding: 12px 24px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000; font-size: 14px; color: #fff; pointer-events: none;';
                                                sidebarContainerRef.current.appendChild(toast);
                                                setTimeout(() => {
                                                    if (sidebarContainerRef.current && sidebarContainerRef.current.contains(toast)) {
                                                        sidebarContainerRef.current.removeChild(toast);
                                                    }
                                                }, 2000);
                                                return;
                                            }
                                            
                                            // 显示确认对话框（在侧边栏内）
                                            if (!sidebarContainerRef.current) return;
                                            const isRebind = showRebindSelection;
                                            const confirmDiv = document.createElement('div');
                                            confirmDiv.style.cssText = 'position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
                                            
                                            const dialog = document.createElement('div');
                                            dialog.style.cssText = 'background: #fff; padding: 24px; border-radius: 8px; max-width: 280px; width: 90%; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
                                            const dialogId = 'confirm-dialog-' + Date.now();
                                            dialog.id = dialogId;
                                            dialog.innerHTML = `
                                                <div style="margin-bottom: 20px; font-size: 14px; color: #262626; line-height: 1.5;">确认与此条线索进行${isRebind ? '换绑' : '关联'}？</div>
                                                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                                                    <button id="cancel-btn-${dialogId}" style="padding: 8px 16px; border: 1px solid #d9d9d9; background: #fff; border-radius: 4px; cursor: pointer; font-size: 14px; color: #262626; transition: all 0.2s;">取消</button>
                                                    <button id="confirm-btn-${dialogId}" style="padding: 8px 16px; border: none; background: #1890ff; color: #fff; border-radius: 4px; cursor: pointer; font-size: 14px; transition: all 0.2s;">确认</button>
                                                </div>
                                            `;
                                            confirmDiv.appendChild(dialog);
                                            sidebarContainerRef.current.appendChild(confirmDiv);
                                            
                                            // 取消按钮
                                            const cancelBtn = document.getElementById(`cancel-btn-${dialogId}`);
                                            cancelBtn.onclick = () => {
                                                if (sidebarContainerRef.current && sidebarContainerRef.current.contains(confirmDiv)) {
                                                    sidebarContainerRef.current.removeChild(confirmDiv);
                                                }
                                            };
                                            cancelBtn.onmouseenter = (e) => {
                                                e.target.style.borderColor = '#1890ff';
                                                e.target.style.color = '#1890ff';
                                            };
                                            cancelBtn.onmouseleave = (e) => {
                                                e.target.style.borderColor = '#d9d9d9';
                                                e.target.style.color = '#262626';
                                            };
                                            
                                            // 确认按钮
                                            const confirmBtn = document.getElementById(`confirm-btn-${dialogId}`);
                                            confirmBtn.onclick = () => {
                                                if (sidebarContainerRef.current && sidebarContainerRef.current.contains(confirmDiv)) {
                                                    sidebarContainerRef.current.removeChild(confirmDiv);
                                                }
                                                
                                                // 确认关联/换绑
                                                setShowLeadSelection(false);
                                                setShowRebindSelection(false);
                                                setSelectedLeadId(null);
                                                setLeadSearchKeyword('');
                                                
                                                // 显示成功提示（在侧边栏内）
                                                const toast = document.createElement('div');
                                                toast.textContent = isRebind ? '换绑成功' : '关联成功';
                                                toast.style.cssText = 'position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: #52c41a; padding: 12px 24px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000; font-size: 14px; color: #fff; pointer-events: none;';
                                                sidebarContainerRef.current.appendChild(toast);
                                                setTimeout(() => {
                                                    if (sidebarContainerRef.current && sidebarContainerRef.current.contains(toast)) {
                                                        sidebarContainerRef.current.removeChild(toast);
                                                    }
                                                }, 2000);
                                                
                                                // 滚动到顶部
                                                if (sidebarScrollRef.current) {
                                                    sidebarScrollRef.current.scrollTop = 0;
                                                }
                                            };
                                            confirmBtn.onmouseenter = (e) => {
                                                e.target.style.backgroundColor = '#40a9ff';
                                            };
                                            confirmBtn.onmouseleave = (e) => {
                                                e.target.style.backgroundColor = '#1890ff';
                                            };
                                        }}
                                        style={{
                                            width: '100%',
                                            height: '36px',
                                            border: 'none',
                                            borderRadius: '6px',
                                            backgroundColor: '#1890ff',
                                            color: '#fff',
                                            fontSize: '14px',
                                            fontWeight: 500,
                                            cursor: 'pointer',
                                            transition: 'all 0.2s',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            gap: '6px'
                                        }}
                                        onMouseEnter={(e) => {
                                            e.currentTarget.style.backgroundColor = '#40a9ff';
                                        }}
                                        onMouseLeave={(e) => {
                                            e.currentTarget.style.backgroundColor = '#1890ff';
                                        }}
                                    >
                                        <i data-lucide="link" style={{ width: '16px', height: '16px' }}></i>
                                        确认关联
                                    </button>
                                </div>
                                )}

                                {/* 底部按钮栏 - 仅在非子页面时显示 */}
                                {!(showLeadSelection || showRebindSelection) && (
                                <div style={{
                                    borderTop: '1px solid #e0e0e0',
                                    padding: '12px 16px',
                                    backgroundColor: '#fff',
                                    display: 'flex',
                                    gap: '8px',
                                    flexShrink: 0
                                }}>
                                    {selectedContact?.contactType === 'enterprise' ? (
                                        <>
                                            {/* 解绑按钮 */}
                                            <button 
                                                onClick={() => {
                                                    // 显示确认对话框（在侧边栏内）
                                                    if (!sidebarContainerRef.current) return;
                                                    const confirmDiv = document.createElement('div');
                                                    confirmDiv.style.cssText = 'position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center;';
                                                    
                                                    const dialog = document.createElement('div');
                                                    dialog.style.cssText = 'background: #fff; padding: 24px; border-radius: 8px; max-width: 280px; width: 90%; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
                                                    const dialogId = 'unbind-dialog-' + Date.now();
                                                    dialog.id = dialogId;
                                                    dialog.innerHTML = `
                                                        <div style="margin-bottom: 20px; font-size: 14px; color: #262626; line-height: 1.5;">确认将此微信客户与线索解绑？</div>
                                                        <div style="display: flex; gap: 12px; justify-content: flex-end;">
                                                            <button id="cancel-btn-${dialogId}" style="padding: 8px 16px; border: 1px solid #d9d9d9; background: #fff; border-radius: 4px; cursor: pointer; font-size: 14px; color: #262626; transition: all 0.2s;">取消</button>
                                                            <button id="confirm-btn-${dialogId}" style="padding: 8px 16px; border: none; background: #1890ff; color: #fff; border-radius: 4px; cursor: pointer; font-size: 14px; transition: all 0.2s;">确认</button>
                                                        </div>
                                                    `;
                                                    confirmDiv.appendChild(dialog);
                                                    sidebarContainerRef.current.appendChild(confirmDiv);
                                                    
                                                    // 取消按钮
                                                    const cancelBtn = document.getElementById(`cancel-btn-${dialogId}`);
                                                    cancelBtn.onclick = () => {
                                                        if (sidebarContainerRef.current && sidebarContainerRef.current.contains(confirmDiv)) {
                                                            sidebarContainerRef.current.removeChild(confirmDiv);
                                                        }
                                                    };
                                                    cancelBtn.onmouseenter = (e) => {
                                                        e.target.style.borderColor = '#1890ff';
                                                        e.target.style.color = '#1890ff';
                                                    };
                                                    cancelBtn.onmouseleave = (e) => {
                                                        e.target.style.borderColor = '#d9d9d9';
                                                        e.target.style.color = '#262626';
                                                    };
                                                    
                                                    // 确认按钮
                                                    const confirmBtn = document.getElementById(`confirm-btn-${dialogId}`);
                                                    confirmBtn.onclick = () => {
                                                        if (sidebarContainerRef.current && sidebarContainerRef.current.contains(confirmDiv)) {
                                                            sidebarContainerRef.current.removeChild(confirmDiv);
                                                        }
                                                        
                                                        // 显示成功提示（在侧边栏内）
                                                        const toast = document.createElement('div');
                                                        toast.textContent = '解绑成功';
                                                        toast.style.cssText = 'position: absolute; top: 20px; left: 50%; transform: translateX(-50%); background: #52c41a; padding: 12px 24px; border-radius: 4px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 10000; font-size: 14px; color: #fff; pointer-events: none;';
                                                        sidebarContainerRef.current.appendChild(toast);
                                                        setTimeout(() => {
                                                            if (sidebarContainerRef.current && sidebarContainerRef.current.contains(toast)) {
                                                                sidebarContainerRef.current.removeChild(toast);
                                                            }
                                                        }, 2000);
                                                    };
                                                    confirmBtn.onmouseenter = (e) => {
                                                        e.target.style.backgroundColor = '#40a9ff';
                                                    };
                                                    confirmBtn.onmouseleave = (e) => {
                                                        e.target.style.backgroundColor = '#1890ff';
                                                    };
                                                }}
                                                style={{
                                                    flex: 1,
                                                    height: '36px',
                                                    border: '1px solid #d9d9d9',
                                                    borderRadius: '6px',
                                                    backgroundColor: '#fff',
                                                    color: '#262626',
                                                    fontSize: '14px',
                                                    fontWeight: 500,
                                                    cursor: 'pointer',
                                                    transition: 'all 0.2s',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    gap: '6px'
                                                }}
                                                onMouseEnter={(e) => {
                                                    e.currentTarget.style.borderColor = '#ff4d4f';
                                                    e.currentTarget.style.color = '#ff4d4f';
                                                }}
                                                onMouseLeave={(e) => {
                                                    e.currentTarget.style.borderColor = '#d9d9d9';
                                                    e.currentTarget.style.color = '#262626';
                                                }}
                                            >
                                                <i data-lucide="unlink" style={{ width: '16px', height: '16px' }}></i>
                                                解绑
                                            </button>
                                            {/* 换绑按钮 */}
                                            <button 
                                                onClick={() => {
                                                    setShowRebindSelection(true);
                                                    setLeadSearchKeyword('');
                                                    setSelectedLeadId(null);
                                                    // 滚动到顶部
                                                    if (sidebarScrollRef.current) {
                                                        sidebarScrollRef.current.scrollTop = 0;
                                                    }
                                                }}
                                                style={{
                                                    flex: 1,
                                                    height: '36px',
                                                    border: '1px solid #d9d9d9',
                                                    borderRadius: '6px',
                                                    backgroundColor: '#fff',
                                                    color: '#262626',
                                                    fontSize: '14px',
                                                    fontWeight: 500,
                                                    cursor: 'pointer',
                                                    transition: 'all 0.2s',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    gap: '6px'
                                                }}
                                                onMouseEnter={(e) => {
                                                    e.currentTarget.style.borderColor = '#1890ff';
                                                    e.currentTarget.style.color = '#1890ff';
                                                }}
                                                onMouseLeave={(e) => {
                                                    e.currentTarget.style.borderColor = '#d9d9d9';
                                                    e.currentTarget.style.color = '#262626';
                                                }}
                                            >
                                                <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>
                                                换绑
                                            </button>
                                        </>
                                    ) : (
                                        <button 
                                            onClick={() => setShowLeadSelection(true)}
                                            style={{
                                                width: '100%',
                                                height: '36px',
                                                border: '1px solid #d9d9d9',
                                                borderRadius: '6px',
                                                backgroundColor: '#fff',
                                                color: '#262626',
                                                fontSize: '14px',
                                                fontWeight: 500,
                                                cursor: 'pointer',
                                                transition: 'all 0.2s',
                                                display: 'flex',
                                                alignItems: 'center',
                                                justifyContent: 'center',
                                                gap: '6px'
                                            }}
                                            onMouseEnter={(e) => {
                                                e.currentTarget.style.borderColor = '#1890ff';
                                                e.currentTarget.style.color = '#1890ff';
                                            }}
                                            onMouseLeave={(e) => {
                                                e.currentTarget.style.borderColor = '#d9d9d9';
                                                e.currentTarget.style.color = '#262626';
                                            }}
                                        >
                                            <i data-lucide="link" style={{ width: '16px', height: '16px' }}></i>
                                            关联线索
                                        </button>
                                    )}
                                </div>
                                )}

                                {/* 回到顶部按钮 - 固定在侧边栏右下角，不随内容滚动 */}
                                {showBackToTop && !(showLeadSelection || showRebindSelection) && (
                                    <div
                                        onClick={scrollToTop}
                                        style={{
                                            position: 'absolute',
                                            right: '16px',
                                            bottom: '80px',
                                            width: '36px',
                                            height: '36px',
                                            borderRadius: '50%',
                                            backgroundColor: '#1890ff',
                                            color: '#fff',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            cursor: 'pointer',
                                            boxShadow: '0 2px 8px rgba(0,0,0,0.15)',
                                            zIndex: 100,
                                            transition: 'all 0.3s'
                                        }}
                                        onMouseEnter={(e) => {
                                            e.currentTarget.style.backgroundColor = '#40a9ff';
                                            e.currentTarget.style.transform = 'scale(1.1)';
                                        }}
                                        onMouseLeave={(e) => {
                                            e.currentTarget.style.backgroundColor = '#1890ff';
                                            e.currentTarget.style.transform = 'scale(1)';
                                        }}
                                    >
                                        <i data-lucide="arrow-up" style={{ width: '18px', height: '18px' }}></i>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* CRM线索状态提示备注 - 位于侧边栏外面 */}
                        {selectedContact && (
                            <div style={{
                                position: 'absolute',
                                right: '20px',
                                top: '50%',
                                transform: 'translateY(-50%)',
                                zIndex: 1001,
                                maxWidth: 'min(calc(100vw - 1320px), 200px)',
                                width: 'auto'
                            }}>
                                <div style={{
                                    position: 'relative',
                                    backgroundColor: '#fffacd',
                                    borderRadius: '4px',
                                    padding: '12px 16px',
                                    boxShadow: '0 2px 8px rgba(0,0,0,0.12), 0 0 0 1px rgba(0,0,0,0.08)',
                                    fontSize: '13px',
                                    color: '#595959',
                                    lineHeight: '1.5',
                                    minWidth: '160px',
                                    maxWidth: '100%',
                                    width: '100%',
                                    border: '1px solid rgba(0,0,0,0.1)',
                                    fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',
                                    wordWrap: 'break-word',
                                    wordBreak: 'break-word',
                                    overflowWrap: 'break-word',
                                    boxSizing: 'border-box'
                                }}>
                                    {/* 左侧连接线 - 指向侧边栏 */}
                                    <div style={{
                                        position: 'absolute',
                                        left: '-20px',
                                        top: '50%',
                                        transform: 'translateY(-50%)',
                                        width: '16px',
                                        height: '2px',
                                        backgroundColor: '#d4a574',
                                        opacity: 0.6
                                    }}></div>
                                    
                                    {/* 连接点 - 指向侧边栏 */}
                                    <div style={{
                                        position: 'absolute',
                                        left: '-24px',
                                        top: '50%',
                                        transform: 'translateY(-50%)',
                                        width: '8px',
                                        height: '8px',
                                        borderRadius: '50%',
                                        backgroundColor: '#d4a574',
                                        opacity: 0.6
                                    }}></div>
                                    
                                    {/* 备注内容 */}
                                    <div style={{
                                        fontSize: '13px',
                                        color: '#595959',
                                        lineHeight: '1.6',
                                        fontWeight: 400,
                                        wordWrap: 'break-word',
                                        wordBreak: 'break-all',
                                        overflowWrap: 'break-word',
                                        whiteSpace: 'normal'
                                    }}>
                                        {selectedContact.id === 1 ? '未关联CRM线索状态' : '已关联CRM线索状态'}
                                    </div>
                                    
                                    {/* 装饰性顶部线条（模拟便签纸的顶部装饰） */}
                                    <div style={{
                                        position: 'absolute',
                                        top: '0',
                                        left: '0',
                                        right: '0',
                                        height: '3px',
                                        background: 'linear-gradient(to right, rgba(212, 165, 116, 0.3) 0%, rgba(212, 165, 116, 0.1) 100%)',
                                        borderTopLeftRadius: '4px',
                                        borderTopRightRadius: '4px'
                                    }}></div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // 聊天内容组件（用于第3栏）
        const ChatContent = ({ selectedContact, selectedEmployee, messageTypeFilter, dateRangeFilter }) => {
            // 获取发送者和接收者名称
            const senderName = selectedEmployee?.name || '我';
            const receiverName = selectedContact?.name || '对方';
            
            // 格式化时间显示
            const formatTime = (timeStr) => {
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const currentYear = now.getFullYear();
                
                // 解析时间字符串 "2026/01/20 14:30:00"
                const [datePart, timePart] = timeStr.split(' ');
                const [year, month, day] = datePart.split('/').map(Number);
                const [hours, minutes] = timePart.split(':').map(Number);
                const timeDate = new Date(year, month - 1, day, hours, minutes);
                
                // 判断是否为今日
                const isToday = timeDate >= today && timeDate < new Date(today.getTime() + 24 * 60 * 60 * 1000);
                
                // 判断是否为今年
                const isCurrentYear = year === currentYear;
                
                // 格式化时:分（去掉秒）
                const timeStrWithoutSeconds = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;
                
                if (isToday) {
                    // 今日显示：时:分
                    return timeStrWithoutSeconds;
                } else if (isCurrentYear) {
                    // 本自然年而非今日：月/日 时:分
                    return `${month}/${day} ${timeStrWithoutSeconds}`;
                } else {
                    // 本自然年以前：年/月/日 时:分
                    return `${year}/${month}/${day} ${timeStrWithoutSeconds}`;
                }
            };

            // 模拟对话记录数据（包含12种消息类型，包含当天、本年、非本年的消息）
            const allChatMessages = [
                // 当天的消息（2026/01/20）
                { id: 1, type: 'text', content: '您好，请问这个产品的价格是多少？', time: '2026/01/20 14:30:00', isMe: false },
                { id: 2, type: 'text', content: '您好，价格是2999元，现在有优惠活动。', time: '2026/01/20 14:31:15', isMe: true },
                { id: 3, type: 'emoji', content: '😊', time: '2026/01/20 14:31:20', isMe: false },
                { id: 4, type: 'image', content: '产品图片', imageUrl: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">产品图片</text></svg>'), time: '2026/01/20 14:32:00', isMe: true },
                { id: 5, type: 'voice', content: '语音消息', duration: 15, transcript: '好的，我明白了。这个产品的功能确实很强大，我会尽快安排测试。', time: '2026/01/20 14:32:30', isMe: false },
                { id: 6, type: 'file', content: '产品介绍.pdf', fileName: '产品介绍.pdf', fileSize: '2.5MB', fileType: 'pdf', time: '2026/01/20 14:33:00', isMe: true },
                { id: 7, type: 'link', content: '产品详情页面', linkUrl: 'https://example.com/product', linkTitle: '百度地图开放平台 - 产品介绍', linkDesc: '了解我们的产品功能和优势，立即体验专业的地图服务解决方案。', linkImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">链接预览图</text></svg>'), time: '2026/01/20 14:33:30', isMe: false },
                { id: 8, type: 'redpack', content: '恭喜发财，大吉大利', amount: '88.88', time: '2026/01/20 14:34:00', isMe: true },
                { id: 9, type: 'card', content: '张明', cardName: '张明', cardTitle: '销售经理', cardCompany: '百度地图开放平台', cardAvatar: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">张</text></svg>'), time: '2026/01/20 14:34:30', isMe: false },
                { id: 10, type: 'location', content: '北京市朝阳区xxx路xxx号', locationName: '百度大厦', locationAddress: '北京市海淀区上地十街10号', locationLat: 39.984, locationLng: 116.307, locationImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>'), time: '2026/01/20 14:35:00', isMe: true },
                { id: 11, type: 'miniprogram', content: '小程序消息', mpTitle: '百度地图小程序', mpDesc: '提供便捷的地图服务', mpImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">小程序</text></svg>'), mpPath: 'pages/index/index', time: '2026/01/20 14:35:30', isMe: false },
                { id: 12, type: 'recall', content: '撤回了一条消息', originalContent: '这个价格可以再优惠一些吗？', time: '2026/01/20 14:36:00', isMe: true },
                { id: 13, type: 'text', content: '没问题，我可以帮您申请一个更优惠的价格。您这边大概需要多少数量？', time: '2026/01/20 14:36:30', isMe: true },
                { id: 14, type: 'text', content: '我们公司大概需要50套左右，主要用于客户服务系统。', time: '2026/01/20 14:37:00', isMe: false },
                { id: 15, type: 'emoji', content: '👍', time: '2026/01/20 14:37:05', isMe: true },
                { id: 16, type: 'voice', content: '语音消息', duration: 28, transcript: '太好了！50套的话我可以给您申请到8折优惠，也就是每套2399元。这个价格已经是我们能给到的最优惠的价格了，您看可以吗？', time: '2026/01/20 14:37:30', isMe: true },
                { id: 17, type: 'text', content: '好的，这个价格可以接受。那我们什么时候可以开始实施？', time: '2026/01/20 14:38:00', isMe: false },
                { id: 18, type: 'file', content: '实施计划书.docx', fileName: '实施计划书.docx', fileSize: '1.8MB', fileType: 'docx', time: '2026/01/20 14:38:30', isMe: true },
                { id: 19, type: 'text', content: '这是我们详细的实施计划书，您可以先看一下。如果确认的话，我们可以下周就开始。', time: '2026/01/20 14:38:45', isMe: true },
                { id: 20, type: 'image', content: '产品架构图', imageUrl: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">产品架构图</text></svg>'), time: '2026/01/20 14:39:00', isMe: false },
                { id: 21, type: 'text', content: '这个架构图很清晰，我发给技术团队评估一下。', time: '2026/01/20 14:39:15', isMe: false },
                { id: 22, type: 'video', content: '产品演示视频', videoUrl: 'https://example.com/video.mp4', videoThumbnail: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#722ed1"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">视频</text></svg>'), duration: 120, time: '2026/01/20 14:39:30', isMe: true },
                { id: 23, type: 'link', content: '技术文档', linkUrl: 'https://example.com/docs', linkTitle: '百度地图API技术文档', linkDesc: '完整的技术文档和开发指南，包含所有API接口说明和示例代码。', linkImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">技术文档</text></svg>'), time: '2026/01/20 14:39:45', isMe: true },
                { id: 24, type: 'text', content: '这是我们的技术文档，您可以参考一下。有任何问题随时联系我。', time: '2026/01/20 14:40:00', isMe: true },
                { id: 25, type: 'location', content: '公司地址', locationName: '我们公司', locationAddress: '北京市朝阳区建国路88号SOHO现代城', locationLat: 39.908, locationLng: 116.475, locationImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>'), time: '2026/01/20 14:40:30', isMe: false },
                { id: 26, type: 'text', content: '这是我们公司的地址，如果方便的话，欢迎您来我们公司实地考察。', time: '2026/01/20 14:40:45', isMe: false },
                { id: 27, type: 'card', content: '李总', cardName: '李总', cardTitle: '技术总监', cardCompany: '客户公司', cardAvatar: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">李</text></svg>'), time: '2026/01/20 14:41:00', isMe: false },
                { id: 28, type: 'text', content: '这是我们技术总监李总的联系方式，技术相关的问题可以直接找他。', time: '2026/01/20 14:41:15', isMe: false },
                { id: 29, type: 'miniprogram', content: '小程序', mpTitle: '百度地图服务助手', mpDesc: '快速查询地图服务状态和API使用情况', mpImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="12" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">服务助手</text></svg>'), mpPath: 'pages/service/index', time: '2026/01/20 14:41:45', isMe: true },
                { id: 30, type: 'text', content: '这个小程序可以帮您快速查看服务状态，很方便的。', time: '2026/01/20 14:42:00', isMe: true },
                { id: 31, type: 'emoji', content: '😄', time: '2026/01/20 14:42:05', isMe: false },
                { id: 32, type: 'text', content: '好的，我先看看文档，有消息再联系您。', time: '2026/01/20 14:42:30', isMe: false },
                { id: 33, type: 'text', content: '没问题，随时联系我。期待与您的合作！', time: '2026/01/20 14:43:00', isMe: true },
                { id: 34, type: 'emoji', content: '🤝', time: '2026/01/20 14:43:05', isMe: false },
                { id: 35, type: 'redpack', content: '新年快乐，恭喜发财', amount: '200.00', time: '2026/01/20 14:43:30', isMe: false },
                { id: 36, type: 'recall', content: '撤回了一条消息', originalContent: '谢谢您的红包！', time: '2026/01/20 14:43:45', isMe: true },
                // 本年的消息（2026年，非当天）
                { id: 37, type: 'text', content: '上次讨论的方案，我已经整理好了', time: '2026/01/19 16:20:00', isMe: true },
                { id: 38, type: 'text', content: '好的，我看看', time: '2026/01/19 16:21:00', isMe: false },
                { id: 39, type: 'image', content: '方案文档', imageUrl: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">方案文档</text></svg>'), time: '2026/01/18 10:15:00', isMe: true },
                { id: 40, type: 'text', content: '收到，谢谢', time: '2026/01/18 10:16:00', isMe: false },
                { id: 41, type: 'text', content: '关于产品功能，我想再了解一下', time: '2026/01/15 14:30:00', isMe: false },
                { id: 42, type: 'text', content: '没问题，我来详细介绍一下', time: '2026/01/15 14:31:00', isMe: true },
                { id: 43, type: 'voice', content: '语音消息', duration: 25, transcript: '我们的产品主要有以下几个核心功能...', time: '2026/01/10 09:20:00', isMe: true },
                { id: 44, type: 'text', content: '明白了，谢谢', time: '2026/01/10 09:21:00', isMe: false },
                // 非本年的消息（2025年或更早）
                { id: 45, type: 'text', content: '去年的项目进展如何？', time: '2025/12/20 15:30:00', isMe: false },
                { id: 46, type: 'text', content: '进展顺利，预计下个月完成', time: '2025/12/20 15:31:00', isMe: true },
                { id: 47, type: 'file', content: '项目报告.pdf', fileName: '项目报告.pdf', fileSize: '3.2MB', fileType: 'pdf', time: '2025/11/15 11:20:00', isMe: true },
                { id: 48, type: 'text', content: '收到，我会仔细查看', time: '2025/11/15 11:21:00', isMe: false },
                { id: 49, type: 'text', content: '合同已经签署完成', time: '2025/10/08 14:15:00', isMe: true },
                { id: 50, type: 'text', content: '太好了，期待合作', time: '2025/10/08 14:16:00', isMe: false }
            ];

            // 解析时间字符串为Date对象
            const parseTime = (timeStr) => {
                // 格式: 2026/01/20 14:30:00
                const parts = timeStr.split(' ');
                const dateParts = parts[0].split('/');
                const timeParts = parts[1] ? parts[1].split(':') : ['0', '0', '0'];
                return new Date(
                    parseInt(dateParts[0]),
                    parseInt(dateParts[1]) - 1,
                    parseInt(dateParts[2]),
                    parseInt(timeParts[0]),
                    parseInt(timeParts[1]),
                    parseInt(timeParts[2])
                );
            };

            // 根据消息类型和日期范围筛选
            let filteredMessages = allChatMessages;
            
            // 先按消息类型筛选
            if (messageTypeFilter !== '全部') {
                const typeMap = {
                    '文本': 'text',
                    '表情': 'emoji',
                    '语音': 'voice',
                    '图片': 'image',
                    '视频': 'video',
                    '文件': 'file',
                    '链接': 'link',
                    '红包': 'redpack',
                    '名片': 'card',
                    '位置': 'location',
                    '小程序消息': 'miniprogram',
                    '撤回消息': 'recall'
                };
                filteredMessages = filteredMessages.filter(msg => msg.type === typeMap[messageTypeFilter]);
            }
            
            // 再按日期范围筛选
            if (dateRangeFilter && dateRangeFilter.length === 2 && dateRangeFilter[0] && dateRangeFilter[1]) {
                // Ant Design的RangePicker返回的是dayjs对象
                const startDate = dateRangeFilter[0].startOf('day');
                const endDate = dateRangeFilter[1].endOf('day');
                
                filteredMessages = filteredMessages.filter(msg => {
                    const msgDate = parseTime(msg.time);
                    const msgDayjs = dayjs(msgDate);
                    // 检查消息时间是否在日期范围内（包含开始和结束日期）
                    return (msgDayjs.isAfter(startDate) || msgDayjs.isSame(startDate)) && 
                           (msgDayjs.isBefore(endDate) || msgDayjs.isSame(endDate));
                });
            }

            // 渲染消息内容（复用ChatDetail的逻辑）
            const renderMessageContent = (msg) => {
                switch (msg.type) {
                    case 'text':
                        return <span>{msg.content}</span>;
                    case 'emoji':
                        return <span style={{ fontSize: '24px' }}>{msg.content}</span>;
                    case 'image':
                        const defaultImageSvg = encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">产品图片</text></svg>');
                        return (
                            <div className="message-image-container">
                                <img 
                                    src={msg.imageUrl || `data:image/svg+xml;charset=utf-8,${defaultImageSvg}`} 
                                    alt={msg.content}
                                    onError={(e) => {
                                        const fallbackSvg = encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">图片</text></svg>');
                                        e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                    }}
                                />
                            </div>
                        );
                    case 'voice':
                        return (
                            <div>
                                <div className="message-voice-container">
                                    <div 
                                        className="voice-play-btn"
                                        onClick={(e) => {
                                            e.stopPropagation();
                                        }}
                                        style={{ cursor: 'pointer' }}
                                    >
                                        <i data-lucide="play" style={{ width: '12px', height: '12px' }}></i>
                                    </div>
                                    <div className="voice-duration">{msg.duration || 15}"</div>
                                    <div className="voice-wave"></div>
                                </div>
                                {msg.transcript && (
                                    <div className="voice-transcript">{msg.transcript}</div>
                                )}
                            </div>
                        );
                    case 'video':
                        return (
                            <div className="message-video">
                                <img 
                                    src={msg.videoThumbnail || 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#722ed1"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">视频</text></svg>')} 
                                    alt="视频"
                                    style={{ width: '200px', height: '150px', objectFit: 'cover', borderRadius: '4px' }}
                                />
                                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginTop: '8px' }}>
                                    <i data-lucide="video" style={{ width: '16px', height: '16px' }}></i>
                                    <span>视频消息 {msg.duration ? `(${Math.floor(msg.duration / 60)}:${String(msg.duration % 60).padStart(2, '0')})` : ''}</span>
                                </div>
                            </div>
                        );
                    case 'file':
                        return (
                            <div className="message-file-container">
                                <div className={`file-icon ${msg.fileType || 'pdf'}`}>
                                    {msg.fileType === 'pdf' ? (
                                        <span style={{ fontSize: '20px', fontWeight: 'bold' }}>PDF</span>
                                    ) : (
                                        <i data-lucide="file" style={{ width: '24px', height: '24px' }}></i>
                                    )}
                                </div>
                                <div className="file-info">
                                    <div className="file-name">{msg.fileName || msg.content}</div>
                                    <div className="file-size">{msg.fileSize || '2.5MB'}</div>
                                </div>
                            </div>
                        );
                    case 'link':
                        const defaultLinkSvg = encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">链接预览图</text></svg>');
                        return (
                            <div className="message-link-card">
                                <img 
                                    src={msg.linkImage || `data:image/svg+xml;charset=utf-8,${defaultLinkSvg}`} 
                                    alt={msg.linkTitle} 
                                    className="link-image"
                                    onError={(e) => {
                                        const fallbackSvg = encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">链接</text></svg>');
                                        e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                    }}
                                />
                                <div className="link-content">
                                    <div className="link-title">{msg.linkTitle || msg.content}</div>
                                    <div className="link-desc">{msg.linkDesc || '点击查看详情'}</div>
                                </div>
                            </div>
                        );
                    case 'redpack':
                        return (
                            <div className="message-redpack-card">
                                <div className="redpack-decor"></div>
                                <div className="redpack-icon">🧧</div>
                                <div className="redpack-text">{msg.content}</div>
                                {msg.amount && (
                                    <div className="redpack-amount">¥{msg.amount}</div>
                                )}
                            </div>
                        );
                    case 'card':
                        return (
                            <div className="message-card-container">
                                <div className="card-header">
                                    <div className="card-avatar">
                                        {msg.cardAvatar ? (
                                            <img 
                                                src={msg.cardAvatar} 
                                                alt={msg.cardName}
                                                onError={(e) => {
                                                    e.target.style.display = 'none';
                                                    const fallback = e.target.parentElement.querySelector('.card-avatar-fallback');
                                                    if (fallback) {
                                                        fallback.style.display = 'flex';
                                                    }
                                                }}
                                            />
                                        ) : null}
                                        <span className="card-avatar-fallback" style={{ display: msg.cardAvatar ? 'none' : 'flex' }}>{msg.cardName ? msg.cardName.charAt(0) : '?'}</span>
                                    </div>
                                    <div className="card-info">
                                        <div className="card-name">{msg.cardName || msg.content}</div>
                                        <div className="card-title">{msg.cardTitle || '销售经理'}</div>
                                    </div>
                                </div>
                                {msg.cardCompany && (
                                    <div className="card-company">{msg.cardCompany}</div>
                                )}
                            </div>
                        );
                    case 'location':
                        return (
                            <div className="message-location-container">
                                {(() => {
                                    const defaultLocationSvg = encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>');
                                    return (
                                        <img 
                                            src={msg.locationImage || `data:image/svg+xml;charset=utf-8,${defaultLocationSvg}`} 
                                            alt={msg.locationName} 
                                            className="location-image"
                                            onError={(e) => {
                                                const fallbackSvg = encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid2" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid2)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>');
                                                e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                            }}
                                        />
                                    );
                                })()}
                                <div className="location-content">
                                    <div className="location-name">{msg.locationName || msg.content}</div>
                                    <div className="location-address">{msg.locationAddress || msg.content}</div>
                                </div>
                            </div>
                        );
                    case 'miniprogram':
                        return (
                            <div className="message-miniprogram-card">
                                <div className="mp-header">
                                    <div className="mp-icon">小</div>
                                    <div className="mp-title">小程序</div>
                                </div>
                                <div className="mp-body">
                                    {(() => {
                                        const defaultMpSvg = encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="12" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">小程序</text></svg>');
                                        return (
                                            <img 
                                                src={msg.mpImage || `data:image/svg+xml;charset=utf-8,${defaultMpSvg}`} 
                                                alt={msg.mpTitle} 
                                                className="mp-image"
                                                onError={(e) => {
                                                    const fallbackSvg = encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="10" fill="#fff" text-anchor="middle" dominant-baseline="middle">MP</text></svg>');
                                                    e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                                }}
                                            />
                                        );
                                    })()}
                                    <div className="mp-content">
                                        <div className="mp-name">{msg.mpTitle || msg.content}</div>
                                        <div className="mp-desc">{msg.mpDesc || '提供便捷的服务'}</div>
                                    </div>
                                </div>
                            </div>
                        );
                    case 'recall':
                        return (
                            <div>
                                <div className="message-recall">{msg.content}</div>
                                {msg.originalContent && (
                                    <div className="message-recall-content">{msg.originalContent}</div>
                                )}
                            </div>
                        );
                    default:
                        return <span>{msg.content}</span>;
                }
            };

            const renderMessage = (msg) => {
                return (
                    <div key={msg.id} id={`chat-message-${msg.id}`} className={`chat-message ${msg.isMe ? 'me' : ''}`}>
                        {!msg.isMe && (
                            <div className="chat-avatar other">
                                {receiverName.charAt(0)}
                            </div>
                        )}
                        <div className="chat-content-wrapper">
                            <div className="chat-name-time">
                                {msg.isMe ? senderName : receiverName} · {formatTime(msg.time)}
                            </div>
                            <div className={`chat-bubble ${msg.isMe ? 'me' : 'other'} ${msg.type === 'recall' ? 'recall' : ''}`}>
                                {renderMessageContent(msg)}
                            </div>
                        </div>
                        {msg.isMe && (
                            <div className="chat-avatar me">
                                {senderName.charAt(0)}
                            </div>
                        )}
                    </div>
                );
            };

            const chatContainerRef = React.useRef(null);

            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            // 滚动到底部（默认显示最新消息）
            useEffect(() => {
                if (chatContainerRef.current) {
                    chatContainerRef.current.scrollTop = chatContainerRef.current.scrollHeight;
                }
            }, [filteredMessages, selectedContact, selectedEmployee, messageTypeFilter, dateRangeFilter]);

            return (
                <div 
                    ref={chatContainerRef}
                    className="chat-content-container chat-detail-container" 
                    style={{ 
                        flex: 1, 
                        overflowY: 'auto',
                        padding: '16px',
                        backgroundColor: '#ededed'
                    }}
                >
                    {filteredMessages.length === 0 ? (
                        <div style={{ textAlign: 'center', color: '#8c8c8c', padding: '40px' }}>
                            暂无消息
                        </div>
                    ) : (
                        filteredMessages.map(msg => renderMessage(msg))
                    )}
                </div>
            );
        };

        // 聊天搜索框组件（用于第3栏）- 参考Chrome浏览器搜索功能
        const ChatSearchBox = ({ 
            searchKeyword, 
            setSearchKeyword, 
            matchCount, 
            setMatchCount, 
            currentMatchIndex, 
            setCurrentMatchIndex, 
            matchRefs, 
            setMatchRefs,
            containerSelector
        }) => {
            // 清除所有高亮标记
            const clearAllHighlights = () => {
                let container = document.querySelector('.chat-detail-container') || document.querySelector('.chat-content-container');
                if (!container) return;
                
                // 清除所有 search-highlight 标记
                const highlights = container.querySelectorAll('.search-highlight');
                highlights.forEach(mark => {
                    const parent = mark.parentNode;
                    if (parent) {
                        parent.replaceChild(document.createTextNode(mark.textContent), mark);
                        parent.normalize();
                    }
                });
                
                // 清除所有 search-match 类
                container.querySelectorAll('.search-match').forEach(el => {
                    el.classList.remove('search-match');
                });
            };

            // 高亮文本节点
            const highlightTextNodes = (keyword) => {
                if (!keyword || !keyword.trim()) return;
                
                let container = document.querySelector('.chat-detail-container') || document.querySelector('.chat-content-container');
                if (!container) return;
                
                const regex = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
                
                const walker = document.createTreeWalker(
                    container,
                    NodeFilter.SHOW_TEXT,
                    null,
                    false
                );
                
                const textNodes = [];
                let node;
                while (node = walker.nextNode()) {
                    // 跳过已经在 search-highlight 内的文本节点
                    if (node.parentElement && node.parentElement.classList.contains('search-highlight')) {
                        continue;
                    }
                    if (node.textContent.trim() && regex.test(node.textContent)) {
                        textNodes.push(node);
                    }
                }
                
                textNodes.forEach(textNode => {
                    const parent = textNode.parentNode;
                    if (parent && !parent.classList.contains('search-highlight')) {
                        const text = textNode.textContent;
                        const parts = text.split(regex);
                        const fragment = document.createDocumentFragment();
                        
                        parts.forEach((part) => {
                            if (regex.test(part)) {
                                const mark = document.createElement('mark');
                                mark.className = 'search-highlight';
                                mark.textContent = part;
                                fragment.appendChild(mark);
                            } else if (part) {
                                fragment.appendChild(document.createTextNode(part));
                            }
                        });
                        
                        parent.replaceChild(fragment, textNode);
                    }
                });
            };

            // 搜索并定位匹配结果
            const searchAndHighlight = (keyword) => {
                // 先清除旧的高亮
                clearAllHighlights();
                
                if (!keyword || !keyword.trim()) {
                    setMatchCount(0);
                    setCurrentMatchIndex(0);
                    setMatchRefs([]);
                    return;
                }
                
                let container = document.querySelector('.chat-detail-container') || document.querySelector('.chat-content-container');
                if (!container) {
                    setMatchCount(0);
                    setCurrentMatchIndex(0);
                    setMatchRefs([]);
                    return;
                }
                
                const regex = new RegExp(keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                const matches = [];
                
                // 查找所有包含关键词的消息元素
                const messageElements = container.querySelectorAll('[id^="chat-message-"]');
                messageElements.forEach(msgEl => {
                    const textContent = msgEl.textContent || '';
                    if (regex.test(textContent)) {
                        const msgId = msgEl.id.replace('chat-message-', '');
                        matches.push({ id: msgId, element: msgEl });
                    }
                });
                
                // 高亮文本
                highlightTextNodes(keyword);
                
                // 更新状态
                const count = matches.length;
                setMatchCount(count);
                setCurrentMatchIndex(count > 0 ? 1 : 0);
                setMatchRefs(matches);
                
                // 定位到第一个匹配结果
                if (count > 0 && matches[0] && matches[0].element) {
                    setTimeout(() => {
                        matches[0].element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        matches[0].element.classList.add('search-highlight-active');
                        setTimeout(() => {
                            matches[0].element.classList.remove('search-highlight-active');
                        }, 1000);
                    }, 100);
                }
            };

            // 导航到下一个匹配结果
            const navigateToNext = () => {
                if (matchCount === 0) return;
                
                const newIndex = (currentMatchIndex % matchCount) + 1;
                setCurrentMatchIndex(newIndex);
                
                if (matchRefs.length > 0) {
                    const targetIndex = newIndex - 1;
                    const targetMatch = matchRefs[targetIndex];
                    if (targetMatch && targetMatch.element) {
                        targetMatch.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        targetMatch.element.classList.add('search-highlight-active');
                        setTimeout(() => {
                            targetMatch.element.classList.remove('search-highlight-active');
                        }, 1000);
                    }
                }
            };

            // 处理搜索输入
            const handleSearchChange = (e) => {
                const keyword = e.target.value;
                setSearchKeyword(keyword);
                
                // 延迟执行搜索，确保DOM已渲染
                setTimeout(() => {
                    searchAndHighlight(keyword);
                }, 50);
            };

            // 处理键盘事件
            const handleKeyDown = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    navigateToNext();
                } else if (e.key === 'Escape') {
                    clearAllHighlights();
                    setSearchKeyword('');
                    setMatchCount(0);
                    setCurrentMatchIndex(0);
                    setMatchRefs([]);
                }
            };

            // 清除搜索
            const clearSearch = () => {
                clearAllHighlights();
                setSearchKeyword('');
                setMatchCount(0);
                setCurrentMatchIndex(0);
                setMatchRefs([]);
            };


            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            // 当组件卸载时，清除所有高亮
            useEffect(() => {
                return () => {
                    clearAllHighlights();
                };
            }, []);

            return (
                <div className="drawer-search-box" style={{ minWidth: '300px', maxWidth: '400px' }}>
                    <i data-lucide="search" style={{ width: '14px', height: '14px', color: '#666', marginRight: '6px' }}></i>
                    <input
                        type="text"
                        className="drawer-search-input"
                        placeholder="搜索聊天记录..."
                        value={searchKeyword || ''}
                        onChange={handleSearchChange}
                        onKeyDown={handleKeyDown}
                    />
                    {searchKeyword && (
                        <>
                            <div className="drawer-search-navigation">
                                <button
                                    className="drawer-search-nav-btn"
                                    onClick={() => {
                                        if (matchCount === 0) return;
                                        const newIndex = currentMatchIndex <= 1 ? matchCount : currentMatchIndex - 1;
                                        setCurrentMatchIndex(newIndex);
                                        if (matchRefs.length > 0) {
                                            const targetIndex = newIndex - 1;
                                            const targetMatch = matchRefs[targetIndex];
                                            if (targetMatch && targetMatch.element) {
                                                targetMatch.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                                targetMatch.element.classList.add('search-highlight-active');
                                                setTimeout(() => {
                                                    targetMatch.element.classList.remove('search-highlight-active');
                                                }, 1000);
                                            }
                                        }
                                    }}
                                    disabled={matchCount === 0}
                                    title="上一个"
                                >
                                    <i data-lucide="chevron-up" style={{ width: '12px', height: '12px' }}></i>
                                </button>
                                <button
                                    className="drawer-search-nav-btn"
                                    onClick={navigateToNext}
                                    disabled={matchCount === 0}
                                    title="下一个 (Enter)"
                                >
                                    <i data-lucide="chevron-down" style={{ width: '12px', height: '12px' }}></i>
                                </button>
                            </div>
                            {matchCount > 0 && (
                                <div className="drawer-search-count">
                                    {currentMatchIndex}/{matchCount}
                                </div>
                            )}
                            <button
                                className="drawer-search-close"
                                onClick={clearSearch}
                                title="关闭 (Esc)"
                            >
                                <i data-lucide="x" style={{ width: '12px', height: '12px' }}></i>
                            </button>
                        </>
                    )}
                </div>
            );
        };

        // 聊天记录页面组件
        const EmployeeChatRecords = () => {
            const [employeeSearchKeyword, setEmployeeSearchKeyword] = useState('');
            const [selectedEmployee, setSelectedEmployee] = useState(null);
            const [refreshTime, setRefreshTime] = useState('');
            const [activeTab, setActiveTab] = useState('客户'); // 客户、群聊、员工
            const [contactSearchKeyword, setContactSearchKeyword] = useState('');
            const [selectedContact, setSelectedContact] = useState(null); // 选中的客户/群聊/员工
            const [messageTypeFilter, setMessageTypeFilter] = useState('全部'); // 消息类型筛选
            const [dateRangeFilter, setDateRangeFilter] = useState([
                dayjs().subtract(6, 'day').startOf('day'),
                dayjs().endOf('day')
            ]); // 日期范围筛选（默认最近7天）
            const [chatSearchKeyword, setChatSearchKeyword] = useState(''); // 聊天记录搜索关键词
            const [chatMatchCount, setChatMatchCount] = useState(0);
            const [chatCurrentMatchIndex, setChatCurrentMatchIndex] = useState(0);
            const [chatMatchRefs, setChatMatchRefs] = useState([]);
            const [departmentFilterVisible, setDepartmentFilterVisible] = useState(false); // 部门筛选弹窗显示状态
            const [selectedDepartments, setSelectedDepartments] = useState([]); // 选中的部门

            // 模拟员工数据（前5个今日，6-10个本年，其他非本年）
            const [employees, setEmployees] = useState([
                // 前5个：今日（2026/01/20）
                { id: 1, name: '李想', department: '事业部', avatar: '李', lastChatTime: '2026/01/20 14:23:00', todayCount: 30, totalCount: 286, type: '图片', isExpired: false },
                { id: 2, name: '王伟军', department: '销售部', avatar: '王', lastChatTime: '2026/01/20 09:12:00', todayCount: 15, totalCount: 523, type: '文本', isExpired: true },
                { id: 3, name: '毛奇', department: '销售部', avatar: '毛', lastChatTime: '2026/01/20 07:00:00', todayCount: 8, totalCount: 189, type: '语音', isExpired: false },
                { id: 4, name: '谢丽', department: '客服部', avatar: '谢', lastChatTime: '2026/01/20 15:30:00', todayCount: 45, totalCount: 1024, type: '文本', isExpired: false },
                { id: 5, name: '周杰', department: '客服部', avatar: '周', lastChatTime: '2026/01/20 11:20:00', todayCount: 22, totalCount: 678, type: '视频', isExpired: true },
                // 6-10个：本年非今日（2026年）
                { id: 6, name: '王晨', department: '售后支持', avatar: '王', lastChatTime: '2026/01/19 16:45:00', todayCount: 0, totalCount: 234, type: '文件', isExpired: false },
                { id: 7, name: '王鸿码', department: '人事部', avatar: '王', lastChatTime: '2026/01/18 11:20:00', todayCount: 5, totalCount: 156, type: '文本', isExpired: false },
                { id: 8, name: '梁晨鹿', department: '策划部', avatar: '梁', lastChatTime: '2026/01/10 10:15:00', todayCount: 0, totalCount: 89, type: '图片', isExpired: true },
                { id: 9, name: '沈才财', department: '财务部', avatar: '沈', lastChatTime: '2026/01/05 14:30:00', todayCount: 0, totalCount: 67, type: '文本', isExpired: false },
                { id: 10, name: '姚北盟', department: '财务部', avatar: '姚', lastChatTime: '2026/01/02 09:00:00', todayCount: 3, totalCount: 123, type: '链接', isExpired: true },
                // 其他：非本年（2025年或更早）
                { id: 11, name: '张明', department: '技术部', avatar: '张', lastChatTime: '2025/12/15 15:30:00', todayCount: 18, totalCount: 456, type: '文本', isExpired: false },
                { id: 12, name: '刘芳', department: '市场部', avatar: '刘', lastChatTime: '2025/11/20 13:45:00', todayCount: 25, totalCount: 789, type: '图片', isExpired: false },
                { id: 13, name: '陈强', department: '运营部', avatar: '陈', lastChatTime: '2025/10/15 12:20:00', todayCount: 12, totalCount: 345, type: '语音', isExpired: false },
                { id: 14, name: '赵敏', department: '产品部', avatar: '赵', lastChatTime: '2025/09/10 11:10:00', todayCount: 7, totalCount: 234, type: '文本', isExpired: false },
                { id: 15, name: '孙丽', department: '设计部', avatar: '孙', lastChatTime: '2025/08/05 10:30:00', todayCount: 20, totalCount: 567, type: '图片', isExpired: false },
                { id: 16, name: '吴刚', department: '研发部', avatar: '吴', lastChatTime: '2025/07/20 09:45:00', todayCount: 15, totalCount: 432, type: '文件', isExpired: false },
                { id: 17, name: '郑华', department: '测试部', avatar: '郑', lastChatTime: '2025/06/15 08:20:00', todayCount: 9, totalCount: 321, type: '文本', isExpired: false },
                { id: 18, name: '钱伟', department: '销售部', avatar: '钱', lastChatTime: '2025/05/10 17:30:00', todayCount: 0, totalCount: 654, type: '语音', isExpired: true },
                { id: 19, name: '周涛', department: '客服部', avatar: '周', lastChatTime: '2025/04/05 16:15:00', todayCount: 0, totalCount: 543, type: '文本', isExpired: false },
                { id: 20, name: '吴静', department: '人事部', avatar: '吴', lastChatTime: '2025/03/01 15:00:00', todayCount: 0, totalCount: 234, type: '图片', isExpired: false }
            ]);

            // 获取当前时间
            const getCurrentTime = () => {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                return `${year}/${month}/${day} ${hours}:${minutes}:${seconds}`;
            };

            // 刷新
            const handleRefresh = () => {
                setRefreshTime(getCurrentTime());
            };

            // 初始化刷新时间
            useEffect(() => {
                setRefreshTime(getCurrentTime());
            }, []);

            // 刷新图标
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            // 点击外部关闭部门筛选弹窗
            useEffect(() => {
                const handleClickOutside = (event) => {
                    // 检查点击是否在弹窗内部
                    const isInsideContainer = event.target.closest('.department-filter-container');
                    // 检查点击是否在下拉菜单内部 (TreeSelect 的下拉菜单默认渲染在 body 中)
                    const isInsideDropdown = event.target.closest('.ant-select-dropdown') || event.target.closest('.ant-tree-select-dropdown');
                    
                    if (departmentFilterVisible && !isInsideContainer && !isInsideDropdown) {
                        setDepartmentFilterVisible(false);
                    }
                };
                if (departmentFilterVisible) {
                    document.addEventListener('mousedown', handleClickOutside);
                }
                return () => {
                    document.removeEventListener('mousedown', handleClickOutside);
                };
            }, [departmentFilterVisible]);

            // 格式化时间显示
            const formatTime = (timeStr, isFirstThree = false) => {
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const currentYear = now.getFullYear();
                
                // 解析时间字符串 "2026/01/20 14:23:00"
                const [datePart, timePart] = timeStr.split(' ');
                const [year, month, day] = datePart.split('/').map(Number);
                const [hours, minutes] = timePart.split(':').map(Number);
                const timeDate = new Date(year, month - 1, day, hours, minutes);
                
                // 判断是否为今日
                const isToday = timeDate >= today && timeDate < new Date(today.getTime() + 24 * 60 * 60 * 1000);
                
                // 判断是否为今年
                const isCurrentYear = year === currentYear;
                
                // 格式化时:分（去掉秒）
                const timeStrWithoutSeconds = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;
                
                // 如果是前3个且是当天的，只显示时:分
                if (isFirstThree && isToday) {
                    return timeStrWithoutSeconds;
                }
                
                if (isToday) {
                    // 今日显示：时:分
                    return timeStrWithoutSeconds;
                } else if (isCurrentYear) {
                    // 本自然年而非今日：月/日 时:分
                    return `${month}/${day} ${timeStrWithoutSeconds}`;
                } else {
                    // 本自然年以前：年/月/日 时:分
                    return `${year}/${month}/${day} ${timeStrWithoutSeconds}`;
                }
            };

            // 计算有效员工数量（排除已失效）
            const activeEmployeeCount = employees.filter(emp => !emp.isExpired).length;

            // 组织架构数据（用于部门筛选）
            const orgTreeData = [
                {
                    title: '销售部',
                    value: 'sales',
                    key: 'sales',
                    children: [
                        {
                            title: '销售一部',
                            value: 'sales_1',
                            key: 'sales_1'
                        },
                        {
                            title: '销售二部',
                            value: 'sales_2',
                            key: 'sales_2'
                        }
                    ]
                },
                {
                    title: '市场部',
                    value: 'marketing',
                    key: 'marketing',
                    children: [
                        {
                            title: '市场推广组',
                            value: 'marketing_promo',
                            key: 'marketing_promo'
                        },
                        {
                            title: '品牌管理组',
                            value: 'marketing_brand',
                            key: 'marketing_brand'
                        }
                    ]
                },
                {
                    title: '技术部',
                    value: 'tech',
                    key: 'tech',
                    children: [
                        {
                            title: '研发组',
                            value: 'tech_dev',
                            key: 'tech_dev'
                        }
                    ]
                },
                {
                    title: '客服部',
                    value: 'service',
                    key: 'service'
                },
                {
                    title: '人事部',
                    value: 'hr',
                    key: 'hr'
                },
                {
                    title: '财务部',
                    value: 'finance',
                    key: 'finance'
                },
                {
                    title: '事业部',
                    value: 'business',
                    key: 'business'
                },
                {
                    title: '售后支持',
                    value: 'after_sales',
                    key: 'after_sales'
                },
                {
                    title: '策划部',
                    value: 'planning',
                    key: 'planning'
                },
                {
                    title: '运营部',
                    value: 'operations',
                    key: 'operations'
                },
                {
                    title: '产品部',
                    value: 'product',
                    key: 'product'
                },
                {
                    title: '设计部',
                    value: 'design',
                    key: 'design'
                },
                {
                    title: '研发部',
                    value: 'rd',
                    key: 'rd'
                },
                {
                    title: '测试部',
                    value: 'testing',
                    key: 'testing'
                }
            ];

            // 获取所有部门值（包括子部门）
            const getAllDepartmentValues = (treeData) => {
                let values = [];
                treeData.forEach(item => {
                    if (item.children && item.children.length > 0) {
                        values.push(item.value);
                        values = values.concat(getAllDepartmentValues(item.children));
                    } else {
                        values.push(item.value);
                    }
                });
                return values;
            };

            // 部门映射（用于匹配员工部门）
            const departmentMap = {
                'sales': '销售部',
                'sales_1': '销售部',
                'sales_2': '销售部',
                'marketing': '市场部',
                'marketing_promo': '市场部',
                'marketing_brand': '市场部',
                'tech': '技术部',
                'tech_dev': '技术部',
                'service': '客服部',
                'hr': '人事部',
                'finance': '财务部',
                'business': '事业部',
                'after_sales': '售后支持',
                'planning': '策划部',
                'operations': '运营部',
                'product': '产品部',
                'design': '设计部',
                'rd': '研发部',
                'testing': '测试部'
            };

            // 过滤员工
            const filteredEmployees = employees.filter(emp => {
                const nameMatch = emp.name.toLowerCase().includes(employeeSearchKeyword.toLowerCase());
                // 如果选择了部门，需要匹配部门
                if (selectedDepartments.length > 0) {
                    const departmentMatch = selectedDepartments.some(deptValue => {
                        const deptName = departmentMap[deptValue];
                        return deptName && emp.department === deptName;
                    });
                    return nameMatch && departmentMatch;
                }
                return nameMatch;
            });

            // 按最近会话时间排序
            const sortedEmployees = [...filteredEmployees].sort((a, b) => {
                const timeA = new Date(a.lastChatTime.replace(/\//g, '-'));
                const timeB = new Date(b.lastChatTime.replace(/\//g, '-'));
                return timeB - timeA;
            });

            // 模拟客户数据
            const customers = [
                // 当天的客户（2026/01/20）
                { id: 1, name: '王经理(王宇)', platform: '百度地图开放平台', platformType: 'enterprise', avatar: '王', lastChatTime: '2026/01/20 14:23:00', todayCount: 30, totalCount: 286, type: '图片' },
                { id: 2, name: '张强刚', platform: '微信', platformType: 'wechat', avatar: '张', lastChatTime: '2026/01/20 09:20:00', todayCount: 14, totalCount: 323, type: '小程序' },
                { id: 3, name: '市场部对接(李嘉琪lily)', platform: '百度地图开放平台', platformType: 'enterprise', avatar: '李', lastChatTime: '2026/01/20 08:40:00', todayCount: 30, totalCount: 3221, type: '视频' },
                { id: 8, name: '陈总', platform: '微信', platformType: 'wechat', avatar: '陈', lastChatTime: '2026/01/20 16:30:00', todayCount: 8, totalCount: 156, type: '文本' },
                { id: 9, name: '刘经理', platform: '百度地图开放平台', platformType: 'enterprise', avatar: '刘', lastChatTime: '2026/01/20 15:45:00', todayCount: 12, totalCount: 234, type: '图片' },
                { id: 10, name: '张总', platform: '微信', platformType: 'wechat', avatar: '张', lastChatTime: '2026/01/20 13:20:00', todayCount: 5, totalCount: 189, type: '文本' },
                // 本年的客户（2026年，非当天）
                { id: 4, name: '李鸣宇', platform: '百度地图开放平台', platformType: 'enterprise', avatar: '李', lastChatTime: '2026/01/19 10:15:00', todayCount: 0, totalCount: 473, type: '转发消息' },
                { id: 5, name: '童许', platform: '百度地图开放平台', platformType: 'enterprise', avatar: '童', lastChatTime: '2026/01/18 09:30:00', todayCount: 0, totalCount: 999, type: '文本' },
                { id: 6, name: '杨浩然', platform: '微信', platformType: 'wechat', avatar: '杨', lastChatTime: '2026/01/15 16:20:00', todayCount: 0, totalCount: 218, type: '红包' },
                { id: 7, name: '杨思域', platform: '微信', platformType: 'wechat', avatar: '杨', lastChatTime: '2026/01/10 14:10:00', todayCount: 0, totalCount: 512, type: '语音' },
                // 非本年的客户（2025年或更早）
                { id: 11, name: '赵总', platform: '微信', platformType: 'wechat', avatar: '赵', lastChatTime: '2025/12/20 15:30:00', todayCount: 0, totalCount: 345, type: '文本' },
                { id: 12, name: '钱经理', platform: '百度地图开放平台', platformType: 'enterprise', avatar: '钱', lastChatTime: '2025/11/15 11:20:00', todayCount: 0, totalCount: 567, type: '图片' },
                { id: 13, name: '孙总', platform: '微信', platformType: 'wechat', avatar: '孙', lastChatTime: '2025/10/08 14:15:00', todayCount: 0, totalCount: 234, type: '语音' }
            ];

            // 模拟群聊数据
            const groupChats = [
                // 当天的群聊（2026/01/20）
                { id: 1, name: '客户服务群', avatar: '群', lastChatTime: '2026/01/20 14:30:00', todayCount: 45, totalCount: 1234, memberCount: 25, groupType: 'external' },
                { id: 2, name: '销售部工作群', avatar: '销', lastChatTime: '2026/01/20 13:15:00', todayCount: 32, totalCount: 856, memberCount: 18, groupType: 'internal' },
                { id: 3, name: '产品讨论组', avatar: '产', lastChatTime: '2026/01/20 12:00:00', todayCount: 28, totalCount: 567, memberCount: 12, groupType: 'internal' },
                // 本年的群聊（2026年，非当天）
                { id: 4, name: '技术交流群', avatar: '技', lastChatTime: '2026/01/19 18:20:00', todayCount: 0, totalCount: 345, memberCount: 15, groupType: 'internal' },
                { id: 5, name: '市场推广群', avatar: '市', lastChatTime: '2026/01/18 16:45:00', todayCount: 0, totalCount: 678, memberCount: 20, groupType: 'external' },
                { id: 6, name: '运营协作群', avatar: '运', lastChatTime: '2026/01/15 10:30:00', todayCount: 0, totalCount: 432, memberCount: 14, groupType: 'internal' },
                { id: 7, name: '客服支持群', avatar: '客', lastChatTime: '2026/01/10 15:20:00', todayCount: 0, totalCount: 789, memberCount: 22, groupType: 'external' },
                // 非本年的群聊（2025年或更早）
                { id: 8, name: '项目管理群', avatar: '项', lastChatTime: '2025/12/20 11:10:00', todayCount: 0, totalCount: 234, memberCount: 10, groupType: 'internal' },
                { id: 9, name: '设计讨论群', avatar: '设', lastChatTime: '2025/11/15 14:25:00', todayCount: 0, totalCount: 456, memberCount: 16, groupType: 'internal' },
                { id: 10, name: '客户反馈群', avatar: '反', lastChatTime: '2025/10/08 09:40:00', todayCount: 0, totalCount: 321, memberCount: 12, groupType: 'external' }
            ];

            // 模拟员工数据（用于员工Tab）
            const employeeContacts = [
                // 当天的员工（2026/01/20）
                { id: 1, name: '张明', department: '技术部', avatar: '张', lastChatTime: '2026/01/20 15:30:00', todayCount: 18, totalCount: 456 },
                { id: 2, name: '刘芳', department: '市场部', avatar: '刘', lastChatTime: '2026/01/20 13:45:00', todayCount: 25, totalCount: 789 },
                { id: 3, name: '陈强', department: '运营部', avatar: '陈', lastChatTime: '2026/01/20 12:20:00', todayCount: 12, totalCount: 345 },
                { id: 4, name: '赵敏', department: '产品部', avatar: '赵', lastChatTime: '2026/01/20 11:10:00', todayCount: 7, totalCount: 234 },
                { id: 5, name: '孙丽', department: '设计部', avatar: '孙', lastChatTime: '2026/01/20 10:30:00', todayCount: 20, totalCount: 567 },
                // 本年的员工（2026年，非当天）
                { id: 6, name: '吴刚', department: '研发部', avatar: '吴', lastChatTime: '2026/01/19 17:30:00', todayCount: 0, totalCount: 432 },
                { id: 7, name: '郑华', department: '测试部', avatar: '郑', lastChatTime: '2026/01/18 16:15:00', todayCount: 0, totalCount: 321 },
                { id: 8, name: '周涛', department: '客服部', avatar: '周', lastChatTime: '2026/01/15 15:00:00', todayCount: 0, totalCount: 543 },
                // 非本年的员工（2025年或更早）
                { id: 9, name: '钱伟', department: '销售部', avatar: '钱', lastChatTime: '2025/12/20 14:30:00', todayCount: 0, totalCount: 654 },
                { id: 10, name: '吴静', department: '人事部', avatar: '吴', lastChatTime: '2025/11/15 11:20:00', todayCount: 0, totalCount: 234 }
            ];

            // 根据Tab过滤数据
            const getFilteredData = () => {
                let data = [];
                let keyword = contactSearchKeyword.toLowerCase();
                
                if (activeTab === '客户') {
                    data = customers.filter(item => 
                        item.name.toLowerCase().includes(keyword) || 
                        item.platform.toLowerCase().includes(keyword)
                    );
                } else if (activeTab === '群聊') {
                    data = groupChats.filter(item => 
                        item.name.toLowerCase().includes(keyword)
                    );
                } else if (activeTab === '员工') {
                    data = employeeContacts.filter(item => 
                        item.name.toLowerCase().includes(keyword) ||
                        item.department.toLowerCase().includes(keyword)
                    );
                }
                
                // 按时间排序
                return data.sort((a, b) => {
                    const timeA = new Date(a.lastChatTime.replace(/\//g, '-'));
                    const timeB = new Date(b.lastChatTime.replace(/\//g, '-'));
                    return timeB - timeA;
                });
            };

            const filteredData = getFilteredData();

            // 获取搜索框提示文本
            const getSearchPlaceholder = () => {
                if (activeTab === '客户') return '搜索客户';
                if (activeTab === '群聊') return '搜索群聊';
                if (activeTab === '员工') return '搜索员工';
                return '搜索';
            };

            return (
                <div style={{ display: 'flex', height: 'calc(100vh - 80px)', gap: '0', backgroundColor: '#f5f5f5', overflow: 'hidden', marginBottom: 0, paddingBottom: 0 }}>
                    {/* 第1栏：员工列表 */}
                    <div style={{ 
                        width: '280px', 
                        backgroundColor: '#fff', 
                        borderRight: '1px solid #e0e0e0',
                        display: 'flex',
                        flexDirection: 'column',
                        height: '100%'
                    }}>
                        {/* 企业信息头部 */}
                        <div style={{ padding: '16px', borderBottom: '1px solid #e0e0e0', position: 'relative' }}>
                            <div style={{ fontSize: '16px', fontWeight: 600, color: '#262626', marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                                <img 
                                    src="https://upload.wikimedia.org/wikipedia/commons/2/29/Baidu_Logo.svg" 
                                    alt="百度Logo" 
                                    style={{ 
                                        height: '24px', 
                                        width: 'auto',
                                        flexShrink: 0,
                                        objectFit: 'contain'
                                    }}
                                    onError={(e) => {
                                        // 如果SVG加载失败，尝试使用PNG格式
                                        e.target.src = 'https://www.baidu.com/img/flexible/logo/pc/result.png';
                                    }}
                                />
                                百度地图开放平台
                            </div>
                            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '12px' }}>
                                <span style={{ fontSize: '14px', color: '#8c8c8c' }}>
                                    会话存档员工人数 {activeEmployeeCount}
                                </span>
                                <button
                                    onClick={handleRefresh}
                                    style={{
                                        background: 'none',
                                        border: 'none',
                                        cursor: 'pointer',
                                        padding: '4px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        color: '#666'
                                    }}
                                    title="刷新"
                                >
                                    <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>
                                </button>
                            </div>
                            {/* 搜索框和部门筛选按钮 */}
                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                <Input
                                    placeholder="搜索员工姓名"
                                    prefix={<i data-lucide="search" style={{ width: '14px', height: '14px', color: '#999' }}></i>}
                                    value={employeeSearchKeyword}
                                    onChange={(e) => setEmployeeSearchKeyword(e.target.value)}
                                    style={{ flex: 1 }}
                                />
                                <button
                                    onClick={() => setDepartmentFilterVisible(true)}
                                    style={{
                                        width: '32px',
                                        height: '32px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        border: '1px solid #d9d9d9',
                                        borderRadius: '4px',
                                        backgroundColor: selectedDepartments.length > 0 ? '#e6f7ff' : '#fff',
                                        cursor: 'pointer',
                                        transition: 'all 0.2s',
                                        flexShrink: 0
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.borderColor = '#1890ff';
                                        e.currentTarget.style.backgroundColor = selectedDepartments.length > 0 ? '#bae7ff' : '#f0f7ff';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.borderColor = '#d9d9d9';
                                        e.currentTarget.style.backgroundColor = selectedDepartments.length > 0 ? '#e6f7ff' : '#fff';
                                    }}
                                    title="筛选部门"
                                >
                                    <i data-lucide="filter" style={{ width: '16px', height: '16px', color: selectedDepartments.length > 0 ? '#1890ff' : '#666' }}></i>
                                </button>
                            </div>
                            {/* 部门筛选弹窗 */}
                            {departmentFilterVisible && (
                                <div 
                                    className="department-filter-container"
                                    style={{
                                        position: 'absolute',
                                        top: '100%',
                                        left: '16px',
                                        right: '16px',
                                        marginTop: '8px',
                                        backgroundColor: '#fff',
                                        border: '1px solid #e0e0e0',
                                        borderRadius: '4px',
                                        boxShadow: '0 4px 12px rgba(0,0,0,0.15)',
                                        zIndex: 1000,
                                        padding: '16px',
                                        maxHeight: '400px',
                                        overflowY: 'auto'
                                    }}
                                    onClick={(e) => e.stopPropagation()}
                                >
                                    <div style={{ marginBottom: '12px', fontSize: '14px', fontWeight: 500, color: '#262626' }}>
                                        选择部门
                                    </div>
                                    <TreeSelect
                                        treeData={orgTreeData}
                                        value={selectedDepartments}
                                        onChange={(value) => setSelectedDepartments(value)}
                                        placeholder="请选择部门"
                                        multiple
                                        treeCheckable
                                        showCheckedStrategy={TreeSelect.SHOW_PARENT}
                                        style={{ width: '100%', marginBottom: '12px' }}
                                    />
                                    <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '8px' }}>
                                        <Button
                                            size="small"
                                            onClick={() => {
                                                setSelectedDepartments([]);
                                            }}
                                        >
                                            重置
                                        </Button>
                                        <Button
                                            type="primary"
                                            size="small"
                                            onClick={() => {
                                                setDepartmentFilterVisible(false);
                                            }}
                                        >
                                            确定
                                        </Button>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* 员工列表 */}
                        <div 
                            className="employee-list-scroll"
                            style={{ 
                                flex: 1, 
                                overflowY: 'auto',
                                padding: '8px 0'
                            }}
                        >
                            {sortedEmployees.map((employee, index) => (
                                <div
                                    key={employee.id}
                                    onClick={() => setSelectedEmployee(employee)}
                                    style={{
                                        padding: '12px 16px',
                                        cursor: 'pointer',
                                        borderBottom: '1px solid #f0f0f0',
                                        backgroundColor: selectedEmployee?.id === employee.id ? '#f0f7ff' : '#fff',
                                        transition: 'background-color 0.2s'
                                    }}
                                    onMouseEnter={(e) => {
                                        if (selectedEmployee?.id !== employee.id) {
                                            e.currentTarget.style.backgroundColor = '#fafafa';
                                        }
                                    }}
                                    onMouseLeave={(e) => {
                                        if (selectedEmployee?.id !== employee.id) {
                                            e.currentTarget.style.backgroundColor = '#fff';
                                        }
                                    }}
                                >
                                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                        {/* 员工头像 */}
                                        <div style={{
                                            width: '40px',
                                            height: '40px',
                                            borderRadius: '4px',
                                            backgroundColor: '#1890ff',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            color: '#fff',
                                            fontSize: '16px',
                                            fontWeight: 'bold',
                                            flexShrink: 0
                                        }}>
                                            {employee.avatar}
                                        </div>
                                        {/* 员工信息 */}
                                        <div style={{ flex: 1, minWidth: 0 }}>
                                            <div style={{ 
                                                display: 'flex', 
                                                alignItems: 'center', 
                                                justifyContent: 'space-between',
                                                marginBottom: '4px',
                                                gap: '8px'
                                            }}>
                                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px', flex: 1, minWidth: 0 }}>
                                                    <span style={{ 
                                                        fontSize: '14px', 
                                                        fontWeight: 500, 
                                                        color: '#262626',
                                                        overflow: 'hidden',
                                                        textOverflow: 'ellipsis',
                                                        whiteSpace: 'nowrap'
                                                    }}>
                                                        {employee.name}
                                                    </span>
                                                    {employee.isExpired && (
                                                        <span style={{
                                                            fontSize: '11px',
                                                            color: '#ff4d4f',
                                                            backgroundColor: '#fff1f0',
                                                            border: '1px solid #ffccc7',
                                                            padding: '2px 6px',
                                                            borderRadius: '4px',
                                                            flexShrink: 0,
                                                            lineHeight: '16px',
                                                            display: 'inline-block',
                                                            fontWeight: 400
                                                        }}>
                                                            已失效
                                                        </span>
                                                    )}
                                                </div>
                                                <span style={{ 
                                                    fontSize: '12px', 
                                                    color: '#8c8c8c',
                                                    flexShrink: 0
                                                }}>
                                                    {formatTime(employee.lastChatTime, index < 3)}
                                                </span>
                                            </div>
                                            <div style={{ fontSize: '12px', color: '#8c8c8c' }}>
                                                [今日{employee.todayCount}条][总数{employee.totalCount}条]
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* 第2栏：客户/群聊列表 */}
                    {selectedEmployee ? (
                        <div style={{ 
                            width: '320px', 
                            backgroundColor: '#fff', 
                            borderRight: '1px solid #e0e0e0',
                            display: 'flex',
                            flexDirection: 'column',
                            height: '100%'
                        }}>
                            {/* 选中员工信息 */}
                            <div style={{ padding: '16px', borderBottom: '1px solid #e0e0e0', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                    <div style={{
                                        width: '40px',
                                        height: '40px',
                                        borderRadius: '4px',
                                        backgroundColor: '#1890ff',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        color: '#fff',
                                        fontSize: '16px',
                                        fontWeight: 'bold',
                                        flexShrink: 0
                                    }}>
                                        {selectedEmployee.avatar}
                                    </div>
                                    <div style={{ fontSize: '14px', fontWeight: 500, color: '#262626' }}>
                                        {selectedEmployee.name}
                                    </div>
                                </div>
                                <button
                                    onClick={handleRefresh}
                                    style={{
                                        background: 'none',
                                        border: 'none',
                                        cursor: 'pointer',
                                        padding: '4px',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        color: '#666'
                                    }}
                                    title="刷新"
                                >
                                    <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>
                                </button>
                            </div>

                            {/* Tab页签 */}
                            <div style={{ padding: '12px 16px 0', borderBottom: '1px solid #e0e0e0' }}>
                                <div style={{ display: 'flex', gap: '0' }}>
                                    {['客户', '群聊', '员工'].map(tab => (
                                        <div
                                            key={tab}
                                            onClick={() => {
                                                setActiveTab(tab);
                                                setContactSearchKeyword('');
                                                setSelectedContact(null); // 切换tab时清空选中的联系人
                                            }}
                                            style={{
                                                padding: '8px 16px',
                                                cursor: 'pointer',
                                                borderBottom: activeTab === tab ? '2px solid #1890ff' : '2px solid transparent',
                                                color: activeTab === tab ? '#1890ff' : '#666',
                                                fontSize: '14px',
                                                fontWeight: activeTab === tab ? 500 : 400,
                                                transition: 'all 0.2s'
                                            }}
                                        >
                                            {tab}
                                        </div>
                                    ))}
                                </div>
                            </div>

                            {/* 搜索框 */}
                            <div style={{ padding: '12px 16px', borderBottom: '1px solid #e0e0e0' }}>
                                <Input
                                    placeholder={getSearchPlaceholder()}
                                    prefix={<i data-lucide="search" style={{ width: '14px', height: '14px', color: '#999' }}></i>}
                                    value={contactSearchKeyword}
                                    onChange={(e) => setContactSearchKeyword(e.target.value)}
                                    style={{ width: '100%' }}
                                />
                            </div>

                            {/* 列表内容 */}
                            <div 
                                className="employee-list-scroll"
                                style={{ 
                                    flex: 1, 
                                    overflowY: 'auto',
                                    padding: '8px 0'
                                }}
                            >
                                {filteredData.length === 0 ? (
                                    <div style={{ padding: '40px 16px', textAlign: 'center', color: '#8c8c8c', fontSize: '14px' }}>
                                        暂无数据
                                    </div>
                                ) : (
                                    filteredData.map((item, index) => {
                                        if (activeTab === '客户') {
                                            return (
                                                <div
                                                    key={item.id}
                                                    onClick={() => setSelectedContact(item)}
                                                    style={{
                                                        padding: '12px 16px',
                                                        cursor: 'pointer',
                                                        borderBottom: '1px solid #f0f0f0',
                                                        backgroundColor: selectedContact?.id === item.id ? '#f0f7ff' : '#fff',
                                                        transition: 'background-color 0.2s'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        if (selectedContact?.id !== item.id) {
                                                            e.currentTarget.style.backgroundColor = '#fafafa';
                                                        }
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        if (selectedContact?.id !== item.id) {
                                                            e.currentTarget.style.backgroundColor = '#fff';
                                                        }
                                                    }}
                                                >
                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                                        {/* 客户头像 */}
                                                        <div style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            borderRadius: '4px',
                                                            backgroundColor: '#1890ff',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            color: '#fff',
                                                            fontSize: '16px',
                                                            fontWeight: 'bold',
                                                            flexShrink: 0
                                                        }}>
                                                            {item.avatar}
                                                        </div>
                                                        {/* 客户信息 */}
                                                        <div style={{ flex: 1, minWidth: 0 }}>
                                                            <div style={{ 
                                                                display: 'flex', 
                                                                alignItems: 'center', 
                                                                justifyContent: 'space-between',
                                                                marginBottom: '4px',
                                                                gap: '8px'
                                                            }}>
                                                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px', flex: 1, minWidth: 0 }}>
                                                                    <span style={{ 
                                                                        fontSize: '14px', 
                                                                        fontWeight: 500, 
                                                                        color: '#262626',
                                                                        overflow: 'hidden',
                                                                        textOverflow: 'ellipsis',
                                                                        whiteSpace: 'nowrap'
                                                                    }}>
                                                                        {item.name}
                                                                    </span>
                                                                    <span style={{
                                                                        fontSize: '12px',
                                                                        color: item.platformType === 'wechat' ? '#52c41a' : '#ff9800',
                                                                        flexShrink: 0
                                                                    }}>
                                                                        @{item.platform}
                                                                    </span>
                                                                </div>
                                                                <span style={{ 
                                                                    fontSize: '12px', 
                                                                    color: '#8c8c8c',
                                                                    flexShrink: 0
                                                                }}>
                                                                    {formatTime(item.lastChatTime, index < 3)}
                                                                </span>
                                                            </div>
                                                            <div style={{ fontSize: '12px', color: '#8c8c8c' }}>
                                                                [今日{item.todayCount}条][总数{item.totalCount}条]
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        } else if (activeTab === '群聊') {
                                            return (
                                                <div
                                                    key={item.id}
                                                    onClick={() => setSelectedContact(item)}
                                                    style={{
                                                        padding: '12px 16px',
                                                        cursor: 'pointer',
                                                        borderBottom: '1px solid #f0f0f0',
                                                        backgroundColor: selectedContact?.id === item.id ? '#f0f7ff' : '#fff',
                                                        transition: 'background-color 0.2s'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        if (selectedContact?.id !== item.id) {
                                                            e.currentTarget.style.backgroundColor = '#fafafa';
                                                        }
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        if (selectedContact?.id !== item.id) {
                                                            e.currentTarget.style.backgroundColor = '#fff';
                                                        }
                                                    }}
                                                >
                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                                        {/* 群聊头像 */}
                                                        <div style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            borderRadius: '4px',
                                                            backgroundColor: '#722ed1',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            color: '#fff',
                                                            fontSize: '16px',
                                                            fontWeight: 'bold',
                                                            flexShrink: 0
                                                        }}>
                                                            {item.avatar}
                                                        </div>
                                                        {/* 群聊信息 */}
                                                        <div style={{ flex: 1, minWidth: 0 }}>
                                                            <div style={{ 
                                                                display: 'flex', 
                                                                alignItems: 'center', 
                                                                justifyContent: 'space-between',
                                                                marginBottom: '4px',
                                                                gap: '8px'
                                                            }}>
                                                                <div style={{ 
                                                                    display: 'flex', 
                                                                    alignItems: 'center', 
                                                                    gap: '6px',
                                                                    flex: 1,
                                                                    minWidth: 0
                                                                }}>
                                                                    <span style={{ 
                                                                        fontSize: '14px', 
                                                                        fontWeight: 500, 
                                                                        color: '#262626',
                                                                        overflow: 'hidden',
                                                                        textOverflow: 'ellipsis',
                                                                        whiteSpace: 'nowrap',
                                                                        flexShrink: 0
                                                                    }}>
                                                                        {item.name}
                                                                    </span>
                                                                    {/* 群聊类型标签 */}
                                                                    <span style={{
                                                                        fontSize: '11px',
                                                                        color: item.groupType === 'internal' ? '#52c41a' : '#ff9800',
                                                                        backgroundColor: item.groupType === 'internal' ? '#f6ffed' : '#fff7e6',
                                                                        padding: '2px 6px',
                                                                        borderRadius: '2px',
                                                                        border: item.groupType === 'internal' ? '1px solid #b7eb8f' : '1px solid #ffd591',
                                                                        flexShrink: 0,
                                                                        whiteSpace: 'nowrap'
                                                                    }}>
                                                                        {item.groupType === 'internal' ? '内部群' : '外部群'}
                                                                    </span>
                                                                </div>
                                                                <span style={{ 
                                                                    fontSize: '12px', 
                                                                    color: '#8c8c8c',
                                                                    flexShrink: 0
                                                                }}>
                                                                    {formatTime(item.lastChatTime, index < 3)}
                                                                </span>
                                                            </div>
                                                            <div style={{ fontSize: '12px', color: '#8c8c8c' }}>
                                                                [今日{item.todayCount}条][总数{item.totalCount}条]
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        } else if (activeTab === '员工') {
                                            return (
                                                <div
                                                    key={item.id}
                                                    onClick={() => setSelectedContact(item)}
                                                    style={{
                                                        padding: '12px 16px',
                                                        cursor: 'pointer',
                                                        borderBottom: '1px solid #f0f0f0',
                                                        backgroundColor: selectedContact?.id === item.id ? '#f0f7ff' : '#fff',
                                                        transition: 'background-color 0.2s'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        if (selectedContact?.id !== item.id) {
                                                            e.currentTarget.style.backgroundColor = '#fafafa';
                                                        }
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        if (selectedContact?.id !== item.id) {
                                                            e.currentTarget.style.backgroundColor = '#fff';
                                                        }
                                                    }}
                                                >
                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                                        {/* 员工头像 */}
                                                        <div style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            borderRadius: '4px',
                                                            backgroundColor: '#1890ff',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            color: '#fff',
                                                            fontSize: '16px',
                                                            fontWeight: 'bold',
                                                            flexShrink: 0
                                                        }}>
                                                            {item.avatar}
                                                        </div>
                                                        {/* 员工信息 */}
                                                        <div style={{ flex: 1, minWidth: 0 }}>
                                                            <div style={{ 
                                                                display: 'flex', 
                                                                alignItems: 'center', 
                                                                justifyContent: 'space-between',
                                                                marginBottom: '4px',
                                                                gap: '8px'
                                                            }}>
                                                                <span style={{ 
                                                                    fontSize: '14px', 
                                                                    fontWeight: 500, 
                                                                    color: '#262626',
                                                                    overflow: 'hidden',
                                                                    textOverflow: 'ellipsis',
                                                                    whiteSpace: 'nowrap',
                                                                    flex: 1
                                                                }}>
                                                                    {item.name}
                                                                </span>
                                                                <span style={{ 
                                                                    fontSize: '12px', 
                                                                    color: '#8c8c8c',
                                                                    flexShrink: 0
                                                                }}>
                                                                    {formatTime(item.lastChatTime, index < 3)}
                                                                </span>
                                                            </div>
                                                            <div style={{ fontSize: '12px', color: '#8c8c8c' }}>
                                                                [今日{item.todayCount}条][总数{item.totalCount}条]
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        }
                                        return null;
                                    })
                                )}
                            </div>
                        </div>
                    ) : (
                        <div style={{ 
                            width: '320px', 
                            backgroundColor: '#fff', 
                            borderRight: '1px solid #e0e0e0',
                            display: 'flex',
                            flexDirection: 'column',
                            height: '100%',
                            alignItems: 'center',
                            justifyContent: 'center',
                            color: '#8c8c8c',
                            fontSize: '14px'
                        }}>
                            请先选择员工
                        </div>
                    )}

                    {/* 第3栏：聊天详情 */}
                    {selectedContact ? (
                        <div style={{ 
                            flex: 1, 
                            backgroundColor: '#fff',
                            display: 'flex',
                            flexDirection: 'column',
                            height: '100%'
                        }}>
                            {/* 顶部栏 */}
                            <div style={{ 
                                padding: '12px 16px', 
                                borderBottom: '1px solid #e0e0e0',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'space-between',
                                gap: '12px',
                                flexWrap: 'wrap',
                                flexShrink: 0
                            }}>
                                {/* 左侧：消息类型下拉选择框和日期范围选择 */}
                                <div style={{ display: 'flex', alignItems: 'center', gap: '12px', flexWrap: 'wrap', flex: 1, minWidth: 0 }}>
                                    <Select
                                        value={messageTypeFilter}
                                        onChange={(value) => setMessageTypeFilter(value)}
                                        style={{ width: 150, maxWidth: '100%' }}
                                        size="small"
                                    >
                                        <Select.Option value="全部">全部</Select.Option>
                                        <Select.Option value="文本">文本</Select.Option>
                                        <Select.Option value="表情">表情</Select.Option>
                                        <Select.Option value="语音">语音</Select.Option>
                                        <Select.Option value="图片">图片</Select.Option>
                                        <Select.Option value="视频">视频</Select.Option>
                                        <Select.Option value="文件">文件</Select.Option>
                                        <Select.Option value="链接">链接</Select.Option>
                                        <Select.Option value="红包">红包</Select.Option>
                                        <Select.Option value="名片">名片</Select.Option>
                                        <Select.Option value="位置">位置</Select.Option>
                                        <Select.Option value="小程序消息">小程序消息</Select.Option>
                                        <Select.Option value="撤回消息">撤回消息</Select.Option>
                                    </Select>
                                    
                                    <RangePicker
                                        value={dateRangeFilter}
                                        onChange={(dates) => setDateRangeFilter(dates)}
                                        showTime={{ format: 'HH:mm:ss' }}
                                        format="YYYY/MM/DD HH:mm:ss"
                                        placeholder={['开始日期', '结束日期']}
                                        style={{ width: 360, maxWidth: '100%' }}
                                        size="small"
                                    />
                                </div>

                                {/* 右侧：搜索框 */}
                                <div style={{ flex: '0 1 auto', minWidth: 0 }}>
                                    <ChatSearchBox 
                                        searchKeyword={chatSearchKeyword}
                                        setSearchKeyword={setChatSearchKeyword}
                                        matchCount={chatMatchCount}
                                        setMatchCount={setChatMatchCount}
                                        currentMatchIndex={chatCurrentMatchIndex}
                                        setCurrentMatchIndex={setChatCurrentMatchIndex}
                                        matchRefs={chatMatchRefs}
                                        setMatchRefs={setChatMatchRefs}
                                        containerSelector=".chat-detail-container"
                                    />
                                </div>
                            </div>

                            {/* 聊天内容区域 */}
                            <ChatContent 
                                selectedContact={selectedContact}
                                selectedEmployee={selectedEmployee}
                                messageTypeFilter={messageTypeFilter}
                                dateRangeFilter={dateRangeFilter}
                            />
                        </div>
                    ) : (
                        <div style={{ 
                            flex: 1, 
                            backgroundColor: '#fff',
                            display: 'flex',
                            flexDirection: 'column',
                            height: '100%',
                            alignItems: 'center',
                            justifyContent: 'center',
                            color: '#8c8c8c',
                            fontSize: '14px'
                        }}>
                            请先选择客户/群聊/员工
                        </div>
                    )}
                </div>
            );
        };

        // 全局搜索组件
        const GlobalSearch = () => {
            const [form] = Form.useForm();
            const [drawerVisible, setDrawerVisible] = useState(false);
            const [selectedRecord, setSelectedRecord] = useState(null);
            const [messageTypeFilter, setMessageTypeFilter] = useState('全部'); // 消息类型筛选
            const [dateRangeFilter, setDateRangeFilter] = useState(null); // 日期范围筛选
            const [chatSearchKeyword, setChatSearchKeyword] = useState(''); // 聊天记录搜索关键词
            const [chatMatchCount, setChatMatchCount] = useState(0);
            const [chatCurrentMatchIndex, setChatCurrentMatchIndex] = useState(0);
            const [chatMatchRefs, setChatMatchRefs] = useState([]);
            
            // 获取当前时间
            const getCurrentTime = () => {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
            };

            const [refreshTime, setRefreshTime] = useState(getCurrentTime());

            const handleRefresh = () => {
                setRefreshTime(getCurrentTime());
                setTimeout(() => {
                    if (window.lucide) {
                        window.lucide.createIcons();
                    }
                }, 100);
            };

            const [tableData, setTableData] = useState([
                {
                    key: '1',
                    content: '您好，请问这个产品的价格是多少？😊',
                    sender: 'Weeki Tian',
                    receiver: '王总',
                    receiverType: '单聊',
                    status: '已发送',
                    sendTime: '2026/01/19 14:32:15'
                },
                {
                    key: '2',
                    content: '好的，我马上安排发货',
                    sender: '李华',
                    receiver: '张明',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/19 13:25:42'
                },
                {
                    key: '3',
                    content: '这个方案需要再讨论一下',
                    sender: 'LiMing',
                    receiver: '刘经理',
                    receiverType: '单聊',
                    status: '已撤回',
                    sendTime: '2026/01/19 12:18:30'
                },
                {
                    key: '4',
                    content: '会议时间定在明天下午3点，请大家准时参加 👍',
                    sender: '赵强',
                    receiver: '项目组',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/19 11:45:20'
                },
                {
                    key: '5',
                    content: '收到，我会准时参加',
                    sender: '孙丽',
                    receiver: '项目组',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/19 11:46:05'
                },
                {
                    key: '6',
                    content: '合同已经发到您的邮箱了，请查收',
                    sender: '周伟',
                    receiver: '陈总',
                    receiverType: '单聊',
                    status: '已发送',
                    sendTime: '2026/01/19 10:30:12'
                },
                {
                    key: '7',
                    content: '好的，我看看',
                    sender: '吴敏',
                    receiver: '王芳',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/19 09:15:33'
                },
                {
                    key: '8',
                    content: '这个问题我需要再确认一下',
                    sender: 'Weeki Tian',
                    receiver: '张经理',
                    receiverType: '单聊',
                    status: '已撤回',
                    sendTime: '2026/01/18 16:22:45'
                },
                {
                    key: '9',
                    content: '产品已经上线了，大家可以开始推广了 🎉',
                    sender: '刘经理',
                    receiver: '产品发布群',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 15:10:30'
                },
                {
                    key: '10',
                    content: '收到，马上开始准备推广素材',
                    sender: 'LiMing',
                    receiver: '产品发布群',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 15:12:18'
                },
                {
                    key: '11',
                    content: '客户反馈说价格有点高，我们需要调整一下策略',
                    sender: '张明',
                    receiver: '销售策略讨论组',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 14:35:22'
                },
                {
                    key: '12',
                    content: '我同意，可以给老客户一些优惠',
                    sender: '李华',
                    receiver: '销售策略讨论组',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 14:36:45'
                },
                {
                    key: '13',
                    content: '明天上午10点有个重要会议，请大家准时参加',
                    sender: '陈总',
                    receiver: '管理层',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 13:20:10'
                },
                {
                    key: '14',
                    content: '好的，我会准时参加',
                    sender: '王芳',
                    receiver: '管理层',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 13:21:05'
                },
                {
                    key: '15',
                    content: '这个月的业绩目标已经完成了80%，大家继续加油 💪',
                    sender: '赵强',
                    receiver: '销售一部',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 12:15:33'
                },
                {
                    key: '16',
                    content: '客户对我们的服务很满意，已经续约了',
                    sender: '孙丽',
                    receiver: '李总',
                    receiverType: '单聊',
                    status: '已发送',
                    sendTime: '2026/01/18 11:45:20'
                },
                {
                    key: '17',
                    content: '太好了，继续保持',
                    sender: '周伟',
                    receiver: '孙丽',
                    receiverType: '单聊',
                    status: '已发送',
                    sendTime: '2026/01/18 11:46:10'
                },
                {
                    key: '18',
                    content: '新客户咨询了我们的产品，需要技术支持',
                    sender: '吴敏',
                    receiver: '技术支援群',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 10:30:15'
                },
                {
                    key: '19',
                    content: '我来处理，稍后联系客户',
                    sender: '郑涛',
                    receiver: '技术支援群',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 10:32:28'
                },
                {
                    key: '20',
                    content: '合同条款需要修改，我已经发邮件给您了',
                    sender: '刘经理',
                    receiver: '法务部',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 09:25:40'
                },
                {
                    key: '21',
                    content: '收到，我会尽快审核',
                    sender: 'Weeki Tian',
                    receiver: '法务部',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/18 09:26:15'
                },
                {
                    key: '22',
                    content: '这个功能需要优化一下用户体验',
                    sender: '李华',
                    receiver: '产品经理',
                    receiverType: '单聊',
                    status: '已发送',
                    sendTime: '2026/01/17 17:40:22'
                },
                {
                    key: '23',
                    content: '好的，我会安排开发团队处理',
                    sender: '王芳',
                    receiver: '李华',
                    receiverType: '单聊',
                    status: '已发送',
                    sendTime: '2026/01/17 17:42:10'
                },
                {
                    key: '24',
                    content: '下周的培训会议改到周三下午2点',
                    sender: '赵强',
                    receiver: '培训通知群',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/17 16:20:35'
                },
                {
                    key: '25',
                    content: '收到通知',
                    sender: 'LiMing',
                    receiver: '培训通知群',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/17 16:21:12'
                },
                {
                    key: '26',
                    content: '客户要求增加一些功能，需要评估一下工作量',
                    sender: '周伟',
                    receiver: '项目评估组',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/17 15:10:45'
                },
                {
                    key: '27',
                    content: '我来评估，明天给出结果',
                    sender: '吴敏',
                    receiver: '项目评估组',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/17 15:12:30'
                },
                {
                    key: '28',
                    content: '这个月的报销单已经提交了，请审批',
                    sender: '郑涛',
                    receiver: '财务部',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/17 14:05:18'
                },
                {
                    key: '29',
                    content: '好的，我会尽快处理',
                    sender: '刘经理',
                    receiver: '财务部',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/17 14:06:05'
                },
                {
                    key: '30',
                    content: '客户对我们的方案很感兴趣，约了明天面谈',
                    sender: '张明',
                    receiver: '销售一部',
                    receiverType: '群聊',
                    status: '已发送',
                    sendTime: '2026/01/17 13:30:22'
                }
            ]);

            // 组织架构数据（多层级）
            const orgTreeData = [
                {
                    title: '销售部',
                    value: 'sales',
                    key: 'sales',
                    children: [
                        {
                            title: '销售一部',
                            value: 'sales_1',
                            key: 'sales_1',
                            children: [
                                { title: '张明', value: 'zhang_ming', key: 'zhang_ming' },
                                { title: '李华', value: 'li_hua', key: 'li_hua' },
                                { title: '王芳', value: 'wang_fang', key: 'wang_fang' }
                            ]
                        },
                        {
                            title: '销售二部',
                            value: 'sales_2',
                            key: 'sales_2',
                            children: [
                                { title: '赵强', value: 'zhao_qiang', key: 'zhao_qiang' },
                                { title: '孙丽', value: 'sun_li', key: 'sun_li' }
                            ]
                        }
                    ]
                },
                {
                    title: '市场部',
                    value: 'marketing',
                    key: 'marketing',
                    children: [
                        {
                            title: '市场推广组',
                            value: 'marketing_promo',
                            key: 'marketing_promo',
                            children: [
                                { title: '周伟', value: 'zhou_wei', key: 'zhou_wei' },
                                { title: '吴敏', value: 'wu_min', key: 'wu_min' }
                            ]
                        },
                        {
                            title: '品牌管理组',
                            value: 'marketing_brand',
                            key: 'marketing_brand',
                            children: [
                                { title: '郑涛', value: 'zheng_tao', key: 'zheng_tao' }
                            ]
                        }
                    ]
                },
                {
                    title: '技术部',
                    value: 'tech',
                    key: 'tech',
                    children: [
                        {
                            title: '研发组',
                            value: 'tech_dev',
                            key: 'tech_dev',
                            children: [
                                { title: '刘经理', value: 'liu_manager', key: 'liu_manager' },
                                { title: '陈总', value: 'chen_zong', key: 'chen_zong' }
                            ]
                        }
                    ]
                }
            ];

            const handleSearch = () => {
                form.validateFields(['chatContent']).then(() => {
                    const values = form.getFieldsValue();
                    // 这里可以添加实际的搜索逻辑
                    message.success('查询成功');
                }).catch(() => {
                    message.error('请填写聊天内容');
                });
            };

            const handleReset = () => {
                form.resetFields();
            };

            const columns = [
                {
                    title: '聊天内容',
                    dataIndex: 'content',
                    key: 'content',
                    width: 300,
                    render: (text) => <span style={{ wordBreak: 'break-word' }}>{text}</span>
                },
                {
                    title: '发送人',
                    dataIndex: 'sender',
                    key: 'sender',
                    width: 120
                },
                {
                    title: '接收方',
                    dataIndex: 'receiver',
                    key: 'receiver',
                    width: 150
                },
                {
                    title: '会话类型',
                    dataIndex: 'receiverType',
                    key: 'receiverType',
                    width: 100,
                    render: (type) => (
                        <Tag color={type === '单聊' ? 'blue' : 'green'}>
                            {type}
                        </Tag>
                    )
                },
                {
                    title: '消息状态',
                    dataIndex: 'status',
                    key: 'status',
                    width: 100,
                    render: (status) => (
                        <Tag color={status === '已发送' ? 'success' : 'default'}>
                            {status}
                        </Tag>
                    )
                },
                {
                    title: '发送时间',
                    dataIndex: 'sendTime',
                    key: 'sendTime',
                    width: 180
                },
                {
                    title: '操作',
                    key: 'action',
                    width: 100,
                    render: (_, record) => (
                        <a 
                            href="#" 
                            style={{ color: '#1890ff' }}
                            onClick={(e) => {
                                e.preventDefault();
                                setSelectedRecord(record);
                                setDrawerVisible(true);
                            }}
                        >
                            查看
                        </a>
                    )
                }
            ];

            // 确保图标在组件更新后重新渲染
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
                const timer = setInterval(() => {
                    if (window.lucide) {
                        window.lucide.createIcons();
                    }
                }, 500);
                return () => clearInterval(timer);
            }, []);

            return (
                <div className="content-card">
                    <h1 style={{ fontSize: '20px', fontWeight: 600, marginBottom: '2px', color: '#262626' }}>
                        全局搜索
                    </h1>
                    <p style={{ fontSize: '12px', color: '#8c8c8c', marginBottom: '6px' }}>
                        您可以在全局搜索中自由查询聊天关键字，并支持筛选查询出来的结果
                    </p>

                    {/* 筛选栏 */}
                    <div className="search-section">
                        <Form form={form} layout="inline" style={{ width: '100%' }}>
                            <div style={{ width: '100%', display: 'flex', flexWrap: 'wrap', gap: '12px', alignItems: 'flex-start' }}>
                                <Form.Item
                                    label="聊天内容"
                                    name="chatContent"
                                    rules={[{ required: true, message: '请输入聊天内容' }]}
                                    style={{ marginBottom: 0, flex: '1 1 200px', minWidth: '200px', maxWidth: '100%' }}
                                >
                                    <Input placeholder="请输入聊天内容" style={{ width: '100%' }} />
                                </Form.Item>

                                <Form.Item
                                    label="时间范围"
                                    name="dateRange"
                                    style={{ marginBottom: 0, flex: '0 1 auto' }}
                                >
                                    <RangePicker style={{ width: '240px', maxWidth: '100%' }} />
                                </Form.Item>

                                <Form.Item
                                    label="会话类型"
                                    name="chatType"
                                    initialValue="全部"
                                    style={{ marginBottom: 0, flex: '0 1 auto' }}
                                >
                                    <Select style={{ width: '120px' }}>
                                        <Option value="全部">全部</Option>
                                        <Option value="单聊">单聊</Option>
                                        <Option value="群聊">群聊</Option>
                                    </Select>
                                </Form.Item>

                                <Form.Item
                                    label="发送人"
                                    name="senders"
                                    style={{ marginBottom: 0, flex: '1 1 200px', minWidth: '200px', maxWidth: '100%' }}
                                >
                                    <TreeSelect
                                        treeData={orgTreeData}
                                        placeholder="请选择发送人"
                                        multiple
                                        treeCheckable
                                        showCheckedStrategy={TreeSelect.SHOW_CHILD}
                                        style={{ width: '100%' }}
                                    />
                                </Form.Item>

                                <Form.Item
                                    label="接收人"
                                    name="receivers"
                                    style={{ marginBottom: 0, flex: '1 1 200px', minWidth: '200px', maxWidth: '100%' }}
                                >
                                    <TreeSelect
                                        treeData={orgTreeData}
                                        placeholder="请选择接收人"
                                        multiple
                                        treeCheckable
                                        showCheckedStrategy={TreeSelect.SHOW_CHILD}
                                        style={{ width: '100%' }}
                                    />
                                </Form.Item>

                                <Form.Item style={{ marginBottom: 0, flex: '0 1 auto' }}>
                                    <Space>
                                        <Button onClick={handleReset}>重置</Button>
                                        <Button type="primary" onClick={handleSearch}>查询</Button>
                                    </Space>
                                </Form.Item>
                            </div>
                        </Form>
                    </div>

                    {/* 表格操作按钮区域 */}
                    <div className="table-actions">
                        <div className="table-actions-left">
                            {/* 这里可以放置左侧操作按钮，如新建、批量操作等 */}
                        </div>
                        <div className="table-actions-right">
                            <span>最近刷新时间: {refreshTime}</span>
                            <div className="icon-btn" onClick={handleRefresh}>
                                <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>
                            </div>
                            <div className="icon-btn">
                                <i data-lucide="info" style={{ width: '16px', height: '16px' }}></i>
                            </div>
                            <div className="icon-btn">
                                <i data-lucide="settings" style={{ width: '16px', height: '16px' }}></i>
                            </div>
                        </div>
                    </div>

                    {/* 数据列表 */}
                    <Table
                        columns={columns}
                        dataSource={tableData}
                        pagination={{
                            total: tableData.length,
                            pageSize: 10,
                            showSizeChanger: true,
                            showTotal: (total) => `共 ${total} 条`,
                            showQuickJumper: true
                        }}
                        scroll={{ y: 'calc(100vh - 320px)' }}
                    />

                    {/* 聊天详情抽屉 */}
                    <Drawer
                        title={
                            selectedRecord ? (
                                <div style={{
                                    display: 'flex',
                                    flexDirection: 'column',
                                    gap: '12px',
                                    width: '100%',
                                    paddingRight: '24px'
                                }}>
                                    <div style={{ fontSize: '16px', fontWeight: 500, marginBottom: '4px' }}>详情</div>
                                    {/* 筛选栏 - 消息类型、日期范围、搜索框在同一行 */}
                                    <div style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '12px',
                                        flexWrap: 'nowrap',
                                        overflow: 'hidden',
                                        width: '100%'
                                    }}>
                                        {/* 消息类型下拉选择框 */}
                                        <Select
                                            value={messageTypeFilter}
                                            onChange={(value) => setMessageTypeFilter(value)}
                                            style={{ width: 150, flexShrink: 0 }}
                                            size="small"
                                        >
                                            <Select.Option value="全部">全部</Select.Option>
                                            <Select.Option value="文本">文本</Select.Option>
                                            <Select.Option value="表情">表情</Select.Option>
                                            <Select.Option value="语音">语音</Select.Option>
                                            <Select.Option value="图片">图片</Select.Option>
                                            <Select.Option value="视频">视频</Select.Option>
                                            <Select.Option value="文件">文件</Select.Option>
                                            <Select.Option value="链接">链接</Select.Option>
                                            <Select.Option value="红包">红包</Select.Option>
                                            <Select.Option value="名片">名片</Select.Option>
                                            <Select.Option value="位置">位置</Select.Option>
                                            <Select.Option value="小程序消息">小程序消息</Select.Option>
                                            <Select.Option value="撤回消息">撤回消息</Select.Option>
                                        </Select>
                                        
                                        {/* 日期范围选择 */}
                                        <RangePicker
                                            value={dateRangeFilter}
                                            onChange={(dates) => setDateRangeFilter(dates)}
                                            showTime={{ format: 'HH:mm:ss' }}
                                            format="YYYY/MM/DD HH:mm:ss"
                                            placeholder={['开始日期', '结束日期']}
                                            style={{ width: 360, flexShrink: 0 }}
                                            size="small"
                                        />
                                        
                                        {/* 搜索框 */}
                                        <div style={{ flex: '1 1 auto', minWidth: 0, display: 'flex', alignItems: 'center', gap: '8px' }}>
                                            <ChatSearchBox 
                                                searchKeyword={chatSearchKeyword}
                                                setSearchKeyword={setChatSearchKeyword}
                                                matchCount={chatMatchCount}
                                                setMatchCount={setChatMatchCount}
                                                currentMatchIndex={chatCurrentMatchIndex}
                                                setCurrentMatchIndex={setChatCurrentMatchIndex}
                                                matchRefs={chatMatchRefs}
                                                setMatchRefs={setChatMatchRefs}
                                                containerSelector=".chat-detail-container"
                                            />
                                        </div>
                                    </div>
                                </div>
                            ) : '详情'
                        }
                        placement="right"
                        onClose={() => {
                            // 清除搜索高亮
                            const container = document.querySelector('.chat-detail-container');
                            if (container) {
                                container.querySelectorAll('.search-highlight').forEach(mark => {
                                    const parent = mark.parentNode;
                                    if (parent) {
                                        parent.replaceChild(document.createTextNode(mark.textContent), mark);
                                        parent.normalize();
                                    }
                                });
                                container.querySelectorAll('.search-match').forEach(el => {
                                    el.classList.remove('search-match');
                                });
                            }
                            // 重置搜索状态
                            setChatSearchKeyword('');
                            setChatMatchCount(0);
                            setChatCurrentMatchIndex(0);
                            setChatMatchRefs([]);
                            setDrawerVisible(false);
                        }}
                        open={drawerVisible}
                        width="66.67%"
                        maskClosable={true}
                    >
                        {selectedRecord && (
                            <ChatDetail record={selectedRecord} messageTypeFilter={messageTypeFilter} dateRangeFilter={dateRangeFilter} />
                        )}
                    </Drawer>
                </div>
            );
        };

        // 聊天详情搜索组件（用于标题栏）
        const ChatDetailSearch = ({ record }) => {
            const [searchKeyword, setSearchKeyword] = useState('');
            const [currentMatchIndex, setCurrentMatchIndex] = useState(0);
            const [matchCount, setMatchCount] = useState(0);
            const [matchRefs, setMatchRefs] = useState([]);
            
            // 获取聊天消息数据（与 ChatDetail 共享）
            const getChatMessages = () => {
                return [
                    { id: 1, sender: record.sender, receiver: record.receiver, type: 'text', content: '您好，请问这个产品的价格是多少？', time: '2026/01/19 14:30:00', isMe: false },
                    { id: 2, sender: record.sender, receiver: record.receiver, type: 'text', content: '您好，价格是2999元，现在有优惠活动。', time: '2026/01/19 14:31:15', isMe: true },
                    { id: 3, sender: record.sender, receiver: record.receiver, type: 'emoji', content: '😊', time: '2026/01/19 14:31:20', isMe: false },
                    { id: 4, sender: record.sender, receiver: record.receiver, type: 'image', content: '产品图片', time: '2026/01/19 14:32:00', isMe: true },
                    { id: 5, sender: record.sender, receiver: record.receiver, type: 'voice', content: '语音消息', duration: 15, transcript: '好的，我明白了。这个产品的功能确实很强大，我会尽快安排测试。', time: '2026/01/19 14:32:30', isMe: false },
                    { id: 6, sender: record.sender, receiver: record.receiver, type: 'file', content: '产品介绍.pdf', fileName: '产品介绍.pdf', fileSize: '2.5MB', fileType: 'pdf', time: '2026/01/19 14:33:00', isMe: true },
                    { id: 7, sender: record.sender, receiver: record.receiver, type: 'link', content: '产品详情页面', linkTitle: '百度地图开放平台 - 产品介绍', linkDesc: '了解我们的产品功能和优势，立即体验专业的地图服务解决方案。', time: '2026/01/19 14:33:30', isMe: false },
                    { id: 8, sender: record.sender, receiver: record.receiver, type: 'redpack', content: '恭喜发财，大吉大利', amount: '88.88', time: '2026/01/19 14:34:00', isMe: true },
                    { id: 9, sender: record.sender, receiver: record.receiver, type: 'card', content: '张明', cardName: '张明', cardTitle: '销售经理', cardCompany: '百度地图开放平台', time: '2026/01/19 14:34:30', isMe: false },
                    { id: 10, sender: record.sender, receiver: record.receiver, type: 'location', content: '北京市朝阳区xxx路xxx号', locationName: '百度大厦', locationAddress: '北京市海淀区上地十街10号', time: '2026/01/19 14:35:00', isMe: true },
                    { id: 11, sender: record.sender, receiver: record.receiver, type: 'miniprogram', content: '小程序消息', mpTitle: '百度地图小程序', mpDesc: '提供便捷的地图服务', time: '2026/01/19 14:35:30', isMe: false },
                    { id: 12, sender: record.sender, receiver: record.receiver, type: 'recall', content: '撤回了一条消息', originalContent: '这个价格可以再优惠一些吗？', time: '2026/01/19 14:36:00', isMe: true },
                    { id: 13, sender: record.sender, receiver: record.receiver, type: 'text', content: '没问题，我可以帮您申请一个更优惠的价格。您这边大概需要多少数量？', time: '2026/01/19 14:36:30', isMe: true },
                    { id: 14, sender: record.sender, receiver: record.receiver, type: 'text', content: '我们公司大概需要50套左右，主要用于客户服务系统。', time: '2026/01/19 14:37:00', isMe: false },
                    { id: 15, sender: record.sender, receiver: record.receiver, type: 'emoji', content: '👍', time: '2026/01/19 14:37:05', isMe: true },
                    { id: 16, sender: record.sender, receiver: record.receiver, type: 'voice', content: '语音消息', duration: 28, transcript: '太好了！50套的话我可以给您申请到8折优惠，也就是每套2399元。这个价格已经是我们能给到的最优惠的价格了，您看可以吗？', time: '2026/01/19 14:37:30', isMe: true },
                    { id: 17, sender: record.sender, receiver: record.receiver, type: 'text', content: '好的，这个价格可以接受。那我们什么时候可以开始实施？', time: '2026/01/19 14:38:00', isMe: false },
                    { id: 18, sender: record.sender, receiver: record.receiver, type: 'file', content: '实施计划书.docx', fileName: '实施计划书.docx', fileSize: '1.8MB', fileType: 'docx', time: '2026/01/19 14:38:30', isMe: true },
                    { id: 19, sender: record.sender, receiver: record.receiver, type: 'text', content: '这是我们详细的实施计划书，您可以先看一下。如果确认的话，我们可以下周就开始。', time: '2026/01/19 14:38:45', isMe: true },
                    { id: 20, sender: record.sender, receiver: record.receiver, type: 'image', content: '产品架构图', time: '2026/01/19 14:39:00', isMe: false },
                    { id: 21, sender: record.sender, receiver: record.receiver, type: 'text', content: '这个架构图很清晰，我发给技术团队评估一下。', time: '2026/01/19 14:39:15', isMe: false },
                    { id: 22, sender: record.sender, receiver: record.receiver, type: 'link', content: '技术文档', linkTitle: '百度地图API技术文档', linkDesc: '完整的技术文档和开发指南，包含所有API接口说明和示例代码。', time: '2026/01/19 14:39:45', isMe: true },
                    { id: 23, sender: record.sender, receiver: record.receiver, type: 'text', content: '这是我们的技术文档，您可以参考一下。有任何问题随时联系我。', time: '2026/01/19 14:40:00', isMe: true },
                    { id: 24, sender: record.sender, receiver: record.receiver, type: 'location', content: '公司地址', locationName: '我们公司', locationAddress: '北京市朝阳区建国路88号SOHO现代城', time: '2026/01/19 14:40:30', isMe: false },
                    { id: 25, sender: record.sender, receiver: record.receiver, type: 'text', content: '这是我们公司的地址，如果方便的话，欢迎您来我们公司实地考察。', time: '2026/01/19 14:40:45', isMe: false },
                    { id: 26, sender: record.sender, receiver: record.receiver, type: 'card', content: '李总', cardName: '李总', cardTitle: '技术总监', cardCompany: '客户公司', time: '2026/01/19 14:41:00', isMe: false },
                    { id: 27, sender: record.sender, receiver: record.receiver, type: 'text', content: '这是我们技术总监李总的联系方式，技术相关的问题可以直接找他。', time: '2026/01/19 14:41:15', isMe: false },
                    { id: 28, sender: record.sender, receiver: record.receiver, type: 'miniprogram', content: '小程序', mpTitle: '百度地图服务助手', mpDesc: '快速查询地图服务状态和API使用情况', time: '2026/01/19 14:41:45', isMe: true },
                    { id: 29, sender: record.sender, receiver: record.receiver, type: 'text', content: '这个小程序可以帮您快速查看服务状态，很方便的。', time: '2026/01/19 14:42:00', isMe: true },
                    { id: 30, sender: record.sender, receiver: record.receiver, type: 'emoji', content: '😄', time: '2026/01/19 14:42:05', isMe: false },
                    { id: 31, sender: record.sender, receiver: record.receiver, type: 'text', content: '好的，我先看看文档，有消息再联系您。', time: '2026/01/19 14:42:30', isMe: false },
                    { id: 32, sender: record.sender, receiver: record.receiver, type: 'text', content: '没问题，随时联系我。期待与您的合作！', time: '2026/01/19 14:43:00', isMe: true },
                    { id: 33, sender: record.sender, receiver: record.receiver, type: 'emoji', content: '🤝', time: '2026/01/19 14:43:05', isMe: false }
                ];
            };

            // 搜索功能
            const searchInMessages = (keyword) => {
                if (!keyword || !keyword.trim()) {
                    setMatchCount(0);
                    setCurrentMatchIndex(0);
                    setMatchRefs([]);
                    return;
                }
                
                const matches = [];
                const regex = new RegExp(keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
                const chatMessages = getChatMessages();
                
                chatMessages.forEach((msg) => {
                    const searchableText = msg.content || msg.transcript || msg.linkTitle || msg.locationName || msg.mpTitle || msg.cardName || msg.originalContent || '';
                    if (searchableText && regex.test(searchableText)) {
                        matches.push({ msg });
                    }
                });
                
                setMatchCount(matches.length);
                setCurrentMatchIndex(matches.length > 0 ? 1 : 0);
                setMatchRefs(matches);
            };

            // 导航到下一个/上一个匹配结果
            const navigateMatch = (direction) => {
                if (matchCount === 0) return;
                
                let newIndex = currentMatchIndex;
                if (direction === 'next') {
                    newIndex = (currentMatchIndex % matchCount) + 1;
                } else {
                    newIndex = currentMatchIndex <= 1 ? matchCount : currentMatchIndex - 1;
                }
                setCurrentMatchIndex(newIndex);
                
                // 滚动到匹配的消息
                if (matchRefs.length > 0) {
                    const targetIndex = newIndex - 1;
                    const targetMsg = matchRefs[targetIndex];
                    if (targetMsg) {
                        const element = document.getElementById(`chat-message-${targetMsg.msg.id}`);
                        if (element) {
                            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            element.classList.add('search-highlight-active');
                            setTimeout(() => {
                                element.classList.remove('search-highlight-active');
                            }, 1000);
                        }
                    }
                }
            };

            // 清除所有高亮
            const clearAllHighlights = () => {
                const container = document.querySelector('.chat-detail-container');
                if (!container) return;
                
                // 清除所有 search-highlight 标记
                container.querySelectorAll('.search-highlight').forEach(mark => {
                    const parent = mark.parentNode;
                    if (parent) {
                        parent.replaceChild(document.createTextNode(mark.textContent), mark);
                        parent.normalize();
                    }
                });
                
                // 清除所有 search-match 类
                container.querySelectorAll('.search-match').forEach(el => {
                    el.classList.remove('search-match');
                });
            };

            // 处理搜索输入
            const handleSearchChange = (e) => {
                const keyword = e.target.value;
                
                // 先清除所有旧的高亮
                clearAllHighlights();
                
                setSearchKeyword(keyword);
                searchInMessages(keyword);
                
                // 如果有新关键词，添加高亮
                if (keyword && keyword.trim()) {
                    setTimeout(() => {
                        const regex = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
                        const container = document.querySelector('.chat-detail-container');
                        if (!container) return;
                        
                        const walker = document.createTreeWalker(
                            container,
                            NodeFilter.SHOW_TEXT,
                            null,
                            false
                        );
                        
                        const textNodes = [];
                        let node;
                        while (node = walker.nextNode()) {
                            // 跳过已经在 search-highlight 内的文本节点
                            if (node.parentElement && node.parentElement.classList.contains('search-highlight')) {
                                continue;
                            }
                            if (node.textContent.trim() && regex.test(node.textContent)) {
                                textNodes.push(node);
                            }
                        }
                        
                        textNodes.forEach(textNode => {
                            const parent = textNode.parentNode;
                            if (parent && !parent.classList.contains('search-highlight')) {
                                const text = textNode.textContent;
                                const parts = text.split(regex);
                                const fragment = document.createDocumentFragment();
                                
                                parts.forEach((part, index) => {
                                    if (regex.test(part)) {
                                        const mark = document.createElement('mark');
                                        mark.className = 'search-highlight';
                                        mark.textContent = part;
                                        fragment.appendChild(mark);
                                    } else if (part) {
                                        fragment.appendChild(document.createTextNode(part));
                                    }
                                });
                                
                                parent.replaceChild(fragment, textNode);
                            }
                        });
                    }, 100);
                }
            };

            // 处理键盘事件
            const handleKeyDown = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    navigateMatch('next');
                } else if (e.key === 'Escape') {
                    clearAllHighlights();
                    setSearchKeyword('');
                    setMatchCount(0);
                    setCurrentMatchIndex(0);
                    setMatchRefs([]);
                }
            };

            // 清除搜索
            const clearSearch = () => {
                clearAllHighlights();
                setSearchKeyword('');
                setMatchCount(0);
                setCurrentMatchIndex(0);
                setMatchRefs([]);
            };

            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            // 当组件卸载时，清除所有高亮
            useEffect(() => {
                return () => {
                    clearAllHighlights();
                };
            }, []);

            return (
                <div className="drawer-search-box">
                    <i data-lucide="search" style={{ width: '14px', height: '14px', color: '#666', marginRight: '6px' }}></i>
                    <input
                        type="text"
                        className="drawer-search-input"
                        placeholder="搜索聊天记录..."
                        value={searchKeyword}
                        onChange={handleSearchChange}
                        onKeyDown={handleKeyDown}
                    />
                    {searchKeyword && (
                        <>
                            <div className="drawer-search-navigation">
                                <button
                                    className="drawer-search-nav-btn"
                                    onClick={() => navigateMatch('prev')}
                                    disabled={matchCount === 0}
                                    title="上一个"
                                >
                                    <i data-lucide="chevron-up" style={{ width: '12px', height: '12px' }}></i>
                                </button>
                                <button
                                    className="drawer-search-nav-btn"
                                    onClick={() => navigateMatch('next')}
                                    disabled={matchCount === 0}
                                    title="下一个 (Enter)"
                                >
                                    <i data-lucide="chevron-down" style={{ width: '12px', height: '12px' }}></i>
                                </button>
                            </div>
                            {matchCount > 0 && (
                                <div className="drawer-search-count">
                                    {currentMatchIndex}/{matchCount}
                                </div>
                            )}
                            <button
                                className="drawer-search-close"
                                onClick={clearSearch}
                                title="关闭 (Esc)"
                            >
                                <i data-lucide="x" style={{ width: '12px', height: '12px' }}></i>
                            </button>
                        </>
                    )}
                </div>
            );
        };

        // 聊天详情组件
        const ChatDetail = ({ record, messageTypeFilter = '全部', dateRangeFilter = null }) => {
            // 格式化时间显示
            const formatTime = (timeStr) => {
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const currentYear = now.getFullYear();
                
                // 解析时间字符串 "2026/01/20 14:30:00"
                const [datePart, timePart] = timeStr.split(' ');
                const [year, month, day] = datePart.split('/').map(Number);
                const [hours, minutes] = timePart.split(':').map(Number);
                const timeDate = new Date(year, month - 1, day, hours, minutes);
                
                // 判断是否为今日
                const isToday = timeDate >= today && timeDate < new Date(today.getTime() + 24 * 60 * 60 * 1000);
                
                // 判断是否为今年
                const isCurrentYear = year === currentYear;
                
                // 格式化时:分（去掉秒）
                const timeStrWithoutSeconds = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;
                
                if (isToday) {
                    // 今日显示：时:分
                    return timeStrWithoutSeconds;
                } else if (isCurrentYear) {
                    // 本自然年而非今日：月/日 时:分
                    return `${month}/${day} ${timeStrWithoutSeconds}`;
                } else {
                    // 本自然年以前：年/月/日 时:分
                    return `${year}/${month}/${day} ${timeStrWithoutSeconds}`;
                }
            };
            
            // 模拟对话记录数据（包含当天、本年、非本年的消息）
            const allChatMessages = [
                // 当天的消息（2026/01/20）
                {
                    id: 1,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '您好，请问这个产品的价格是多少？',
                    time: '2026/01/20 14:30:00',
                    isMe: false
                },
                {
                    id: 2,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '您好，价格是2999元，现在有优惠活动。',
                    time: '2026/01/20 14:31:15',
                    isMe: true
                },
                {
                    id: 3,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'emoji',
                    content: '😊',
                    time: '2026/01/20 14:31:20',
                    isMe: false
                },
                {
                    id: 4,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'image',
                    content: '产品图片',
                    imageUrl: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">产品图片</text></svg>'),
                    time: '2026/01/20 14:32:00',
                    isMe: true
                },
                {
                    id: 5,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'voice',
                    content: '语音消息',
                    duration: 15,
                    transcript: '好的，我明白了。这个产品的功能确实很强大，我会尽快安排测试。',
                    time: '2026/01/20 14:32:30',
                    isMe: false
                },
                {
                    id: 6,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'file',
                    content: '产品介绍.pdf',
                    fileName: '产品介绍.pdf',
                    fileSize: '2.5MB',
                    fileType: 'pdf',
                    time: '2026/01/20 14:33:00',
                    isMe: true
                },
                {
                    id: 7,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'link',
                    content: '产品详情页面',
                    linkUrl: 'https://example.com/product',
                    linkTitle: '百度地图开放平台 - 产品介绍',
                    linkDesc: '了解我们的产品功能和优势，立即体验专业的地图服务解决方案。',
                    linkImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">链接预览图</text></svg>'),
                    time: '2026/01/20 14:33:30',
                    isMe: false
                },
                {
                    id: 8,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'redpack',
                    content: '恭喜发财，大吉大利',
                    amount: '88.88',
                    time: '2026/01/20 14:34:00',
                    isMe: true
                },
                {
                    id: 9,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'card',
                    content: '张明',
                    cardName: '张明',
                    cardTitle: '销售经理',
                    cardCompany: '百度地图开放平台',
                    cardAvatar: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">张</text></svg>'),
                    time: '2026/01/20 14:34:30',
                    isMe: false
                },
                {
                    id: 10,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'location',
                    content: '北京市朝阳区xxx路xxx号',
                    locationName: '百度大厦',
                    locationAddress: '北京市海淀区上地十街10号',
                    locationLat: 39.984,
                    locationLng: 116.307,
                    locationImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>'),
                    time: '2026/01/20 14:35:00',
                    isMe: true
                },
                {
                    id: 11,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'miniprogram',
                    content: '小程序消息',
                    mpTitle: '百度地图小程序',
                    mpDesc: '提供便捷的地图服务',
                    mpImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">小程序</text></svg>'),
                    mpPath: 'pages/index/index',
                    time: '2026/01/20 14:35:30',
                    isMe: false
                },
                {
                    id: 12,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'recall',
                    content: '撤回了一条消息',
                    originalContent: '这个价格可以再优惠一些吗？',
                    time: '2026/01/20 14:36:00',
                    isMe: true
                },
                {
                    id: 13,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '没问题，我可以帮您申请一个更优惠的价格。您这边大概需要多少数量？',
                    time: '2026/01/20 14:36:30',
                    isMe: true
                },
                {
                    id: 14,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '我们公司大概需要50套左右，主要用于客户服务系统。',
                    time: '2026/01/20 14:37:00',
                    isMe: false
                },
                {
                    id: 15,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'emoji',
                    content: '👍',
                    time: '2026/01/20 14:37:05',
                    isMe: true
                },
                {
                    id: 16,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'voice',
                    content: '语音消息',
                    duration: 28,
                    transcript: '太好了！50套的话我可以给您申请到8折优惠，也就是每套2399元。这个价格已经是我们能给到的最优惠的价格了，您看可以吗？',
                    time: '2026/01/20 14:37:30',
                    isMe: true
                },
                {
                    id: 17,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '好的，这个价格可以接受。那我们什么时候可以开始实施？',
                    time: '2026/01/20 14:38:00',
                    isMe: false
                },
                {
                    id: 18,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'file',
                    content: '实施计划书.docx',
                    fileName: '实施计划书.docx',
                    fileSize: '1.8MB',
                    fileType: 'docx',
                    time: '2026/01/20 14:38:30',
                    isMe: true
                },
                {
                    id: 19,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '这是我们详细的实施计划书，您可以先看一下。如果确认的话，我们可以下周就开始。',
                    time: '2026/01/20 14:38:45',
                    isMe: true
                },
                {
                    id: 20,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'image',
                    content: '产品架构图',
                    imageUrl: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">产品架构图</text></svg>'),
                    time: '2026/01/20 14:39:00',
                    isMe: false
                },
                {
                    id: 21,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '这个架构图很清晰，我发给技术团队评估一下。',
                    time: '2026/01/20 14:39:15',
                    isMe: false
                },
                {
                    id: 22,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'link',
                    content: '技术文档',
                    linkUrl: 'https://example.com/docs',
                    linkTitle: '百度地图API技术文档',
                    linkDesc: '完整的技术文档和开发指南，包含所有API接口说明和示例代码。',
                    linkImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">技术文档</text></svg>'),
                    time: '2026/01/20 14:39:45',
                    isMe: true
                },
                {
                    id: 23,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '这是我们的技术文档，您可以参考一下。有任何问题随时联系我。',
                    time: '2026/01/20 14:40:00',
                    isMe: true
                },
                {
                    id: 24,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'location',
                    content: '公司地址',
                    locationName: '我们公司',
                    locationAddress: '北京市朝阳区建国路88号SOHO现代城',
                    locationLat: 39.908,
                    locationLng: 116.475,
                    locationImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>'),
                    time: '2026/01/20 14:40:30',
                    isMe: false
                },
                {
                    id: 25,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '这是我们公司的地址，如果方便的话，欢迎您来我们公司实地考察。',
                    time: '2026/01/20 14:40:45',
                    isMe: false
                },
                {
                    id: 26,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'card',
                    content: '李总',
                    cardName: '李总',
                    cardTitle: '技术总监',
                    cardCompany: '客户公司',
                    cardAvatar: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">李</text></svg>'),
                    time: '2026/01/20 14:41:00',
                    isMe: false
                },
                {
                    id: 27,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '这是我们技术总监李总的联系方式，技术相关的问题可以直接找他。',
                    time: '2026/01/20 14:41:15',
                    isMe: false
                },
                {
                    id: 28,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'miniprogram',
                    content: '小程序',
                    mpTitle: '百度地图服务助手',
                    mpDesc: '快速查询地图服务状态和API使用情况',
                    mpImage: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><rect width="100" height="100" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="12" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">服务助手</text></svg>'),
                    mpPath: 'pages/service/index',
                    time: '2026/01/20 14:41:45',
                    isMe: true
                },
                {
                    id: 29,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '这个小程序可以帮您快速查看服务状态，很方便的。',
                    time: '2026/01/20 14:42:00',
                    isMe: true
                },
                {
                    id: 30,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'emoji',
                    content: '😄',
                    time: '2026/01/20 14:42:05',
                    isMe: false
                },
                {
                    id: 31,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '好的，我先看看文档，有消息再联系您。',
                    time: '2026/01/20 14:42:30',
                    isMe: false
                },
                {
                    id: 32,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '没问题，随时联系我。期待与您的合作！',
                    time: '2026/01/20 14:43:00',
                    isMe: true
                },
                {
                    id: 33,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'emoji',
                    content: '🤝',
                    time: '2026/01/20 14:43:05',
                    isMe: false
                },
                // 本年的消息（2026年，非当天）
                {
                    id: 34,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '上次讨论的方案，我已经整理好了',
                    time: '2026/01/19 16:20:00',
                    isMe: true
                },
                {
                    id: 35,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '好的，我看看',
                    time: '2026/01/19 16:21:00',
                    isMe: false
                },
                {
                    id: 36,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'image',
                    content: '方案文档',
                    imageUrl: 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">方案文档</text></svg>'),
                    time: '2026/01/18 10:15:00',
                    isMe: true
                },
                {
                    id: 37,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '收到，谢谢',
                    time: '2026/01/18 10:16:00',
                    isMe: false
                },
                // 非本年的消息（2025年或更早）
                {
                    id: 38,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '去年的项目进展如何？',
                    time: '2025/12/20 15:30:00',
                    isMe: false
                },
                {
                    id: 39,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '进展顺利，预计下个月完成',
                    time: '2025/12/20 15:31:00',
                    isMe: true
                },
                {
                    id: 40,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'file',
                    content: '项目报告.pdf',
                    fileName: '项目报告.pdf',
                    fileSize: '3.2MB',
                    fileType: 'pdf',
                    time: '2025/11/15 11:20:00',
                    isMe: true
                },
                {
                    id: 41,
                    sender: record.sender,
                    receiver: record.receiver,
                    type: 'text',
                    content: '收到，我会仔细查看',
                    time: '2025/11/15 11:21:00',
                    isMe: false
                }
            ];

            const renderMessage = (msg) => {
                const renderMessageContent = () => {
                    switch (msg.type) {
                        case 'text':
                            return <span>{msg.content}</span>;
                        case 'emoji':
                            return <span style={{ fontSize: '24px' }}>{msg.content}</span>;
                        case 'image':
                            const defaultImageSvg = encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">产品图片</text></svg>');
                            return (
                                <div className="message-image-container">
                                    <img 
                                        src={msg.imageUrl || `data:image/svg+xml;charset=utf-8,${defaultImageSvg}`} 
                                        alt={msg.content}
                                        onError={(e) => {
                                            const fallbackSvg = encodeURIComponent('<svg width="200" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="200" height="150" fill="#4A90E2"/><text x="50%" y="50%" font-family="Arial" font-size="14" fill="#fff" text-anchor="middle" dominant-baseline="middle">图片</text></svg>');
                                            e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                        }}
                                    />
                                </div>
                            );
                        case 'voice':
                            return (
                                <div>
                                    <div className="message-voice-container">
                                        <div 
                                            className="voice-play-btn"
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                // 这里可以添加播放逻辑
                                            }}
                                            style={{ cursor: 'pointer' }}
                                        >
                                            <i data-lucide="play" style={{ width: '12px', height: '12px' }}></i>
                                        </div>
                                        <div className="voice-duration">{msg.duration || 15}"</div>
                                        <div className="voice-wave"></div>
                                    </div>
                                    {msg.transcript && (
                                        <div className="voice-transcript">{msg.transcript}</div>
                                    )}
                                </div>
                            );
                        case 'video':
                            return (
                                <div className="message-video">
                                    <i data-lucide="video" style={{ width: '20px', height: '20px', display: 'inline-block', marginRight: '8px' }}></i>
                                    <span>视频消息</span>
                                </div>
                            );
                        case 'file':
                            return (
                                <div className="message-file-container">
                                    <div className={`file-icon ${msg.fileType || 'pdf'}`}>
                                        {msg.fileType === 'pdf' ? (
                                            <span style={{ fontSize: '20px', fontWeight: 'bold' }}>PDF</span>
                                        ) : (
                                            <i data-lucide="file" style={{ width: '24px', height: '24px' }}></i>
                                        )}
                                    </div>
                                    <div className="file-info">
                                        <div className="file-name">{msg.fileName || msg.content}</div>
                                        <div className="file-size">{msg.fileSize || '2.5MB'}</div>
                                    </div>
                                </div>
                            );
                        case 'link':
                            const defaultLinkSvg = encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">链接预览图</text></svg>');
                            return (
                                <div className="message-link-card">
                                    <img 
                                        src={msg.linkImage || `data:image/svg+xml;charset=utf-8,${defaultLinkSvg}`} 
                                        alt={msg.linkTitle} 
                                        className="link-image"
                                        onError={(e) => {
                                            const fallbackSvg = encodeURIComponent('<svg width="280" height="150" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="150" fill="#1890FF"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="#fff" text-anchor="middle" dominant-baseline="middle">链接</text></svg>');
                                            e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                        }}
                                    />
                                    <div className="link-content">
                                        <div className="link-title">{msg.linkTitle || msg.content}</div>
                                        <div className="link-desc">{msg.linkDesc || '点击查看详情'}</div>
                                    </div>
                                </div>
                            );
                        case 'redpack':
                            return (
                                <div className="message-redpack-card">
                                    <div className="redpack-decor"></div>
                                    <div className="redpack-icon">🧧</div>
                                    <div className="redpack-text">{msg.content}</div>
                                    {msg.amount && (
                                        <div className="redpack-amount">¥{msg.amount}</div>
                                    )}
                                </div>
                            );
                        case 'card':
                            return (
                                <div className="message-card-container">
                                    <div className="card-header">
                                        <div className="card-avatar">
                                            {msg.cardAvatar ? (
                                                <img 
                                                    src={msg.cardAvatar} 
                                                    alt={msg.cardName}
                                                    onError={(e) => {
                                                        e.target.style.display = 'none';
                                                        const fallback = e.target.parentElement.querySelector('.card-avatar-fallback');
                                                        if (fallback) {
                                                            fallback.style.display = 'flex';
                                                        }
                                                    }}
                                                />
                                            ) : null}
                                            <span className="card-avatar-fallback" style={{ display: msg.cardAvatar ? 'none' : 'flex' }}>{msg.cardName ? msg.cardName.charAt(0) : '?'}</span>
                                        </div>
                                        <div className="card-info">
                                            <div className="card-name">{msg.cardName || msg.content}</div>
                                            <div className="card-title">{msg.cardTitle || '销售经理'}</div>
                                        </div>
                                    </div>
                                    {msg.cardCompany && (
                                        <div className="card-company">{msg.cardCompany}</div>
                                    )}
                                </div>
                            );
                        case 'location':
                            return (
                                <div className="message-location-container">
                                    {(() => {
                                        const defaultLocationSvg = encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>');
                                        return (
                                            <img 
                                                src={msg.locationImage || `data:image/svg+xml;charset=utf-8,${defaultLocationSvg}`} 
                                                alt={msg.locationName} 
                                                className="location-image"
                                                onError={(e) => {
                                                    const fallbackSvg = encodeURIComponent('<svg width="280" height="120" xmlns="http://www.w3.org/2000/svg"><rect width="280" height="120" fill="#f5f5f5"/><defs><pattern id="grid2" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/></pattern></defs><rect width="280" height="120" fill="url(#grid2)"/><g transform="translate(140, 50)"><path d="M20 10C20 14.4183 16.4183 18 12 18C7.58172 18 4 14.4183 4 10C4 5.58172 7.58172 2 12 2C16.4183 2 20 5.58172 20 10Z" fill="#ff4d4f" stroke="#fff" stroke-width="1.5"/><path d="M12 2V8M12 16V18" stroke="#fff" stroke-width="2" stroke-linecap="round"/></g></svg>');
                                                    e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                                }}
                                            />
                                        );
                                    })()}
                                    <div className="location-content">
                                        <div className="location-name">{msg.locationName || msg.content}</div>
                                        <div className="location-address">{msg.locationAddress || msg.content}</div>
                                    </div>
                                </div>
                            );
                        case 'miniprogram':
                            return (
                                <div className="message-miniprogram-card">
                                    <div className="mp-header">
                                        <div className="mp-icon">小</div>
                                        <div className="mp-title">小程序</div>
                                    </div>
                                    <div className="mp-body">
                                        {(() => {
                                            const defaultMpSvg = encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="12" fill="#fff" text-anchor="middle" dominant-baseline="middle" font-weight="bold">小程序</text></svg>');
                                            return (
                                                <img 
                                                    src={msg.mpImage || `data:image/svg+xml;charset=utf-8,${defaultMpSvg}`} 
                                                    alt={msg.mpTitle} 
                                                    className="mp-image"
                                                    onError={(e) => {
                                                        const fallbackSvg = encodeURIComponent('<svg width="60" height="60" xmlns="http://www.w3.org/2000/svg"><rect width="60" height="60" rx="8" fill="#07C160"/><text x="50%" y="50%" font-family="Arial" font-size="10" fill="#fff" text-anchor="middle" dominant-baseline="middle">MP</text></svg>');
                                                        e.target.src = `data:image/svg+xml;charset=utf-8,${fallbackSvg}`;
                                                    }}
                                                />
                                            );
                                        })()}
                                        <div className="mp-content">
                                            <div className="mp-name">{msg.mpTitle || msg.content}</div>
                                            <div className="mp-desc">{msg.mpDesc || '提供便捷的服务'}</div>
                                        </div>
                                    </div>
                                </div>
                            );
                        case 'recall':
                            return (
                                <div>
                                    <div className="message-recall">{msg.content}</div>
                                    {msg.originalContent && (
                                        <div className="message-recall-content">{msg.originalContent}</div>
                                    )}
                                </div>
                            );
                        default:
                            return <span>{msg.content}</span>;
                    }
                };

                return (
                    <div key={msg.id} className={`chat-message ${msg.isMe ? 'me' : ''}`}>
                        {!msg.isMe && (
                            <div className="chat-avatar other">
                                {record.receiver.charAt(0)}
                            </div>
                        )}
                        <div className="chat-content-wrapper">
                            <div className="chat-name-time">
                                {msg.isMe ? record.sender : record.receiver} · {formatTime(msg.time)}
                            </div>
                            <div className={`chat-bubble ${msg.isMe ? 'me' : 'other'} ${msg.type === 'recall' ? 'recall' : ''}`}>
                                {renderMessageContent()}
                            </div>
                        </div>
                        {msg.isMe && (
                            <div className="chat-avatar me">
                                {record.sender.charAt(0)}
                            </div>
                        )}
                    </div>
                );
            };

            // 解析时间字符串为Date对象
            const parseTime = (timeStr) => {
                // 格式: 2026/01/19 14:30:00
                const parts = timeStr.split(' ');
                const dateParts = parts[0].split('/');
                const timeParts = parts[1] ? parts[1].split(':') : ['0', '0', '0'];
                return new Date(
                    parseInt(dateParts[0]),
                    parseInt(dateParts[1]) - 1,
                    parseInt(dateParts[2]),
                    parseInt(timeParts[0]),
                    parseInt(timeParts[1]),
                    parseInt(timeParts[2])
                );
            };

            // 根据消息类型和日期范围筛选
            let filteredMessages = allChatMessages;
            
            // 先按消息类型筛选
            if (messageTypeFilter !== '全部') {
                const typeMap = {
                    '文本': 'text',
                    '表情': 'emoji',
                    '语音': 'voice',
                    '图片': 'image',
                    '视频': 'video',
                    '文件': 'file',
                    '链接': 'link',
                    '红包': 'redpack',
                    '名片': 'card',
                    '位置': 'location',
                    '小程序消息': 'miniprogram',
                    '撤回消息': 'recall'
                };
                filteredMessages = filteredMessages.filter(msg => msg.type === typeMap[messageTypeFilter]);
            }
            
            // 再按日期范围筛选
            if (dateRangeFilter && dateRangeFilter.length === 2 && dateRangeFilter[0] && dateRangeFilter[1]) {
                const startDate = dateRangeFilter[0].startOf('day');
                const endDate = dateRangeFilter[1].endOf('day');
                
                filteredMessages = filteredMessages.filter(msg => {
                    const msgDate = parseTime(msg.time);
                    const msgDayjs = dayjs(msgDate);
                    // 检查消息时间是否在日期范围内（包含开始和结束日期）
                    return (msgDayjs.isAfter(startDate) || msgDayjs.isSame(startDate)) && 
                           (msgDayjs.isBefore(endDate) || msgDayjs.isSame(endDate));
                });
            }

            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            return (
                <div className="chat-detail-container">
                    {filteredMessages.length === 0 ? (
                        <div style={{ textAlign: 'center', color: '#8c8c8c', padding: '40px' }}>
                            暂无消息
                        </div>
                    ) : (
                        filteredMessages.map(msg => {
                            const messageElement = renderMessage(msg);
                            return React.cloneElement(messageElement, {
                                key: msg.id,
                                id: `chat-message-${msg.id}`
                            });
                        })
                    )}
                </div>
            );
        };

        // 通话记录组件
        const CallRecords = () => (
            <div className="content-card">
                <h2 style={{ fontSize: '20px', fontWeight: 600, marginBottom: '12px', color: '#262626' }}>
                    通话记录
                </h2>
                <div style={{ padding: '20px', textAlign: 'center', color: '#8c8c8c' }}>
                    <div style={{ marginBottom: '16px' }}>
                        <i data-lucide="phone-call" style={{ width: '48px', height: '48px', color: '#1890ff' }}></i>
                    </div>
                    <p>通话记录功能开发中...</p>
                    <p>该功能将展示所有手动通话的详细记录</p>
                </div>
            </div>
        );

        // 智能外呼记录组件
        const OutboundCallRecords = () => {
            // 删除了selectedRowKeys状态
            const [transcriptModalVisible, setTranscriptModalVisible] = useState(false);
            const [currentTranscriptCallKey, setCurrentTranscriptCallKey] = useState(null);
            const [activeCallAudioKeys, setActiveCallAudioKeys] = useState([]); // 修改：支持多个录音同时播放
            const [expandedAiTags, setExpandedAiTags] = useState({}); // 大模型标签信息展开状态
            const [expandedPendingQuestions, setExpandedPendingQuestions] = useState({}); // 待明确问题展开状态
            const [refreshTime, setRefreshTime] = useState('2026-02-26 11:42'); // 刷新时间状态
            const [activeTab, setActiveTab] = useState('records'); // 选项卡状态：'records' 外呼记录, 'statistics' 统计
            const [detailDrawerVisible, setDetailDrawerVisible] = useState(false); // 详情抽屉状态
            const [currentDetailRecord, setCurrentDetailRecord] = useState(null); // 当前查看详情的记录
            const [detailTab, setDetailTab] = useState('callDetail'); // 详情抽屉选项卡：'callDetail' 通话详情, 'customerVar' 通话总结
            
            // 图表初始化 useEffect
            useEffect(() => {
                if (activeTab === 'statistics') {
                    // 延迟执行以确保DOM已渲染
                    setTimeout(() => {
                        initIndustryPieChart();
                        initScenarioBarChart();
                        initSatisfactionGauge();
                        initPositiveFeedbackTags();
                        initNegativeFeedbackTags();
                        initUserQuestionsChart();
                        initCompetitorMentionsChart();
                        initCompetitorComparisonCards();
                    }, 100);
                }
            }, [activeTab]);

            // 行业分布 Top 10 空心饼图 - 随机生成10个行业数据
            const initIndustryPieChart = () => {
                const chartDom = document.getElementById('industryPieChart');
                if (!chartDom) return;
                
                const myChart = echarts.init(chartDom);
                
                // 随机生成10个行业及数据
                const industries = [
                    '物流运输', '餐饮外卖', '房地产', '交通出行', 
                    '教育培训', '医疗健康', '金融服务', '零售电商', 
                    '智能制造', '文化娱乐'
                ];
                
                // 生成随机数据（确保总和为100）
                const generateRandomData = () => {
                    let values = [];
                    let remaining = 100;
                    for (let i = 0; i < 9; i++) {
                        const value = Math.random() * (remaining / (10 - i)) * 1.5;
                        values.push(parseFloat(value.toFixed(1)));
                        remaining -= values[i];
                    }
                    values.push(parseFloat(remaining.toFixed(1)));
                    return values;
                };
                
                const values = generateRandomData();
                const colors = ['#5470c6', '#91cc75', '#fac858', '#ee6666', '#73c0de', '#3ba272', '#fc8452', '#9a60b4', '#ea7ccc', '#5d7092'];
                
                // 创建数据并按值从高到低排序（顺时针排列）
                let data = industries.map((name, index) => ({
                    value: values[index],
                    name: name,
                    itemStyle: { color: colors[index] }
                }));
                
                // 按数值从高到低排序
                data.sort((a, b) => b.value - a.value);
                
                const option = {
                    tooltip: {
                        trigger: 'item',
                        formatter: '{b}: {c}% ({d}%)'
                    },
                    legend: {
                        orient: 'vertical',
                        right: '5%',
                        top: 'center',
                        textStyle: {
                            fontSize: 12
                        }
                    },
                    series: [
                        {
                            name: '行业分布 Top 10',
                            type: 'pie',
                            radius: ['45%', '70%'],
                            center: ['35%', '50%'],
                            avoidLabelOverlap: true,
                            itemStyle: {
                                borderRadius: 8,
                                borderColor: '#fff',
                                borderWidth: 2
                            },
                            label: {
                                show: true,
                                formatter: '{b}\n{c}\n({d}%)',
                                fontSize: 11,
                                color: '#666',
                                lineHeight: 16
                            },
                            emphasis: {
                                label: {
                                    show: true,
                                    fontSize: 14,
                                    fontWeight: 'bold'
                                }
                            },
                            labelLine: {
                                show: true,
                                length: 15,
                                length2: 8
                            },
                            data: data
                        }
                    ]
                };
                myChart.setOption(option);
                
                // 响应式调整
                window.addEventListener('resize', () => myChart.resize());
            };

            // 总体满意度仪表盘
            const initSatisfactionGauge = () => {
                const chartDom = document.getElementById('satisfactionGauge');
                if (!chartDom) return;
                
                const myChart = echarts.init(chartDom);
                
                // 随机生成满意度分数 (60-100)
                const satisfactionScore = Math.floor(Math.random() * 40) + 60;
                
                const option = {
                    series: [
                        {
                            type: 'gauge',
                            startAngle: 180,
                            endAngle: 0,
                            min: 0,
                            max: 100,
                            splitNumber: 10,
                            radius: '85%',
                            center: ['50%', '70%'],
                            axisLine: {
                                lineStyle: {
                                    width: 20,
                                    color: [
                                        [0.6, '#ff6b6b'],
                                        [0.8, '#feca57'],
                                        [1, '#48dbfb']
                                    ]
                                }
                            },
                            pointer: {
                                itemStyle: {
                                    color: '#1890ff',
                                    shadowColor: 'rgba(0, 0, 0, 0.3)',
                                    shadowBlur: 8
                                },
                                width: 8,
                                length: '60%'
                            },
                            axisTick: {
                                distance: -20,
                                length: 6,
                                lineStyle: {
                                    color: '#fff',
                                    width: 1
                                }
                            },
                            splitLine: {
                                distance: -20,
                                length: 12,
                                lineStyle: {
                                    color: '#fff',
                                    width: 2
                                }
                            },
                            axisLabel: {
                                distance: -38,
                                color: '#666',
                                fontSize: 11
                            },
                            detail: {
                                valueAnimation: true,
                                formatter: '{value}分',
                                color: '#262626',
                                fontSize: 28,
                                fontWeight: 'bold',
                                offsetCenter: [0, '-10%']
                            },
                            title: {
                                show: true,
                                offsetCenter: [0, '30%'],
                                fontSize: 14,
                                color: '#8c8c8c'
                            },
                            data: [
                                {
                                    value: satisfactionScore,
                                    name: '总体满意度'
                                }
                            ]
                        }
                    ]
                };
                
                myChart.setOption(option);
                window.addEventListener('resize', () => myChart.resize());
            };

            // 正面反馈矩阵标签
            const initPositiveFeedbackTags = () => {
                const container = document.getElementById('positiveFeedbackTags');
                if (!container) return;
                
                // 正面反馈短语
                const positiveFeedbacks = [
                    '门店POI数据很丰富',
                    '页面滑动的流畅度很高',
                    '路线规划算法很准确',
                    '定位响应速度快',
                    '地图加载性能优秀',
                    'API文档清晰易懂',
                    '技术支持响应及时',
                    '数据更新频率高',
                    '界面设计简洁美观',
                    '功能扩展性强',
                    '价格合理实惠',
                    '坐标转换准确',
                    '批量接口很实用',
                    '服务稳定可靠',
                    '多端适配良好'
                ];
                
                // 为每个反馈生成随机提及次数 (5-50)
                const data = positiveFeedbacks.map(name => ({
                    name: name,
                    value: Math.floor(Math.random() * 45) + 5
                }));
                
                // 按提及次数排序
                data.sort((a, b) => b.value - a.value);
                
                // 渲染标签矩阵 - 添加固定高度和滚动
                container.innerHTML = `
                    <div style="
                        max-height: 252px;
                        overflow-y: auto;
                        overflow-x: hidden;
                        padding: 8px 12px 8px 0;
                        scrollbar-width: thin;
                        scrollbar-color: #b7eb8f #f0f0f0;
                    ">
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${data.map(item => `
                                <div style="
                                    display: inline-flex;
                                    align-items: center;
                                    gap: 6px;
                                    padding: 6px 12px;
                                    background: linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%);
                                    border: 1px solid #b7eb8f;
                                    border-radius: 16px;
                                    font-size: 13px;
                                    color: #237804;
                                    transition: all 0.2s;
                                    cursor: default;
                                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(82,196,26,0.2)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                    <span style="font-weight: 500;">${item.name}</span>
                                    <span style="
                                        display: inline-flex;
                                        align-items: center;
                                        justify-content: center;
                                        min-width: 24px;
                                        height: 20px;
                                        padding: 0 6px;
                                        background: #52c41a;
                                        color: #fff;
                                        border-radius: 10px;
                                        font-size: 11px;
                                        font-weight: 600;
                                    ">${item.value}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                // 自定义滚动条样式（Webkit浏览器）
                const style = document.createElement('style');
                style.textContent = `
                    #positiveFeedbackTags > div::-webkit-scrollbar {
                        width: 6px;
                    }
                    #positiveFeedbackTags > div::-webkit-scrollbar-track {
                        background: #f0f0f0;
                        border-radius: 3px;
                    }
                    #positiveFeedbackTags > div::-webkit-scrollbar-thumb {
                        background: #b7eb8f;
                        border-radius: 3px;
                    }
                    #positiveFeedbackTags > div::-webkit-scrollbar-thumb:hover {
                        background: #95de64;
                    }
                `;
                document.head.appendChild(style);
            };

            // 负面反馈矩阵标签
            const initNegativeFeedbackTags = () => {
                const container = document.getElementById('negativeFeedbackTags');
                if (!container) return;
                
                // 负面反馈短语
                const negativeFeedbacks = [
                    '点击页面刷新有延迟',
                    '没有自定义购买套餐的功能',
                    '偶尔出现定位偏移',
                    '批量接口超时问题',
                    '文档部分内容不够详细',
                    '价格对小团队偏高',
                    '缺少夜间模式样式',
                    '室内定位精度待提升',
                    '部分API返回格式不统一',
                    '海外地图数据覆盖不全',
                    '路径规划偶有绕路',
                    '缺少实时路况告警',
                    '开发者后台加载慢',
                    '缺少离线地图功能',
                    '数据更新有时滞后'
                ];
                
                // 为每个反馈生成随机提及次数 (3-35)
                const data = negativeFeedbacks.map(name => ({
                    name: name,
                    value: Math.floor(Math.random() * 32) + 3
                }));
                
                // 按提及次数排序
                data.sort((a, b) => b.value - a.value);
                
                // 渲染标签矩阵 - 添加固定高度和滚动
                container.innerHTML = `
                    <div style="
                        max-height: 252px;
                        overflow-y: auto;
                        overflow-x: hidden;
                        padding: 8px 12px 8px 0;
                        scrollbar-width: thin;
                        scrollbar-color: #ffa39e #f0f0f0;
                    ">
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${data.map(item => `
                                <div style="
                                    display: inline-flex;
                                    align-items: center;
                                    gap: 6px;
                                    padding: 6px 12px;
                                    background: linear-gradient(135deg, #fff2f0 0%, #ffccc7 100%);
                                    border: 1px solid #ffa39e;
                                    border-radius: 16px;
                                    font-size: 13px;
                                    color: #a8071a;
                                    transition: all 0.2s;
                                    cursor: default;
                                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(255,77,79,0.2)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                    <span style="font-weight: 500;">${item.name}</span>
                                    <span style="
                                        display: inline-flex;
                                        align-items: center;
                                        justify-content: center;
                                        min-width: 24px;
                                        height: 20px;
                                        padding: 0 6px;
                                        background: #ff4d4f;
                                        color: #fff;
                                        border-radius: 10px;
                                        font-size: 11px;
                                        font-weight: 600;
                                    ">${item.value}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                // 自定义滚动条样式（Webkit浏览器）
                const style = document.createElement('style');
                style.textContent = `
                    #negativeFeedbackTags > div::-webkit-scrollbar {
                        width: 6px;
                    }
                    #negativeFeedbackTags > div::-webkit-scrollbar-track {
                        background: #f0f0f0;
                        border-radius: 3px;
                    }
                    #negativeFeedbackTags > div::-webkit-scrollbar-thumb {
                        background: #ffa39e;
                        border-radius: 3px;
                    }
                    #negativeFeedbackTags > div::-webkit-scrollbar-thumb:hover {
                        background: #ff7875;
                    }
                `;
                document.head.appendChild(style);
            };

            // 用户问题统计条形图
            const initUserQuestionsChart = () => {
                const chartDom = document.getElementById('userQuestionsChart');
                if (!chartDom) return;
                
                const myChart = echarts.init(chartDom);
                
                // 用户常见问题和机器人无法解答的问题
                const questions = [
                    '能否提供离线地图包下载？',
                    '如何申请更高的并发配额？',
                    '路径规划支持实时路况吗？',
                    '是否支持海外地图数据？',
                    '可以定制化地图样式吗？',
                    '如何处理坐标系转换问题？',
                    '批量请求有速率限制吗？',
                    '提供技术对接支持吗？',
                    '室内定位精度能达到多少？',
                    '是否有按需付费的套餐？',
                    '地图数据更新频率是多久？',
                    '支持哪些开发语言的SDK？',
                    '如何集成到小程序中？',
                    '有没有免费试用期？',
                    '能否导出历史轨迹数据？'
                ];
                
                // 为每个问题生成随机提及次数 (8-60)
                const values = questions.map(() => Math.floor(Math.random() * 52) + 8);
                const combined = questions.map((name, index) => ({
                    name: name,
                    value: values[index]
                }));
                
                // 按值从高到低排序
                combined.sort((a, b) => b.value - a.value);
                
                // 只取前10个问题
                const top10 = combined.slice(0, 10);
                
                // 因为ECharts横向条形图Y轴是从下往上的，所以需要反转数组让最大值显示在最上面
                const sortedQuestions = top10.map(item => item.name).reverse();
                const sortedValues = top10.map(item => item.value).reverse();
                
                const option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        },
                        formatter: '{b}<br/>提及次数: {c}次'
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        top: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        boundaryGap: [0, 0.01],
                        axisLabel: {
                            fontSize: 11,
                            formatter: '{value}次'
                        }
                    },
                    yAxis: {
                        type: 'category',
                        data: sortedQuestions,
                        axisLabel: {
                            fontSize: 12,
                            interval: 0,
                            width: 200,
                            overflow: 'truncate',
                            ellipsis: '...'
                        },
                        axisTick: {
                            show: false
                        },
                        axisLine: {
                            show: false
                        }
                    },
                    series: [
                        {
                            name: '提及次数',
                            type: 'bar',
                            data: sortedValues,
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                    { offset: 0, color: '#faad14' },
                                    { offset: 1, color: '#ffd666' }
                                ]),
                                borderRadius: [0, 4, 4, 0]
                            },
                            barWidth: '50%',
                            label: {
                                show: true,
                                position: 'right',
                                formatter: '{c}次',
                                fontSize: 11,
                                color: '#666',
                                distance: 5
                            },
                            emphasis: {
                                itemStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                        { offset: 0, color: '#fa8c16' },
                                        { offset: 1, color: '#ffc53d' }
                                    ])
                                }
                            }
                        }
                    ]
                };
                
                myChart.setOption(option);
                window.addEventListener('resize', () => myChart.resize());
            };

            // 竞品提及次数条形图
            const initCompetitorMentionsChart = () => {
                const chartDom = document.getElementById('competitorMentionsChart');
                if (!chartDom) return;
                
                const myChart = echarts.init(chartDom);
                
                // 竞品地图产品
                const competitors = [
                    '高德地图',
                    '腾讯地图',
                    '谷歌地图',
                    '四维图新',
                    '凯立德',
                    '苹果地图',
                    '搜狗地图'
                ];
                
                // 为每个竞品生成随机提及次数 (10-80)
                const values = competitors.map(() => Math.floor(Math.random() * 70) + 10);
                const combined = competitors.map((name, index) => ({
                    name: name,
                    value: values[index]
                }));
                
                // 按值从高到低排序
                combined.sort((a, b) => b.value - a.value);
                
                // 因为ECharts横向条形图Y轴是从下往上的，所以需要反转数组让最大值显示在最上面
                const sortedCompetitors = combined.map(item => item.name).reverse();
                const sortedValues = combined.map(item => item.value).reverse();
                
                const option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        },
                        formatter: '{b}<br/>提及次数: {c}次'
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        top: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        boundaryGap: [0, 0.01],
                        axisLabel: {
                            fontSize: 11,
                            formatter: '{value}次'
                        }
                    },
                    yAxis: {
                        type: 'category',
                        data: sortedCompetitors,
                        axisLabel: {
                            fontSize: 13,
                            interval: 0,
                            fontWeight: 500
                        },
                        axisTick: {
                            show: false
                        },
                        axisLine: {
                            show: false
                        }
                    },
                    series: [
                        {
                            name: '提及次数',
                            type: 'bar',
                            data: sortedValues,
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                    { offset: 0, color: '#722ed1' },
                                    { offset: 1, color: '#b37feb' }
                                ]),
                                borderRadius: [0, 4, 4, 0]
                            },
                            barWidth: '60%',
                            label: {
                                show: true,
                                position: 'right',
                                formatter: '{c}次',
                                fontSize: 12,
                                fontWeight: 500,
                                color: '#666',
                                distance: 5
                            },
                            emphasis: {
                                itemStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                        { offset: 0, color: '#531dab' },
                                        { offset: 1, color: '#9254de' }
                                    ])
                                }
                            }
                        }
                    ]
                };
                
                myChart.setOption(option);
                window.addEventListener('resize', () => myChart.resize());
            };

            // 竞品对比卡片
            const initCompetitorComparisonCards = () => {
                const container = document.getElementById('competitorComparisonCards');
                if (!container) return;
                
                // 竞品对比数据
                const comparisons = [
                    {
                        competitor: '高德地图',
                        advantages: ['导航语音播报更人性化', '实时路况更新速度快', '避堵路线规划效果好'],
                        baiduWeakness: ['未提到']
                    },
                    {
                        competitor: '腾讯地图',
                        advantages: ['与微信生态深度集成', '街景数据覆盖广', '地点搜索结果丰富'],
                        baiduWeakness: ['与其他社交平台集成较弱']
                    },
                    {
                        competitor: '四维图新',
                        advantages: ['车载导航数据更新及时', '与汽车厂商合作深入', '车规级地图数据质量高'],
                        baiduWeakness: ['车载导航市场份额较小']
                    },
                    {
                        competitor: '凯立德',
                        advantages: ['离线地图包体积小', '导航算路速度快', '在三四线城市数据完善'],
                        baiduWeakness: ['未提到']
                    }
                ];
                
                container.innerHTML = `
                    <style>
                        #competitorComparisonCards::-webkit-scrollbar {
                            width: 6px;
                        }
                        #competitorComparisonCards::-webkit-scrollbar-track {
                            background: #f0f0f0;
                            border-radius: 3px;
                        }
                        #competitorComparisonCards::-webkit-scrollbar-thumb {
                            background: #bfbfbf;
                            border-radius: 3px;
                        }
                        #competitorComparisonCards::-webkit-scrollbar-thumb:hover {
                            background: #8c8c8c;
                        }
                    </style>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
                        ${comparisons.map(item => `
                            <div style="
                                background: #fff;
                                padding: 16px;
                                border-radius: 8px;
                                border: 1px solid #f0f0f0;
                                transition: all 0.3s;
                            " onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.08)'; this.style.borderColor='#d9d9d9';" onmouseout="this.style.boxShadow='none'; this.style.borderColor='#f0f0f0';">
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 8px;
                                    margin-bottom: 12px;
                                    padding-bottom: 12px;
                                    border-bottom: 2px solid #f0f0f0;
                                ">
                                    <div style="
                                        width: 8px;
                                        height: 8px;
                                        background: #722ed1;
                                        border-radius: 50%;
                                    "></div>
                                    <h4 style="
                                        font-size: 15px;
                                        font-weight: 600;
                                        color: #262626;
                                        margin: 0;
                                    ">${item.competitor}</h4>
                                </div>
                                
                                <div style="margin-bottom: 12px;">
                                    <div style="
                                        display: flex;
                                        align-items: center;
                                        gap: 6px;
                                        margin-bottom: 8px;
                                    ">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#52c41a" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                        <span style="
                                            font-size: 13px;
                                            font-weight: 500;
                                            color: #52c41a;
                                        ">竞品优势</span>
                                    </div>
                                    <ul style="
                                        margin: 0;
                                        padding-left: 20px;
                                        list-style: none;
                                    ">
                                        ${item.advantages.map(adv => `
                                            <li style="
                                                font-size: 13px;
                                                color: #595959;
                                                line-height: 1.8;
                                                position: relative;
                                                padding-left: 12px;
                                            ">
                                                <span style="
                                                    position: absolute;
                                                    left: 0;
                                                    top: 8px;
                                                    width: 4px;
                                                    height: 4px;
                                                    background: #52c41a;
                                                    border-radius: 50%;
                                                "></span>
                                                ${adv}
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                                
                                ${item.baiduWeakness.some(w => w !== '未提到') ? `
                                    <div>
                                        <div style="
                                            display: flex;
                                            align-items: center;
                                            gap: 6px;
                                            margin-bottom: 8px;
                                        ">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#ff4d4f" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                                            <span style="
                                                font-size: 13px;
                                                font-weight: 500;
                                                color: #ff4d4f;
                                            ">百度地图相对劣势</span>
                                        </div>
                                        <ul style="
                                            margin: 0;
                                            padding-left: 20px;
                                            list-style: none;
                                        ">
                                            ${item.baiduWeakness.filter(w => w !== '未提到').map(weak => `
                                                <li style="
                                                    font-size: 13px;
                                                    color: #595959;
                                                    line-height: 1.8;
                                                    position: relative;
                                                    padding-left: 12px;
                                                ">
                                                    <span style="
                                                        position: absolute;
                                                        left: 0;
                                                        top: 8px;
                                                        width: 4px;
                                                        height: 4px;
                                                        background: #ff4d4f;
                                                        border-radius: 50%;
                                                    "></span>
                                                    ${weak}
                                                </li>
                                            `).join('')}
                                        </ul>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            };

            // 应用场景 Top 10 条形图 - 随机生成场景数据
            const initScenarioBarChart = () => {
                const chartDom = document.getElementById('scenarioBarChart');
                if (!chartDom) return;
                
                const myChart = echarts.init(chartDom);
                
                // 随机生成10个地图应用场景
                const scenarios = [
                    '物流配送路线规划',
                    '共享单车位置追踪',
                    '外卖配送实时导航',
                    '智慧停车场导引',
                    '网约车乘客定位',
                    '快递末端配送优化',
                    '园区内部导航服务',
                    '景区游览路线推荐',
                    '商场室内定位导购',
                    '企业资产位置管理'
                ];
                
                // 生成随机数据并排序（由高到低）
                const values = scenarios.map(() => Math.floor(Math.random() * 80) + 20);
                const combined = scenarios.map((name, index) => ({
                    name: name,
                    value: values[index]
                }));
                
                // 按值从高到低排序
                combined.sort((a, b) => b.value - a.value);
                
                // 因为ECharts横向条形图Y轴是从下往上的，所以需要反转数组让最大值显示在最上面
                const sortedScenarios = combined.map(item => item.name).reverse();
                const sortedValues = combined.map(item => item.value).reverse();
                
                const option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        },
                        formatter: '{b}: {c}次'
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        boundaryGap: [0, 0.01],
                        axisLabel: {
                            fontSize: 11
                        }
                    },
                    yAxis: {
                        type: 'category',
                        data: sortedScenarios,
                        axisLabel: {
                            fontSize: 11,
                            interval: 0
                        }
                    },
                    series: [
                        {
                            name: '提及次数',
                            type: 'bar',
                            data: sortedValues,
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                                    { offset: 0, color: '#1890ff' },
                                    { offset: 1, color: '#36cfc9' }
                                ])
                            },
                            barWidth: '60%',
                            label: {
                                show: true,
                                position: 'right',
                                formatter: '{c}',
                                fontSize: 11,
                                color: '#666'
                            }
                        }
                    ]
                };
                myChart.setOption(option);
                
                // 响应式调整
                window.addEventListener('resize', () => myChart.resize());
            };
            
            // 刷新功能
            const handleRefresh = () => {
                const now = new Date();
                const timeStr = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
                setRefreshTime(timeStr);
                message.success('刷新成功');
            };
            
            // 智能外呼记录数据 (60条记录)
            const outboundCallRecords = [
                {
                    key: 'call_1',
                    callId: '2026020001',
                    leadId: '2026010123',
                    uid: '1001234567',
                    contactName: '张伟',
                    calleeNumber: '138****1234',
                    taskName: '线索唤醒-一轮外呼（工作日）',
                    robotName: '小度外呼-标准版',
                    smsTriggered: '是',
                    callStartTime: '2026/01/22 10:12:08',
                    callDuration: '2分18秒',
                    callEndTime: '2026/01/22 10:14:26',
                    connectStatus: '已接通',
                    noConnectReason: '-',
                    recordingUrl: 'https://www2.cs.uic.edu/~i101/SoundFiles/BabyElephantWalk60.wav',
                    aiTags: {
                        callAgain: '是',
                        businessScene: '物流配送路线规划',
                        overallIntent: '高',
                        competitorInfo: '提到了高德地图',
                        positiveFeedback: '接口响应速度快, 文档详细易懂',
                        negativeFeedback: '部分地区POI数据不够准确',
                        continueReason: '项目急需地图服务, 免费额度满足当前需求',
                        projectStatus: '企业项目',
                        noCommercialReason: '目前处于测试阶段, 暂时使用免费额度',
                        industry: '物流运输',
                        budget: '5万-10万元'
                    },
                    pendingQuestions: [
                        '1. 如何批量导入大量POI数据到地图中？',
                        '2. 是否支持实时路况的API调用？',
                        '3. 商用授权的具体费用标准是什么？'
                    ]
                },
                {
                    key: 'call_2',
                    callId: '2026020002',
                    leadId: '2026010124',
                    uid: '1001234568',
                    contactName: '李强',
                    calleeNumber: '186****5566',
                    taskName: '线索唤醒-二轮外呼（未接通重拨）',
                    robotName: '小度外呼-标准版',
                    smsTriggered: '否',
                    callStartTime: '2026/01/23 15:32:41',
                    callDuration: '0分00秒',
                    callEndTime: '2026/01/23 15:32:41',
                    connectStatus: '未接通',
                    noConnectReason: '无人接听',
                    recordingUrl: '',
                    aiTags: {
                        callAgain: '否',
                        businessScene: '餐饮外卖配送',
                        overallIntent: '低',
                        competitorInfo: '未提到竞品',
                        positiveFeedback: '定位精度不错',
                        negativeFeedback: '价格偏高',
                        continueReason: '定位服务基本满足需求',
                        projectStatus: '个人创业',
                        noCommercialReason: '预算有限，优先考虑成本',
                        industry: '餐饮外卖',
                        budget: '1万-3万元'
                    },
                    pendingQuestions: [
                        '1. 免费额度用完后如何计费？',
                        '2. 是否支持配送员轨迹回放功能？'
                    ]
                },
                // ... (可以继续添加更多记录，目前先保持少量以确保正常运行)
                {
                    key: 'call_30',
                    callId: '2026020030',
                    leadId: '2026010154',
                    uid: '1001234597',
                    contactName: '周洁',
                    calleeNumber: '189****0432',
                    taskName: '线索唤醒-三轮外呼（晚间）',
                    robotName: '小度外呼-夜间专用',
                    smsTriggered: '否',
                    callStartTime: '2026/01/26 19:31:05',
                    callDuration: '0分00秒',
                    callEndTime: '2026/01/26 19:31:05',
                    connectStatus: '未接通',
                    noConnectReason: '关机',
                    recordingUrl: '',
                    aiTags: {
                        callAgain: '是',
                        businessScene: '校园导航服务',
                        overallIntent: '较低',
                        competitorInfo: '未明确提及',
                        positiveFeedback: '室内定位精度好',
                        negativeFeedback: '室外信号不稳定',
                        continueReason: '教育场景特殊需求',
                        projectStatus: '高校科研项目',
                        noCommercialReason: '学术研究用途',
                        industry: '教育',
                        budget: '未提及'
                    },
                    pendingQuestions: []
                }
            ];
            
            // 修改后的transformedRecords使用本地数据，确保不少于50条
            // 使用 useMemo 缓存数据，避免重复渲染时重新生成
            const transformedRecords = useMemo(() => {
                const baseRecords = [...outboundCallRecords];
                const extraRecords = [];
                
                const names = ['刘明','陈静','王磊','张敏','李娜','赵强','孙丽','周勇','吴娟','郑涛','王秀英','李建国','张丽华','刘志强','陈晓红','杨军','黄伟','周丽','吴刚','徐敏','孙强','胡芳','朱勇','高丽','林涛','何敏','郭强','马丽','罗勇','梁娟'];
                const tasks = ['线索唤醒','商用授权提醒','资料补充','新产品推广'];
                const robots = ['小度外呼-标准版','小度外呼-增强版','小度外呼-夜间专用'];
                const reasons = ['无人接听', '关机', '停机', '占线'];
                
                // 配置多个真实的音频URL（5-15秒的测试音频）
                const audioUrls = [
                    'https://www2.cs.uic.edu/~i101/SoundFiles/BabyElephantWalk60.wav',
                    'https://www2.cs.uic.edu/~i101/SoundFiles/CantinaBand60.wav',
                    'https://www2.cs.uic.edu/~i101/SoundFiles/ImperialMarch60.wav',
                    'https://www2.cs.uic.edu/~i101/SoundFiles/StarWars60.wav',
                    'https://www2.cs.uic.edu/~i101/SoundFiles/PinkPanther60.wav'
                ];
                
                for (let i = 0; i < 30; i++) {
                    const isConnected = Math.random() > 0.3;
                    const hasRecording = Math.random() > 0.3;
                    
                    // 确保关键字段不为空
                    const callId = `${2026020031 + i}`;
                    const leadId = `${2026010155 + i}`;
                    const uid = `${1001234598 + i}`;
                    
                    extraRecords.push({
                        key: `extra_record_${i + 1}`,
                        callId: callId,
                        leadId: leadId,
                        uid: uid,
                        contactName: names[i] || `联系人${i + 1}`,
                        calleeNumber: `${Math.floor(Math.random() * 9000 + 1000)}****${Math.floor(Math.random() * 9000 + 1000)}`,
                        taskName: tasks[Math.floor(Math.random() * tasks.length)] || '默认外呼任务',
                        robotName: robots[Math.floor(Math.random() * robots.length)] || '默认机器人',
                        smsTriggered: Math.random() > 0.5 ? '是' : '否',
                        callStartTime: `2026/01/${Math.floor(Math.random() * 30) + 1} ${Math.floor(Math.random() * 24)}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`,
                        callDuration: `${Math.floor(Math.random() * 5)}分${Math.floor(Math.random() * 60)}秒`,
                        callEndTime: `2026/01/${Math.floor(Math.random() * 30) + 1} ${Math.floor(Math.random() * 24)}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`,
                        connectStatus: isConnected ? '已接通' : '未接通',
                        noConnectReason: isConnected ? '-' : reasons[Math.floor(Math.random() * reasons.length)] || '未知原因',
                        recordingUrl: hasRecording && isConnected ? audioUrls[i % audioUrls.length] : '',
                        aiTags: {
                            businessScene: '测试场景',
                            overallIntent: '中等',
                            industry: '测试行业'
                        },
                        pendingQuestions: []
                    });
                }
                
                return [...baseRecords, ...extraRecords];
            }, []); // 空依赖数组确保只计算一次
            
            // 通话录音转文字数据 - 使用更真实的多轮对话
            const callTranscripts = {
                call_1: [
                    { id: 1, role: 'robot', time: '2026/01/22 10:12:08', text: '您好，这里是百度地图开放平台客户服务中心。我们关注到贵公司正在使用我们的地图服务，现在做一个简单的回访，大约需要3分钟时间。请问您是负责地图接入的同事吗？' },
                    { id: 2, role: 'customer', time: '2026/01/22 10:12:14', text: '嗯，我这边是负责地图接口这块的，您说。' },
                    { id: 3, role: 'robot', time: '2026/01/22 10:12:20', text: '好的感谢您，我简单确认一下信息。现在是以公司名义在做接入，对吗？还是您个人在做一个小项目？' },
                    { id: 4, role: 'customer', time: '2026/01/22 10:12:27', text: '是公司项目，在我们技术部这边统一做地图接入。' },
                    { id: 5, role: 'robot', time: '2026/01/22 10:12:34', text: '明白，那目前百度地图主要是用在什么业务场景上呢？比如车辆定位、配送路线规划，还是门店位置查询之类的？' },
                    { id: 6, role: 'customer', time: '2026/01/22 10:12:43', text: '主要是做智能配送，司机端要看实时位置和路线规划，另外我们官网也有门店查询。' },
                    { id: 7, role: 'robot', time: '2026/01/22 10:12:52', text: '了解，物流配送加门店查询这个场景还是挺典型的。那目前一直在稳定调用百度地图，方便您整体评价一下吗？大概是哪一两个点，让您觉得可以一直用下去？' },
                    { id: 8, role: 'customer', time: '2026/01/22 10:13:01', text: '主要是比较稳定吧，我们线上跑了一年多没出过什么大问题，文档也还算清楚。' },
                    { id: 9, role: 'robot', time: '2026/01/22 10:13:10', text: '好的，那在接入过程中，具体哪一块体验会让您觉得比较好？比如是上手简单、文档示例多，还是接口稳定性、响应速度之类的？' },
                    { id: 10, role: 'customer', time: '2026/01/22 10:13:19', text: '定位和路径规划接口比较关键，这块我们感觉稳定性还不错，另外文档里有示例代码，新人上手会轻松一点。' },
                    { id: 11, role: 'robot', time: '2026/01/22 10:13:29', text: '谢谢您的反馈。那在当前使用过程中，有没有遇到过什么问题或者有改进建议？' },
                    { id: 12, role: 'customer', time: '2026/01/22 10:13:37', text: '有些地区的POI数据可能更新不够及时，配送员反馈有些新门店在地图上找不到。' },
                    { id: 13, role: 'robot', time: '2026/01/22 10:13:46', text: '这个问题我们一直在持续优化。另外关于商用授权的考虑，目前有计划升级吗？' },
                    { id: 14, role: 'customer', time: '2026/01/22 10:13:57', text: '等现在这个项目稳定了会考虑，主要是想先看看效果。' },
                    { id: 15, role: 'robot', time: '2026/01/22 10:14:06', text: '好的明白，我这边会帮您记录这个需求。感谢您的宝贵时间，如果有任何问题随时联系我们。' },
                    { id: 16, role: 'customer', time: '2026/01/22 10:14:14', text: '好的，谢谢。' },
                    { id: 17, role: 'robot', time: '2026/01/22 10:14:19', text: '不客气，祝您工作顺利，再见！' }
                ],
                call_2: [
                    { id: 1, role: 'robot', time: '2026/01/23 15:32:41', text: '您好，我是百度地图的商务顾问小李。看到您之前咨询过我们的API服务，现在想了解一下您的具体需求，我们可以提供更精准的解决方案。' },
                    { id: 2, role: 'customer', time: '2026/01/23 15:32:48', text: '哦你好，我想问一下你们的地图API在高并发情况下性能怎么样？' },
                    { id: 3, role: 'robot', time: '2026/01/23 15:32:55', text: '我们针对高并发场景做了专门优化，标准版支持1000QPS，企业版可以达到10000QPS。您预计的并发量大概在什么范围？' },
                    { id: 4, role: 'customer', time: '2026/01/23 15:33:03', text: '高峰期可能达到5000左右，平时2000左右。' },
                    { id: 5, role: 'robot', time: '2026/01/23 15:33:12', text: '那建议您考虑企业版套餐，性价比更高。除了并发量，还有其他特别关注的功能吗？' },
                    { id: 6, role: 'customer', time: '2026/01/23 15:33:21', text: '主要是路径规划算法的准确性，还有就是海外地区的覆盖情况。' },
                    { id: 7, role: 'robot', time: '2026/01/23 15:33:30', text: '我们的路径规划算法在国内准确率超过98%，海外主要覆盖亚太和欧美地区。可以安排技术同事给您做个详细的演示。' },
                    { id: 8, role: 'customer', time: '2026/01/23 15:33:39', text: '好的，那先这样，我跟团队商量一下再联系你。' },
                    { id: 9, role: 'robot', time: '2026/01/23 15:33:46', text: '没问题，这是我的名片，随时欢迎咨询。祝您工作愉快！' }
                ],
                call_3: [
                    { id: 1, role: 'robot', time: '2026/01/24 09:15:22', text: '早上好，这里是百度地图开放平台。我们注意到您最近频繁调用我们的地理编码接口，想了解一下使用体验如何？' },
                    { id: 2, role: 'customer', time: '2026/01/24 09:15:29', text: '确实用得比较多，主要是地址标准化的需求。' },
                    { id: 3, role: 'robot', time: '2026/01/24 09:15:36', text: '明白了，那在使用过程中有没有遇到什么技术难点？我们可以提供相应的技术支持。' },
                    { id: 4, role: 'customer', time: '2026/01/24 09:15:43', text: '有时候批量处理会有超时的情况，特别是在处理大量历史数据的时候。' },
                    { id: 5, role: 'robot', time: '2026/01/24 09:15:52', text: '这个情况我们建议使用异步批量处理接口，可以大大提高效率。我可以安排技术同事给您详细介绍一下。' },
                    { id: 6, role: 'customer', time: '2026/01/24 09:16:01', text: '好的，那就麻烦安排一下，我们确实需要优化这块的处理效率。' },
                    { id: 7, role: 'robot', time: '2026/01/24 09:16:08', text: '没问题，我会尽快协调技术人员联系您。另外，关于商用授权方面有什么考虑吗？' },
                    { id: 8, role: 'customer', time: '2026/01/24 09:16:17', text: '这个我们也在评估中，先把手头的项目做好再说。' },
                    { id: 9, role: 'robot', time: '2026/01/24 09:16:24', text: '好的，理解。有任何技术问题随时联系我们，祝您工作顺利！' }
                ],
                call_4: [
                    { id: 1, role: 'robot', time: '2026/01/25 14:22:15', text: '您好，我是百度地图的技术支持工程师。看到您昨天提交了一个关于路径规划返回结果的问题工单，现在来跟进一下处理进度。' },
                    { id: 2, role: 'customer', time: '2026/01/25 14:22:22', text: '哦好的，请问现在有进展了吗？' },
                    { id: 3, role: 'robot', time: '2026/01/25 14:22:29', text: '是的，我们已经定位到问题是由于特定区域的道路数据更新延迟导致的。技术团队已经在紧急处理，预计今天下午就能完成数据同步。' },
                    { id: 4, role: 'customer', time: '2026/01/25 14:22:38', text: '太好了，那对我们业务的影响应该很快就能消除。' },
                    { id: 5, role: 'robot', time: '2026/01/25 14:22:46', text: '是的，我们会持续监控这个问题直到完全解决。另外，为了预防类似问题，建议您开启我们的异常告警功能。' },
                    { id: 6, role: 'customer', time: '2026/01/25 14:22:55', text: '这个功能怎么配置？' },
                    { id: 7, role: 'robot', time: '2026/01/25 14:23:02', text: '很简单，可以在开发者后台的服务监控页面找到相关设置，我可以稍后把详细的操作文档发给您。' },
                    { id: 8, role: 'customer', time: '2026/01/25 14:23:11', text: '好的，那就麻烦你了。' },
                    { id: 9, role: 'robot', time: '2026/01/25 14:23:18', text: '不客气，这是我应该做的。如果还有其他问题随时联系我。' }
                ],
                call_5: [
                    { id: 1, role: 'robot', time: '2026/01/26 11:08:33', text: '您好，这里是百度地图商务拓展部。了解到贵公司在智能出行领域有很好的发展前景，我们希望能为您提供更专业的地图服务支持。' },
                    { id: 2, role: 'customer', time: '2026/01/26 11:08:40', text: '嗯，我们现在确实在做一些出行相关的项目。' },
                    { id: 3, role: 'robot', time: '2026/01/26 11:08:47', text: '那太好了。我们针对出行场景推出了专门的解决方案包，包括实时定位、智能路线推荐、交通状况预测等功能。' },
                    { id: 4, role: 'customer', time: '2026/01/26 11:08:56', text: '听起来不错，具体是怎么收费的？' },
                    { id: 5, role: 'robot', time: '2026/01/26 11:09:03', text: '我们有不同的套餐选择，基础版每月999元起，包含50万次调用。企业定制版可以根据您的具体需求灵活定价。' },
                    { id: 6, role: 'customer', time: '2026/01/26 11:09:12', text: '我们现在调用量大概在30万次左右，增长也比较快。' },
                    { id: 7, role: 'robot', time: '2026/01/26 11:09:21', text: '那建议您直接考虑企业定制版，我们可以根据您的业务量提供最优的价格方案，还能享受专属的技术支持服务。' },
                    { id: 8, role: 'customer', time: '2026/01/26 11:09:30', text: '好的，这个我需要跟财务部门确认一下预算。' },
                    { id: 9, role: 'robot', time: '2026/01/26 11:09:37', text: '完全理解，我可以先把详细的产品介绍和报价方案发给您参考。您看什么时候方便我们安排一个产品演示？' },
                    { id: 10, role: 'customer', time: '2026/01/26 11:09:46', text: '下周吧，我先内部讨论一下再回复你。' },
                    { id: 11, role: 'robot', time: '2026/01/26 11:09:53', text: '好的，没问题。期待与您的进一步合作，祝您工作愉快！' }
                ],
                extra_record_1: [
                    { id: 1, role: 'robot', time: '2026/01/20 09:15:30', text: '您好，这里是百度地图开放平台。看到您最近一直在使用我们的路径规划API，想了解一下使用体验如何？' },
                    { id: 2, role: 'customer', time: '2026/01/20 09:15:38', text: '还可以吧，基本能满足需求。' },
                    { id: 3, role: 'robot', time: '2026/01/20 09:15:45', text: '那在使用过程中有遇到什么问题吗？比如响应速度、准确率方面。' },
                    { id: 4, role: 'customer', time: '2026/01/20 09:15:53', text: '偶尔会有超时的情况，不过不算频繁。' },
                    { id: 5, role: 'robot', time: '2026/01/20 09:16:02', text: '明白了，超时问题我们会记录跟进。另外想了解一下，您的业务场景主要是什么方向？' },
                    { id: 6, role: 'customer', time: '2026/01/20 09:16:11', text: '我们是做同城配送的，需要实时规划最优路线。' },
                    { id: 7, role: 'robot', time: '2026/01/20 09:16:20', text: '那很适合我们的企业版服务，有专门针对物流配送优化的算法，而且稳定性更好。' },
                    { id: 8, role: 'customer', time: '2026/01/20 09:16:29', text: '好的，我考虑一下，有需要再联系你们。' }
                ],
                extra_record_2: [
                    { id: 1, role: 'robot', time: '2026/01/21 14:22:15', text: '您好，我是百度地图的客户经理小张。注意到您的应用最近调用量增长很快，想跟您聊聊升级方案。' },
                    { id: 2, role: 'customer', time: '2026/01/21 14:22:23', text: '是的，我们业务确实在快速增长。' },
                    { id: 3, role: 'robot', time: '2026/01/21 14:22:30', text: '这是好事！目前您用的是免费版，月调用量限制是10万次。您上个月已经接近8万次了，建议提前规划升级，避免影响业务。' },
                    { id: 4, role: 'customer', time: '2026/01/21 14:22:40', text: '嗯，确实需要考虑了。你们的付费版本怎么收费？' },
                    { id: 5, role: 'robot', time: '2026/01/21 14:22:49', text: '我们有几个档位，基础版月费499元包含30万次调用，标准版999元包含100万次。您预计月调用量会到多少？' },
                    { id: 6, role: 'customer', time: '2026/01/21 14:22:58', text: '估计会到50万左右吧。' },
                    { id: 7, role: 'robot', time: '2026/01/21 14:23:07', text: '那标准版会更合适，而且单价更优惠。我可以给您发一份详细的产品对比和报价。' },
                    { id: 8, role: 'customer', time: '2026/01/21 14:23:16', text: '行，你发给我看看，我们内部讨论一下。' },
                    { id: 9, role: 'robot', time: '2026/01/21 14:23:23', text: '好的，稍后发到您的邮箱。有任何问题随时联系我。' }
                ],
                extra_record_3: [
                    { id: 1, role: 'robot', time: '2026/01/22 16:30:45', text: '您好，百度地图开放平台回访。看到您前几天提交了一个技术支持工单，问题解决了吗？' },
                    { id: 2, role: 'customer', time: '2026/01/22 16:30:52', text: '已经解决了，你们技术支持响应还挺快的。' },
                    { id: 3, role: 'robot', time: '2026/01/22 16:30:59', text: '太好了！这次主要是什么问题呢？' },
                    { id: 4, role: 'customer', time: '2026/01/22 16:31:07', text: '就是坐标转换的问题，文档上没写清楚，后来你们工程师帮我看了下就搞定了。' },
                    { id: 5, role: 'robot', time: '2026/01/22 16:31:16', text: '明白了，我会反馈给文档团队完善这部分内容。目前业务运行正常吗？' },
                    { id: 6, role: 'customer', time: '2026/01/22 16:31:25', text: '正常的，就是数据量大的时候有点慢。' },
                    { id: 7, role: 'robot', time: '2026/01/22 16:31:34', text: '批量请求的话建议使用异步接口，会快很多。需要的话我可以安排技术同事给您做个优化方案。' },
                    { id: 8, role: 'customer', time: '2026/01/22 16:31:43', text: '可以啊，那就麻烦帮我安排一下。' }
                ],
                extra_record_4: [
                    { id: 1, role: 'robot', time: '2026/01/23 10:45:20', text: '您好，我是百度地图商务部的小李。了解到您公司在开发一款出行类APP，我们想提供一些技术支持。' },
                    { id: 2, role: 'customer', time: '2026/01/23 10:45:28', text: '嗯，我们确实在做这方面。' },
                    { id: 3, role: 'robot', time: '2026/01/23 10:45:35', text: '太好了。方便了解一下您APP的核心功能吗？比如是打车、导航还是其他场景？' },
                    { id: 4, role: 'customer', time: '2026/01/23 10:45:44', text: '主要是共享单车，需要地图上显示单车位置，还有骑行导航。' },
                    { id: 5, role: 'robot', time: '2026/01/23 10:45:53', text: '明白了，这个场景我们有成熟的解决方案。包括实时定位、骑行路线规划、POI展示等，而且针对共享出行有专门的优惠政策。' },
                    { id: 6, role: 'customer', time: '2026/01/23 10:46:02', text: '优惠政策具体是什么样的？' },
                    { id: 7, role: 'robot', time: '2026/01/23 10:46:11', text: '对于出行类创业公司，前6个月我们提供200万次免费调用额度，之后享受8折优惠。' },
                    { id: 8, role: 'customer', time: '2026/01/23 10:46:20', text: '这个挺不错的，你们能提供技术对接支持吗？' },
                    { id: 9, role: 'robot', time: '2026/01/23 10:46:29', text: '当然可以，我们有专门的技术团队协助接入，还提供示例代码和最佳实践文档。' },
                    { id: 10, role: 'customer', time: '2026/01/23 10:46:38', text: '那行，你把相关资料发给我，我们评估一下。' }
                ],
                extra_record_5: [
                    { id: 1, role: 'robot', time: '2026/01/24 13:20:10', text: '您好，百度地图客服回访。您昨天反馈的地图数据不准确问题，我们已经更新了，请问现在查看正常吗？' },
                    { id: 2, role: 'customer', time: '2026/01/24 13:20:18', text: '我看看...嗯，确实更新了，现在显示正确了。' },
                    { id: 3, role: 'robot', time: '2026/01/24 13:20:25', text: '太好了。这次是哪个区域的数据问题？' },
                    { id: 4, role: 'customer', time: '2026/01/24 13:20:33', text: '北京朝阳区那边几个新开的商场，之前搜不到，现在可以了。' },
                    { id: 5, role: 'robot', time: '2026/01/24 13:20:42', text: '明白了。我们的POI数据每周都会更新，新开业的场所可能会有1-2周的延迟。如果遇到特别急需的，可以直接联系我们加急处理。' },
                    { id: 6, role: 'customer', time: '2026/01/24 13:20:51', text: '好的，知道了。对了，你们的室内地图功能怎么样？' },
                    { id: 7, role: 'robot', time: '2026/01/24 13:21:00', text: '我们的室内地图覆盖了全国主要商场、机场、高铁站等场所。如果您有特定需求，可以申请定制化室内地图服务。' },
                    { id: 8, role: 'customer', time: '2026/01/24 13:21:09', text: '行，我们可能会需要，到时候联系你们。' }
                ],
                extra_record_6: [
                    { id: 1, role: 'robot', time: '2026/01/25 09:30:15', text: '您好，我是百度地图开放平台的产品顾问。看到您最近在使用我们的地图SDK，想了解一下集成过程中有什么问题吗？' },
                    { id: 2, role: 'customer', time: '2026/01/25 09:30:23', text: '暂时还好，就是文档有些地方看不太明白。' },
                    { id: 3, role: 'robot', time: '2026/01/25 09:30:31', text: '具体是哪部分呢？我可以帮您详细解释一下。' },
                    { id: 4, role: 'customer', time: '2026/01/25 09:30:40', text: '主要是自定义地图样式这块，想做一些个性化的展示效果。' },
                    { id: 5, role: 'robot', time: '2026/01/25 09:30:49', text: '明白了。我们提供了在线样式编辑器，您可以直接可视化配置地图颜色、标注样式等。需要的话我可以给您发一个详细的教程。' },
                    { id: 6, role: 'customer', time: '2026/01/25 09:30:58', text: '那太好了，麻烦发给我看看。另外，我们想在地图上显示实时交通信息。' },
                    { id: 7, role: 'robot', time: '2026/01/25 09:31:07', text: '实时交通图层是我们的一个特色功能，覆盖全国主要城市。调用很简单，只需要一行代码就可以开启。' },
                    { id: 8, role: 'customer', time: '2026/01/25 09:31:16', text: '这个收费吗？' },
                    { id: 9, role: 'robot', time: '2026/01/25 09:31:25', text: '基础版用户免费使用，企业版用户可以获取更高频次的交通数据更新。' },
                    { id: 10, role: 'customer', time: '2026/01/25 09:31:34', text: '好的，我先试试基础版，有问题再联系你。' },
                    { id: 11, role: 'robot', time: '2026/01/25 09:31:42', text: '没问题，随时欢迎咨询。祝您开发顺利！' }
                ],
                extra_record_7: [
                    { id: 1, role: 'robot', time: '2026/01/25 14:15:20', text: '您好，百度地图技术支持团队。注意到您的应用最近遇到了一些调用失败的情况，想帮您排查一下。' },
                    { id: 2, role: 'customer', time: '2026/01/25 14:15:28', text: '是的，昨天晚上有一段时间接口一直返回错误。' },
                    { id: 3, role: 'robot', time: '2026/01/25 14:15:37', text: '我看了一下日志，主要是因为您的访问频率超过了当前配额限制。您目前用的是免费版，每分钟限制100次调用。' },
                    { id: 4, role: 'customer', time: '2026/01/25 14:15:46', text: '哦，原来是这样。那我们业务高峰期确实会超过这个数。' },
                    { id: 5, role: 'robot', time: '2026/01/25 14:15:55', text: '理解。建议您升级到付费版本，标准版每分钟可以调用1000次，而且有更好的稳定性保障。' },
                    { id: 6, role: 'customer', time: '2026/01/25 14:16:04', text: '升级需要多少费用？' },
                    { id: 7, role: 'robot', time: '2026/01/25 14:16:13', text: '标准版月费999元，包含100万次调用量。按您目前的使用情况，这个套餐应该足够了。' },
                    { id: 8, role: 'customer', time: '2026/01/25 14:16:22', text: '好的，我跟老板申请一下预算。对了，升级后会立即生效吗？' },
                    { id: 9, role: 'robot', time: '2026/01/25 14:16:31', text: '是的，付款成功后立即生效，不会影响您的业务运行。' },
                    { id: 10, role: 'customer', time: '2026/01/25 14:16:40', text: '那我尽快处理，谢谢你的帮助。' }
                ],
                extra_record_8: [
                    { id: 1, role: 'robot', time: '2026/01/26 10:20:35', text: '您好，这里是百度地图开放平台。看到您的应用在使用我们的逆地理编码服务，体验如何？' },
                    { id: 2, role: 'customer', time: '2026/01/26 10:20:43', text: '整体还不错，就是有时候返回的地址不够详细。' },
                    { id: 3, role: 'robot', time: '2026/01/26 10:20:52', text: '您说的不够详细具体是指什么？是缺少门牌号，还是地址描述不准确？' },
                    { id: 4, role: 'customer', time: '2026/01/26 10:21:01', text: '主要是偏远地区的地址，有时候只能定位到镇级，没有更详细的街道信息。' },
                    { id: 5, role: 'robot', time: '2026/01/26 10:21:10', text: '明白了。偏远地区确实因为POI数据相对稀疏，详细程度会有限制。我们正在持续完善这部分数据。' },
                    { id: 6, role: 'customer', time: '2026/01/26 10:21:19', text: '有没有什么解决方案？我们的业务对地址准确性要求比较高。' },
                    { id: 7, role: 'robot', time: '2026/01/26 10:21:28', text: '您可以尝试使用我们的地址智能补全接口，结合用户输入来提高地址准确度。另外，我们也支持自定义POI数据上传。' },
                    { id: 8, role: 'customer', time: '2026/01/26 10:21:37', text: '自定义POI听起来不错，怎么操作？' },
                    { id: 9, role: 'robot', time: '2026/01/26 10:21:46', text: '您可以在开发者后台提交POI数据，我们审核通过后会添加到您的专属地图服务中。这个功能企业版用户可以免费使用。' },
                    { id: 10, role: 'customer', time: '2026/01/26 10:21:55', text: '好的，我研究一下这个功能。谢谢！' },
                    { id: 11, role: 'robot', time: '2026/01/26 10:22:03', text: '不客气。有任何问题随时联系我们，祝您使用愉快！' }
                ],
                extra_record_9: [
                    { id: 1, role: 'robot', time: '2026/01/26 15:45:20', text: '您好，我是百度地图的客户成功经理。看到您最近升级到了企业版，想了解一下使用感受如何？' },
                    { id: 2, role: 'customer', time: '2026/01/26 15:45:28', text: '挺好的，调用量和并发都提升了，业务运行很稳定。' },
                    { id: 3, role: 'robot', time: '2026/01/26 15:45:37', text: '太好了！那有没有什么新的功能需求，或者希望我们改进的地方？' },
                    { id: 4, role: 'customer', time: '2026/01/26 15:45:46', text: '嗯，我们想做一个热力图，显示用户的活跃区域分布。' },
                    { id: 5, role: 'robot', time: '2026/01/26 15:45:55', text: '这个需求很常见。我们的热力图组件支持多种数据可视化方式，包括点热力图和网格热力图。' },
                    { id: 6, role: 'customer', time: '2026/01/26 15:46:04', text: '听起来不错。实现起来复杂吗？' },
                    { id: 7, role: 'robot', time: '2026/01/26 15:46:13', text: '不复杂，我们提供了详细的示例代码和在线演示。您只需要准备好数据，调用相应的API就可以生成热力图。' },
                    { id: 8, role: 'customer', time: '2026/01/26 15:46:22', text: '那我们团队研究一下。另外，你们有专门的技术支持服务吗？' },
                    { id: 9, role: 'robot', time: '2026/01/26 15:46:31', text: '企业版用户享有专属的技术支持通道，可以优先获得工程师的帮助。我把技术支持的联系方式发给您。' },
                    { id: 10, role: 'customer', time: '2026/01/26 15:46:40', text: '太好了，非常感谢！' }
                ],
                extra_record_10: [
                    { id: 1, role: 'robot', time: '2026/01/27 09:10:15', text: '您好，百度地图售后服务中心。您昨天反馈的SDK集成问题，我们的工程师已经找到解决方案了。' },
                    { id: 2, role: 'customer', time: '2026/01/27 09:10:23', text: '太好了！是什么问题导致的？' },
                    { id: 3, role: 'robot', time: '2026/01/27 09:10:32', text: '主要是您的项目使用的是比较老的SDK版本，和最新的系统API有兼容性问题。我们建议升级到最新版本。' },
                    { id: 4, role: 'customer', time: '2026/01/27 09:10:41', text: '升级会不会影响现有功能？我们项目已经上线了。' },
                    { id: 5, role: 'robot', time: '2026/01/27 09:10:50', text: '新版本完全向下兼容，不会影响现有功能。而且新版本修复了很多已知问题，性能也有提升。' },
                    { id: 6, role: 'customer', time: '2026/01/27 09:10:59', text: '那就好。升级需要改很多代码吗？' },
                    { id: 7, role: 'robot', time: '2026/01/27 09:11:08', text: '基本上只需要更新SDK包，代码改动很少。我们准备了详细的升级指南，还有迁移工具可以自动检查兼容性。' },
                    { id: 8, role: 'customer', time: '2026/01/27 09:11:17', text: '好的，那我们安排时间升级。大概需要多长时间？' },
                    { id: 9, role: 'robot', time: '2026/01/27 09:11:26', text: '一般半天就能完成，建议您在业务低峰期进行。升级过程中如果遇到问题，随时联系我们。' },
                    { id: 10, role: 'customer', time: '2026/01/27 09:11:35', text: '明白了，谢谢你们的支持！' },
                    { id: 11, role: 'robot', time: '2026/01/27 09:11:43', text: '不客气，祝您升级顺利！' }
                ],
                extra_record_11: [
                    { id: 1, role: 'robot', time: '2026/01/27 14:30:20', text: '您好，我是百度地图的行业解决方案专家。了解到您在做物联网相关的项目，我们有一些针对性的服务想和您介绍。' },
                    { id: 2, role: 'customer', time: '2026/01/27 14:30:28', text: '哦？什么服务？' },
                    { id: 3, role: 'robot', time: '2026/01/27 14:30:37', text: '我们针对物联网设备提供了轻量级的定位SDK，专门优化了功耗和流量消耗，特别适合电池供电的设备。' },
                    { id: 4, role: 'customer', time: '2026/01/27 14:30:46', text: '这个有意思。我们确实有很多传感器设备需要定位。' },
                    { id: 5, role: 'robot', time: '2026/01/27 14:30:55', text: '那正好。我们的物联网定位服务支持多种网络环境，包括4G、NB-IoT等，精度可以达到10米以内。' },
                    { id: 6, role: 'customer', time: '2026/01/27 14:31:04', text: '精度还不错。价格怎么算？' },
                    { id: 7, role: 'robot', time: '2026/01/27 14:31:13', text: '按设备数量和定位频次收费，有包年套餐和按量付费两种模式。对于大批量设备，我们还有额外的折扣。' },
                    { id: 8, role: 'customer', time: '2026/01/27 14:31:22', text: '我们大概有5000台设备，每天定位一次。' },
                    { id: 9, role: 'robot', time: '2026/01/27 14:31:31', text: '这个规模建议选择包年套餐，会更划算。我给您做个详细的报价方案，您看什么时候方便详谈？' },
                    { id: 10, role: 'customer', time: '2026/01/27 14:31:40', text: '明天下午吧，你们可以来我们公司现场沟通。' },
                    { id: 11, role: 'robot', time: '2026/01/27 14:31:49', text: '好的，我会提前准备好相关资料。明天见！' }
                ],
                extra_record_12: [
                    { id: 1, role: 'robot', time: '2026/01/28 10:15:30', text: '您好，百度地图客服回访。看到您提交了一个关于批量地理编码的咨询，想详细了解一下您的需求。' },
                    { id: 2, role: 'customer', time: '2026/01/28 10:15:38', text: '是这样的，我们有大量的地址数据需要转换成经纬度坐标。' },
                    { id: 3, role: 'robot', time: '2026/01/28 10:15:47', text: '明白了。大概有多少条地址数据需要处理？' },
                    { id: 4, role: 'customer', time: '2026/01/28 10:15:56', text: '初步估计有10万条左右，而且每个月还会新增几千条。' },
                    { id: 5, role: 'robot', time: '2026/01/28 10:16:05', text: '这个数量级建议使用我们的批量处理服务，可以一次性提交大量地址，系统会异步处理并返回结果。' },
                    { id: 6, role: 'customer', time: '2026/01/28 10:16:14', text: '处理速度怎么样？我们希望能尽快完成。' },
                    { id: 7, role: 'robot', time: '2026/01/28 10:16:23', text: '批量服务每秒可以处理1000条地址，10万条大概2分钟就能完成。而且准确率在95%以上。' },
                    { id: 8, role: 'customer', time: '2026/01/28 10:16:32', text: '那挺快的。这个服务收费吗？' },
                    { id: 9, role: 'robot', time: '2026/01/28 10:16:41', text: '批量地理编码按次数收费，企业版用户享受优惠价格。我可以给您发一份详细的价格表。' },
                    { id: 10, role: 'customer', time: '2026/01/28 10:16:50', text: '好的，麻烦发给我。另外，有测试环境可以先试试吗？' },
                    { id: 11, role: 'robot', time: '2026/01/28 10:16:59', text: '当然有。我给您开通测试账号，您可以先用小批量数据测试一下效果。' },
                    { id: 12, role: 'customer', time: '2026/01/28 10:17:08', text: '太好了，谢谢！' }
                ],
                extra_record_13: [
                    { id: 1, role: 'robot', time: '2026/01/28 15:20:15', text: '您好，百度地图开放平台商务部。看到您最近在评估多家地图服务商，想了解一下您的选择标准是什么？' },
                    { id: 2, role: 'customer', time: '2026/01/28 15:20:23', text: '主要考虑价格、数据准确性和技术支持这几个方面。' },
                    { id: 3, role: 'robot', time: '2026/01/28 15:20:32', text: '这些确实是核心因素。在数据准确性方面，我们的POI数据覆盖全国2800多个城市，月度更新率达到98%。' },
                    { id: 4, role: 'customer', time: '2026/01/28 15:20:41', text: '听起来不错。和其他服务商相比，你们的优势在哪里？' },
                    { id: 5, role: 'robot', time: '2026/01/28 15:20:50', text: '除了数据全面，我们在路线规划算法和实时交通信息方面有明显优势。而且百度地图日活用户超过2亿，数据实时性更好。' },
                    { id: 6, role: 'customer', time: '2026/01/28 15:20:59', text: '那技术支持方面呢？' },
                    { id: 7, role: 'robot', time: '2026/01/28 15:21:08', text: '我们有专业的技术支持团队，工作日响应时间在2小时内，紧急问题可以提供7*24小时支持。' },
                    { id: 8, role: 'customer', time: '2026/01/28 15:21:17', text: '价格方面能给些优惠吗？我们是创业公司，预算有限。' },
                    { id: 9, role: 'robot', time: '2026/01/28 15:21:26', text: '对于创业公司，我们有专门的扶持计划。前6个月可以享受5折优惠，还提供100万次免费调用额度。' },
                    { id: 10, role: 'customer', time: '2026/01/28 15:21:35', text: '这个政策挺吸引人的。我们内部讨论一下，下周给你答复。' },
                    { id: 11, role: 'robot', time: '2026/01/28 15:21:44', text: '好的，期待您的好消息。有任何问题随时联系我！' }
                ],
                extra_record_14: [
                    { id: 1, role: 'robot', time: '2026/01/29 09:45:20', text: '您好，这里是百度地图技术团队。看到您的应用集成了我们的导航SDK，想了解一下实际使用效果如何？' },
                    { id: 2, role: 'customer', time: '2026/01/29 09:45:28', text: '总体挺好的，导航准确率很高，用户反馈也不错。' },
                    { id: 3, role: 'robot', time: '2026/01/29 09:45:37', text: '太好了！有没有遇到什么技术难题需要我们帮助解决的？' },
                    { id: 4, role: 'customer', time: '2026/01/29 09:45:46', text: '有一个问题，就是在地下停车场GPS信号不好，定位会飘。' },
                    { id: 5, role: 'robot', time: '2026/01/29 09:45:55', text: '这是GPS的通用问题。我们有室内定位解决方案，通过Wi-Fi和蓝牙信号辅助定位，可以大大改善地下环境的定位精度。' },
                    { id: 6, role: 'customer', time: '2026/01/29 09:46:04', text: '这个方案需要额外部署硬件吗？' },
                    { id: 7, role: 'robot', time: '2026/01/29 09:46:13', text: '不需要额外硬件。我们利用现有的Wi-Fi热点和蓝牙beacon就可以实现定位。只需要采集一次停车场的指纹信息。' },
                    { id: 8, role: 'customer', time: '2026/01/29 09:46:22', text: '采集指纹信息复杂吗？' },
                    { id: 9, role: 'robot', time: '2026/01/29 09:46:31', text: '我们提供采集工具，一般半天就能完成一个停车场的数据采集。而且我们可以派工程师现场协助。' },
                    { id: 10, role: 'customer', time: '2026/01/29 09:46:40', text: '那太好了，我们有几个重点商场的停车场需要优化。' },
                    { id: 11, role: 'robot', time: '2026/01/29 09:46:49', text: '没问题，我安排工程师和您对接，制定详细的实施方案。' },
                    { id: 12, role: 'customer', time: '2026/01/29 09:46:58', text: '好的，谢谢！' }
                ],
                extra_record_15: [
                    { id: 1, role: 'robot', time: '2026/01/29 14:10:30', text: '您好，百度地图产品部门回访。看到您一直在使用我们的路况查询API，有什么改进建议吗？' },
                    { id: 2, role: 'customer', time: '2026/01/29 14:10:38', text: '功能挺全的，就是希望路况信息更新能更及时一些。' },
                    { id: 3, role: 'robot', time: '2026/01/29 14:10:47', text: '明白。目前免费版的路况数据是5分钟更新一次，企业版可以做到1分钟更新。' },
                    { id: 4, role: 'customer', time: '2026/01/29 14:10:56', text: '1分钟更新对我们来说就足够了。升级企业版还有其他好处吗？' },
                    { id: 5, role: 'robot', time: '2026/01/29 14:11:05', text: '企业版除了高频路况数据，还提供历史路况分析、拥堵预测等高级功能，可以帮助您做更准确的路线规划。' },
                    { id: 6, role: 'customer', time: '2026/01/29 14:11:14', text: '拥堵预测听起来很有用。这个准确吗？' },
                    { id: 7, role: 'robot', time: '2026/01/29 14:11:23', text: '我们基于海量历史数据和机器学习算法，预测准确率可以达到85%以上。很多物流公司都在使用这个功能优化配送路线。' },
                    { id: 8, role: 'customer', time: '2026/01/29 14:11:32', text: '我们也是做物流的，确实需要这个功能。' },
                    { id: 9, role: 'robot', time: '2026/01/29 14:11:41', text: '那太合适了。我给您发一份物流行业的解决方案和案例，您可以参考一下。' },
                    { id: 10, role: 'customer', time: '2026/01/29 14:11:50', text: '好的，麻烦了。顺便问一下，升级大概需要多少费用？' },
                    { id: 11, role: 'robot', time: '2026/01/29 14:11:59', text: '企业版基础套餐是1999元/月，包含路况、导航、POI等全套服务。物流行业用户还有额外8折优惠。' },
                    { id: 12, role: 'customer', time: '2026/01/29 14:12:08', text: '价格还可以接受，我考虑一下。' }
                ],
                extra_record_16: [
                    { id: 1, role: 'robot', time: '2026/01/30 10:30:15', text: '您好，我是百度地图的客户经理。看到您最近在测试我们的路径规划API，测试结果怎么样？' },
                    { id: 2, role: 'customer', time: '2026/01/30 10:30:23', text: '还不错，规划的路线基本符合预期。' },
                    { id: 3, role: 'robot', time: '2026/01/30 10:30:32', text: '太好了。有没有发现什么需要优化的地方？' },
                    { id: 4, role: 'customer', time: '2026/01/30 10:30:41', text: '有时候推荐的路线会绕远，虽然避开拥堵，但时间反而更长。' },
                    { id: 5, role: 'robot', time: '2026/01/30 10:30:50', text: '明白您的意思。我们的路径规划有多种策略可选，包括最短时间、最短距离、躲避拥堵等，您可以根据业务需求选择合适的策略。' },
                    { id: 6, role: 'customer', time: '2026/01/30 10:30:59', text: '这个在文档的哪里有说明？' },
                    { id: 7, role: 'robot', time: '2026/01/30 10:31:08', text: '在路径规划API的参数说明里，有一个tactics参数专门用来设置规划策略。我把相关文档链接发给您。' },
                    { id: 8, role: 'customer', time: '2026/01/30 10:31:17', text: '好的，我研究一下。另外，能不能自定义一些规则？' },
                    { id: 9, role: 'robot', time: '2026/01/30 10:31:26', text: '可以的。企业版支持设置途经点、避让区域、限行规则等高级功能，能满足更复杂的路线规划需求。' },
                    { id: 10, role: 'customer', time: '2026/01/30 10:31:35', text: '那挺好的，我们确实有一些特殊需求。' },
                    { id: 11, role: 'robot', time: '2026/01/30 10:31:44', text: '如果有具体需求，可以随时告诉我，我安排技术专家协助您实现。' }
                ],
                extra_record_17: [
                    { id: 1, role: 'robot', time: '2026/01/30 15:15:20', text: '您好，百度地图技术支持。注意到您的账号昨天有大量的API调用失败，想确认一下是否遇到了什么问题？' },
                    { id: 2, role: 'customer', time: '2026/01/30 15:15:28', text: '是的，我们的应用一直报错，说密钥无效。' },
                    { id: 3, role: 'robot', time: '2026/01/30 15:15:37', text: '让我查一下...看到了，您的密钥前天刚过期。需要在开发者后台重新生成一个新密钥。' },
                    { id: 4, role: 'customer', time: '2026/01/30 15:15:46', text: '哦对，我忘记续期了。新生成的密钥可以马上用吗？' },
                    { id: 5, role: 'robot', time: '2026/01/30 15:15:55', text: '是的，生成后立即生效。另外建议您设置密钥过期提醒，避免类似问题再次发生。' },
                    { id: 6, role: 'customer', time: '2026/01/30 15:16:04', text: '好的，我现在就去设置。这个提醒在哪里配置？' },
                    { id: 7, role: 'robot', time: '2026/01/30 15:16:13', text: '在开发者后台的账号设置里，有一个消息通知选项，可以设置密钥即将过期时提前30天邮件提醒。' },
                    { id: 8, role: 'customer', time: '2026/01/30 15:16:22', text: '明白了，我马上去操作。谢谢提醒！' },
                    { id: 9, role: 'robot', time: '2026/01/30 15:16:31', text: '不客气。如果还有其他问题，随时联系我们。' },
                    { id: 10, role: 'customer', time: '2026/01/30 15:16:40', text: '好的，再见！' }
                ],
                extra_record_18: [
                    { id: 1, role: 'robot', time: '2026/01/31 09:20:15', text: '您好，我是百度地图的行业顾问。了解到您在做智慧城市相关项目，我们有一些专门的解决方案可以分享。' },
                    { id: 2, role: 'customer', time: '2026/01/31 09:20:23', text: '哦？什么样的方案？' },
                    { id: 3, role: 'robot', time: '2026/01/31 09:20:32', text: '我们针对智慧城市场景，提供交通流量监测、公共交通优化、应急指挥调度等一体化解决方案。' },
                    { id: 4, role: 'customer', time: '2026/01/31 09:20:41', text: '听起来挺全面的。你们有实际的案例吗？' },
                    { id: 5, role: 'robot', time: '2026/01/31 09:20:50', text: '有的，我们已经在北京、上海、深圳等30多个城市落地了智慧交通项目。比如深圳的智能信号灯系统就是基于我们的平台。' },
                    { id: 6, role: 'customer', time: '2026/01/31 09:20:59', text: '效果怎么样？' },
                    { id: 7, role: 'robot', time: '2026/01/31 09:21:08', text: '深圳项目上线后，主干道通行效率提升了20%，拥堵时长减少了15%。我可以给您发一份详细的案例报告。' },
                    { id: 8, role: 'customer', time: '2026/01/31 09:21:17', text: '好的，我们正在做可行性研究，需要参考一些成功案例。' },
                    { id: 9, role: 'robot', time: '2026/01/31 09:21:26', text: '没问题。另外，如果您需要，我们也可以安排实地考察，让您亲自体验我们的系统。' },
                    { id: 10, role: 'customer', time: '2026/01/31 09:21:35', text: '那太好了，等我们内部讨论后再联系你安排。' },
                    { id: 11, role: 'robot', time: '2026/01/31 09:21:44', text: '好的，期待与您的合作！' }
                ],
                extra_record_19: [
                    { id: 1, role: 'robot', time: '2026/01/31 14:45:30', text: '您好，百度地图客服中心。看到您提交了一个关于地图展示样式的问题，现在来帮您解答。' },
                    { id: 2, role: 'customer', time: '2026/01/31 14:45:38', text: '是的，我想把地图改成深色主题，但是找不到相关设置。' },
                    { id: 3, role: 'robot', time: '2026/01/31 14:45:47', text: '我们支持自定义地图样式，包括深色主题。您可以使用mapStyle参数来设置。' },
                    { id: 4, role: 'customer', time: '2026/01/31 14:45:56', text: '具体怎么设置？有示例代码吗？' },
                    { id: 5, role: 'robot', time: '2026/01/31 14:46:05', text: '有的。我们提供了多种预设样式，包括dark、light、normal等。您只需要在初始化地图时设置mapStyle: "dark"就可以了。' },
                    { id: 6, role: 'customer', time: '2026/01/31 14:46:14', text: '那如果我想更细致地定制样式呢？比如改变道路颜色。' },
                    { id: 7, role: 'robot', time: '2026/01/31 14:46:23', text: '这个需要使用我们的在线样式编辑器，可以详细设置每个元素的颜色、透明度等属性。编辑完成后导出配置文件即可。' },
                    { id: 8, role: 'customer', time: '2026/01/31 14:46:32', text: '听起来很灵活。在线编辑器在哪里可以找到？' },
                    { id: 9, role: 'robot', time: '2026/01/31 14:46:41', text: '在开发者后台的工具箱里，有一个"地图样式编辑器"入口。我把详细的使用教程也发给您。' },
                    { id: 10, role: 'customer', time: '2026/01/31 14:46:50', text: '太好了，我去试试看。谢谢！' },
                    { id: 11, role: 'robot', time: '2026/01/31 14:46:59', text: '不客气。有任何问题随时联系我们！' }
                ],
                extra_record_20: [
                    { id: 1, role: 'robot', time: '2026/02/01 10:10:20', text: '您好，我是百度地图的数据分析师。注意到您最近在大量调用POI搜索接口，想了解一下是否有数据质量方面的反馈？' },
                    { id: 2, role: 'customer', time: '2026/02/01 10:10:28', text: '总体还可以，就是有些小众类型的POI搜不到。' },
                    { id: 3, role: 'robot', time: '2026/02/01 10:10:37', text: '您具体是指哪些类型的POI呢？' },
                    { id: 4, role: 'customer', time: '2026/02/01 10:10:46', text: '比如宠物医院、手机维修店这类小店铺，覆盖不太全。' },
                    { id: 5, role: 'robot', time: '2026/01/31 10:10:55', text: '明白了。这类长尾POI确实是我们持续补充的重点。您可以通过开发者平台的数据反馈功能，提交缺失的POI信息。' },
                    { id: 6, role: 'customer', time: '2026/02/01 10:11:04', text: '提交后多久能更新？' },
                    { id: 7, role: 'robot', time: '2026/02/01 10:11:13', text: '一般审核通过后3-5个工作日就会更新到地图上。对于企业用户提交的数据，我们会优先处理。' },
                    { id: 8, role: 'customer', time: '2026/02/01 10:11:22', text: '那挺快的。另外，你们的POI数据可以批量导出吗？' },
                    { id: 9, role: 'robot', time: '2026/02/01 10:11:31', text: '可以的。企业版用户可以使用批量下载功能，按区域或类别导出POI数据。不过需要遵守我们的数据使用协议。' },
                    { id: 10, role: 'customer', time: '2026/02/01 10:11:40', text: '好的，我了解一下协议内容。谢谢！' },
                    { id: 11, role: 'robot', time: '2026/02/01 10:11:49', text: '不客气，有任何数据方面的需求都可以联系我。' }
                ],
                // 为其余的extra_record也添加默认对话内容
                extra_record_21: [
                    { id: 1, role: 'robot', time: '2026/02/01 15:30:10', text: '您好，百度地图开放平台。看到您最近在使用我们的驾车导航服务，想了解一下使用体验如何？' },
                    { id: 2, role: 'customer', time: '2026/02/01 15:30:18', text: '挺好的，导航语音播报很清晰，路线也准确。' },
                    { id: 3, role: 'robot', time: '2026/02/01 15:30:27', text: '太好了！您主要用在什么场景？' },
                    { id: 4, role: 'customer', time: '2026/02/01 15:30:36', text: '我们是做货运的，司机需要频繁导航去不同的目的地。' },
                    { id: 5, role: 'robot', time: '2026/02/01 15:30:45', text: '那我们的货车导航功能应该很适合您。可以设置车辆高度、重量等参数，避开限行路段。' },
                    { id: 6, role: 'customer', time: '2026/02/01 15:30:54', text: '这个功能我们还没用上，怎么开通？' },
                    { id: 7, role: 'robot', time: '2026/02/01 15:31:03', text: '货车导航是企业版的高级功能，需要升级套餐。我可以给您详细介绍一下。' },
                    { id: 8, role: 'customer', time: '2026/02/01 15:31:12', text: '好的，你说说看。' },
                    { id: 9, role: 'robot', time: '2026/02/01 15:31:21', text: '货车导航支持多种车型设置，还能实时规避限行、限高路段，特别适合物流行业。' },
                    { id: 10, role: 'customer', time: '2026/02/01 15:31:30', text: '听起来很实用，价格多少？' },
                    { id: 11, role: 'robot', time: '2026/02/01 15:31:39', text: '企业版基础套餐包含这个功能，月费1999元。我把详细资料发给您。' }
                ],
                extra_record_22: [
                    { id: 1, role: 'robot', time: '2026/02/02 09:15:25', text: '您好，我是百度地图的技术顾问。看到您在集成我们的JavaScript API，遇到什么困难了吗？' },
                    { id: 2, role: 'customer', time: '2026/02/02 09:15:33', text: '是的，地图加载速度有点慢，影响用户体验。' },
                    { id: 3, role: 'robot', time: '2026/02/02 09:15:42', text: '加载慢可能有几个原因。首先确认一下，您是否使用了异步加载？' },
                    { id: 4, role: 'customer', time: '2026/02/02 09:15:51', text: '没有，我是直接在head标签里引入的脚本。' },
                    { id: 5, role: 'robot', time: '2026/02/02 09:16:00', text: '建议改用异步加载方式，可以避免阻塞页面渲染。另外，也可以使用按需加载模式，只加载需要的功能模块。' },
                    { id: 6, role: 'customer', time: '2026/02/02 09:16:09', text: '按需加载怎么实现？' },
                    { id: 7, role: 'robot', time: '2026/02/02 09:16:18', text: '在引入API时，通过v参数指定需要的功能模块。比如只需要基础地图，就设置v=3.0&services=map。' },
                    { id: 8, role: 'customer', time: '2026/02/02 09:16:27', text: '明白了，我去优化一下。还有其他优化建议吗？' },
                    { id: 9, role: 'robot', time: '2026/02/02 09:16:36', text: '可以启用地图瓦片缓存，减少重复请求。我把性能优化的完整指南发给您。' },
                    { id: 10, role: 'customer', time: '2026/02/02 09:16:45', text: '太好了，谢谢你的帮助！' }
                ],
                extra_record_23: [
                    { id: 1, role: 'robot', time: '2026/02/02 14:20:15', text: '您好，百度地图商务部。了解到您的公司规模在快速扩张，我们有一些企业级服务想和您介绍。' },
                    { id: 2, role: 'customer', time: '2026/02/02 14:20:23', text: '哦？什么样的服务？' },
                    { id: 3, role: 'robot', time: '2026/02/02 14:20:32', text: '我们为大型企业提供专属的地图服务方案，包括独立部署、定制化开发、专属技术支持等。' },
                    { id: 4, role: 'customer', time: '2026/02/02 14:20:41', text: '独立部署是什么意思？' },
                    { id: 5, role: 'robot', time: '2026/02/02 14:20:50', text: '就是在您的私有云环境部署地图服务，数据完全由您掌控，满足数据安全和合规要求。' },
                    { id: 6, role: 'customer', time: '2026/02/02 14:20:59', text: '这个我们确实需要，我们是金融行业，对数据安全要求很高。' },
                    { id: 7, role: 'robot', time: '2026/02/02 14:21:08', text: '那正好，我们已经为多家银行和保险公司提供私有化部署服务，有成熟的解决方案。' },
                    { id: 8, role: 'customer', time: '2026/02/02 14:21:17', text: '价格方面怎么算？' },
                    { id: 9, role: 'robot', time: '2026/02/02 14:21:26', text: '私有化部署是按项目收费，根据部署规模和定制需求报价。我安排专家和您详细沟通一下？' },
                    { id: 10, role: 'customer', time: '2026/02/02 14:21:35', text: '好的，安排一个时间，我们领导也会参加。' },
                    { id: 11, role: 'robot', time: '2026/02/02 14:21:44', text: '没问题，我会准备一份详细的方案。期待与您的会面！' }
                ],
                extra_record_24: [
                    { id: 1, role: 'robot', time: '2026/02/03 10:45:20', text: '您好，百度地图用户研究部门。我们在做一个用户满意度调查，想占用您几分钟时间可以吗？' },
                    { id: 2, role: 'customer', time: '2026/02/03 10:45:28', text: '可以，你问吧。' },
                    { id: 3, role: 'robot', time: '2026/02/03 10:45:37', text: '首先，请您给我们的服务打个分，满分10分，您会打几分？' },
                    { id: 4, role: 'customer', time: '2026/02/03 10:45:46', text: '8分吧，总体还是挺满意的。' },
                    { id: 5, role: 'robot', time: '2026/02/03 10:45:55', text: '谢谢！那扣掉的2分主要是什么原因呢？' },
                    { id: 6, role: 'customer', time: '2026/02/03 10:46:04', text: '主要是技术文档有些地方写得不够详细，遇到问题要自己摸索。' },
                    { id: 7, role: 'robot', time: '2026/02/03 10:46:13', text: '感谢您的反馈！我们会加强文档建设。还有其他建议吗？' },
                    { id: 8, role: 'customer', time: '2026/02/03 10:46:22', text: '希望能多提供一些实际应用案例和代码示例。' },
                    { id: 9, role: 'robot', time: '2026/02/03 10:46:31', text: '好的，这个建议很有价值。我们会在下个版本的文档中增加更多案例。' },
                    { id: 10, role: 'customer', time: '2026/02/03 10:46:40', text: '那就太好了，期待改进！' },
                    { id: 11, role: 'robot', time: '2026/02/03 10:46:49', text: '感谢您的支持和建议，祝您使用愉快！' }
                ],
                extra_record_25: [
                    { id: 1, role: 'robot', time: '2026/02/03 15:10:30', text: '您好，我是百度地图的培训专员。看到您最近开通了企业版，我们为新用户提供免费的线上培训，您有兴趣参加吗？' },
                    { id: 2, role: 'customer', time: '2026/02/03 15:10:38', text: '有啊，都培训哪些内容？' },
                    { id: 3, role: 'robot', time: '2026/02/03 15:10:47', text: '主要包括API使用技巧、常见问题解决、性能优化、最佳实践分享等内容，大概2小时。' },
                    { id: 4, role: 'customer', time: '2026/02/03 15:10:56', text: '听起来很实用。是一对一培训吗？' },
                    { id: 5, role: 'robot', time: '2026/02/03 15:11:05', text: '我们有两种形式，公开课是多人参与，私教课是一对一。您可以根据需要选择。' },
                    { id: 6, role: 'customer', time: '2026/02/03 15:11:14', text: '私教课需要额外收费吗？' },
                    { id: 7, role: 'robot', time: '2026/02/03 15:11:23', text: '企业版用户享有每月2小时的免费私教服务。超出部分按每小时500元收费。' },
                    { id: 8, role: 'customer', time: '2026/02/03 15:11:32', text: '那我先报名一个公开课体验一下吧。' },
                    { id: 9, role: 'robot', time: '2026/02/03 15:11:41', text: '好的，我们最近的公开课是本周五下午3点，主题是"地图API性能优化实战"。' },
                    { id: 10, role: 'customer', time: '2026/02/03 15:11:50', text: '正好有时间，帮我报名吧。' },
                    { id: 11, role: 'robot', time: '2026/02/03 15:11:59', text: '好的，已经帮您报名。会议链接会提前发到您的邮箱。' }
                ],
                extra_record_26: [
                    { id: 1, role: 'robot', time: '2026/02/04 09:30:15', text: '您好，百度地图产品团队。我们最近推出了一个新功能，想邀请您作为首批体验用户。' },
                    { id: 2, role: 'customer', time: '2026/02/04 09:30:23', text: '什么新功能？' },
                    { id: 3, role: 'robot', time: '2026/02/04 09:30:32', text: '是一个智能路径推荐系统，基于AI算法，可以根据历史数据和实时路况，提供更优的路线建议。' },
                    { id: 4, role: 'customer', time: '2026/02/04 09:30:41', text: '听起来挺先进的。和现有的路径规划有什么区别？' },
                    { id: 5, role: 'robot', time: '2026/02/04 09:30:50', text: '传统规划主要基于静态地图数据，新系统会综合考虑时间段、天气、历史拥堵模式等多种因素，准确率提升30%以上。' },
                    { id: 6, role: 'customer', time: '2026/02/04 09:30:59', text: '这个对我们物流行业很有用。怎么申请体验？' },
                    { id: 7, role: 'robot', time: '2026/02/04 09:31:08', text: '您填写一下体验申请表，我们审核通过后会为您开通测试权限。测试期间完全免费。' },
                    { id: 8, role: 'customer', time: '2026/02/04 09:31:17', text: '好的，申请表在哪里？' },
                    { id: 9, role: 'robot', time: '2026/02/04 09:31:26', text: '我把链接发到您的邮箱，填写后我们会在3个工作日内处理。' },
                    { id: 10, role: 'customer', time: '2026/02/04 09:31:35', text: '太好了，我马上去填。' },
                    { id: 11, role: 'robot', time: '2026/02/04 09:31:44', text: '好的，期待您的反馈意见，帮助我们改进产品！' }
                ],
                extra_record_27: [
                    { id: 1, role: 'robot', time: '2026/02/04 14:15:20', text: '您好，百度地图市场部。我们在筹划一个开发者大会，想邀请您参加并分享您的使用经验。' },
                    { id: 2, role: 'customer', time: '2026/02/04 14:15:28', text: '开发者大会？什么时候举办？' },
                    { id: 3, role: 'robot', time: '2026/02/04 14:15:37', text: '计划在下个月15号，在北京国际会议中心。会有技术分享、产品发布、行业交流等环节。' },
                    { id: 4, role: 'customer', time: '2026/02/04 14:15:46', text: '听起来挺有意思的。我需要准备什么？' },
                    { id: 5, role: 'robot', time: '2026/02/04 14:15:55', text: '如果您愿意分享，可以准备一个20分钟的演讲，主题是您如何使用百度地图解决业务问题。' },
                    { id: 6, role: 'customer', time: '2026/02/04 14:16:04', text: '我可以讲讲我们在物流调度中的应用案例。' },
                    { id: 7, role: 'robot', time: '2026/02/04 14:16:13', text: '太好了！这个主题很有价值。参会的话，我们会报销差旅费用，还会赠送精美礼品。' },
                    { id: 8, role: 'customer', time: '2026/02/04 14:16:22', text: '那挺不错的。我确认一下行程，明天给你回复。' },
                    { id: 9, role: 'robot', time: '2026/02/04 14:16:31', text: '好的，期待您的参与。如果能来，我会把详细的活动安排发给您。' },
                    { id: 10, role: 'customer', time: '2026/02/04 14:16:40', text: '好的，谢谢邀请！' }
                ],
                extra_record_28: [
                    { id: 1, role: 'robot', time: '2026/02/05 10:20:25', text: '您好，我是百度地图的数据安全专员。我们注意到您的应用涉及用户位置数据，想和您沟通一下数据安全合规事宜。' },
                    { id: 2, role: 'customer', time: '2026/02/05 10:20:33', text: '好的，我们也很重视数据安全问题。' },
                    { id: 3, role: 'robot', time: '2026/02/05 10:20:42', text: '根据最新的数据保护法规，位置数据属于敏感个人信息，需要遵守严格的采集、存储和使用规范。' },
                    { id: 4, role: 'customer', time: '2026/02/05 10:20:51', text: '我们的做法有什么需要改进的吗？' },
                    { id: 5, role: 'customer', time: '2026/02/05 10:21:00', text: '建议您在采集位置前明确告知用户用途，并获得明确授权。另外，位置数据要做好加密存储。' },
                    { id: 6, role: 'customer', time: '2026/02/05 10:21:09', text: '这些我们都做了。还有其他要注意的吗？' },
                    { id: 7, role: 'robot', time: '2026/02/05 10:21:18', text: '还要注意数据的最小化原则，只采集必要的位置信息，并定期删除过期数据。我们提供数据安全检测工具，可以帮您评估。' },
                    { id: 8, role: 'customer', time: '2026/02/05 10:21:27', text: '这个工具怎么使用？' },
                    { id: 9, role: 'robot', time: '2026/02/05 10:21:36', text: '在开发者后台的安全中心可以找到，输入您的应用信息就能自动检测潜在的合规风险。' },
                    { id: 10, role: 'customer', time: '2026/02/05 10:21:45', text: '好的，我回去就测试一下。谢谢提醒！' },
                    { id: 11, role: 'robot', time: '2026/02/05 10:21:54', text: '不客气，数据安全是我们共同的责任。有问题随时联系我。' }
                ],
                extra_record_29: [
                    { id: 1, role: 'robot', time: '2026/02/05 15:45:15', text: '您好，百度地图客户成功部门。看到您使用我们的服务已经一年了，想了解一下您对我们服务的整体评价。' },
                    { id: 2, role: 'customer', time: '2026/02/05 15:45:23', text: '整体还是很满意的，帮我们解决了很多业务问题。' },
                    { id: 3, role: 'robot', time: '2026/02/05 15:45:32', text: '太好了！那在这一年中，我们的哪些服务对您帮助最大？' },
                    { id: 4, role: 'customer', time: '2026/02/05 15:45:41', text: '主要是技术支持，每次遇到问题都能快速响应解决，这点很重要。' },
                    { id: 5, role: 'robot', time: '2026/02/05 15:45:50', text: '谢谢认可！那您觉得我们还有什么地方需要改进？' },
                    { id: 6, role: 'customer', time: '2026/02/05 15:45:59', text: '希望能提供更多行业解决方案的案例分享，帮助我们更好地应用地图服务。' },
                    { id: 7, role: 'robot', time: '2026/02/05 15:46:08', text: '这个建议很好。我们正在筹划一个行业案例库，会定期分享各行业的最佳实践。' },
                    { id: 8, role: 'customer', time: '2026/02/05 15:46:17', text: '那太好了，期待上线！' },
                    { id: 9, role: 'robot', time: '2026/02/05 15:46:26', text: '另外，作为老客户，我们准备了一些续费优惠政策，您有兴趣了解吗？' },
                    { id: 10, role: 'customer', time: '2026/02/05 15:46:35', text: '当然有兴趣，什么优惠？' },
                    { id: 11, role: 'robot', time: '2026/02/05 15:46:44', text: '续费用户可以享受9折优惠，而且免费升级部分高级功能。我把详细方案发给您。' },
                    { id: 12, role: 'customer', time: '2026/02/05 15:46:53', text: '好的，我看看。谢谢！' }
                ],
                extra_record_30: [
                    { id: 1, role: 'robot', time: '2026/02/06 09:10:20', text: '您好，我是百度地图的合作伙伴经理。了解到您的公司业务发展很快，我们想探讨一下深度合作的可能性。' },
                    { id: 2, role: 'customer', time: '2026/02/06 09:10:28', text: '哦？什么样的合作？' },
                    { id: 3, role: 'robot', time: '2026/02/06 09:10:37', text: '我们可以为您提供定制化的地图解决方案，包括品牌联合、功能深度定制、数据共享等多种合作模式。' },
                    { id: 4, role: 'customer', time: '2026/02/06 09:10:46', text: '听起来不错。具体有什么好处？' },
                    { id: 5, role: 'robot', time: '2026/02/06 09:10:55', text: '除了价格优惠，您还能获得优先的技术支持、产品功能定制权、以及共同的市场推广机会。' },
                    { id: 6, role: 'customer', time: '2026/02/06 09:11:04', text: '我们确实需要一些定制功能。比如能不能在地图上叠加我们的业务数据？' },
                    { id: 7, role: 'robot', time: '2026/02/06 09:11:13', text: '完全可以。我们支持自定义图层，您可以将业务数据可视化展示在地图上，还支持交互操作。' },
                    { id: 8, role: 'customer', time: '2026/02/06 09:11:22', text: '那太好了。合作的具体流程是什么？' },
                    { id: 9, role: 'robot', time: '2026/02/06 09:11:31', text: '我们先安排一次详细的需求沟通会，然后制定合作方案，双方确认后签订战略合作协议。' },
                    { id: 10, role: 'customer', time: '2026/02/06 09:11:40', text: '听起来很专业。什么时候可以安排会议？' },
                    { id: 11, role: 'robot', time: '2026/02/06 09:11:49', text: '下周都可以，您看哪天方便？我带我们的技术总监和产品总监一起来拜访。' },
                    { id: 12, role: 'customer', time: '2026/02/06 09:11:58', text: '下周三下午吧，我们领导也会参加。' },
                    { id: 13, role: 'robot', time: '2026/02/06 09:12:07', text: '好的，我会提前准备好资料。期待我们的会面！' }
                ]
            };

            // 通话转文字弹窗组件
            const TranscriptModal = () => (
                <Modal
                    title="录音转文字"
                    open={transcriptModalVisible}
                    onCancel={() => {
                        setTranscriptModalVisible(false);
                        setCurrentTranscriptCallKey(null);
                    }}
                    footer={null}
                    width={720}
                    centered
                    maskClosable={true}
                    bodyStyle={{ padding: '16px 24px', maxHeight: '520px', overflowY: 'auto', background: '#EDEDED' }}
                >
                    <div style={{ paddingTop: '8px' }}>
                        {(callTranscripts[currentTranscriptCallKey] || []).length === 0 ? (
                            <div style={{ textAlign: 'center', color: '#999', padding: '40px 0' }}>
                                暂无转写内容
                            </div>
                        ) : (
                            callTranscripts[currentTranscriptCallKey].map((msg) => {
                                const isRobot = msg.role === 'robot';
                                return (
                                    <div
                                        key={msg.id}
                                        style={{
                                            display: 'flex',
                                            justifyContent: isRobot ? 'flex-end' : 'flex-start',
                                            marginBottom: '12px'
                                        }}
                                    >
                                        {!isRobot && (
                                            <Avatar
                                                style={{
                                                    backgroundColor: '#ffffff',
                                                    color: '#666',
                                                    marginRight: '8px'
                                                }}
                                                size={28}
                                            >
                                                <i data-lucide="user" style={{ width: '14px', height: '14px' }}></i>
                                            </Avatar>
                                        )}
                                        <div
                                            style={{
                                                maxWidth: '70%',
                                                backgroundColor: isRobot ? '#95EC69' : '#ffffff',
                                                color: '#000000',
                                                padding: '8px 12px',
                                                borderRadius: 12,
                                                borderTopLeftRadius: isRobot ? 12 : 2,
                                                borderTopRightRadius: isRobot ? 2 : 12,
                                                boxShadow: '0 1px 2px rgba(0,0,0,0.06)',
                                                fontSize: '13px',
                                                lineHeight: 1.6,
                                                whiteSpace: 'pre-wrap'
                                            }}
                                        >
                                            {msg.text}
                                        </div>
                                        {isRobot && (
                                            <Avatar
                                                style={{
                                                    backgroundColor: '#95EC69',
                                                    color: '#000',
                                                    marginLeft: '8px'
                                                }}
                                                size={28}
                                            >
                                                <i data-lucide="bot" style={{ width: '14px', height: '14px' }}></i>
                                            </Avatar>
                                        )}
                                    </div>
                                );
                            })
                        )}
                    </div>
                </Modal>
            );

            const columns = [
                { title: '通话ID', dataIndex: 'callId', key: 'callId', width: 180, fixed: 'left' },
                { title: '线索ID', dataIndex: 'leadId', key: 'leadId', width: 180 },
                { title: 'UID', dataIndex: 'uid', key: 'uid', width: 140 },
                { title: '联系人姓名', dataIndex: 'contactName', key: 'contactName', width: 120 },
                { title: '被叫号码', dataIndex: 'calleeNumber', key: 'calleeNumber', width: 140 },




                { title: '外呼任务名称', dataIndex: 'taskName', key: 'taskName', width: 180 },
                { title: '外呼机器人', dataIndex: 'robotName', key: 'robotName', width: 140 },
                { title: '触发短信', dataIndex: 'smsTriggered', key: 'smsTriggered', width: 100 },
                { title: '通话开始时间', dataIndex: 'callStartTime', key: 'callStartTime', width: 170 },
                {
                    title: '通话时长', 
                    dataIndex: 'callDuration', 
                    key: 'callDuration', 
                    width: 110,
                    render: (text, record) => {
                        // 未接通状态显示0分0秒
                        if (record.connectStatus === '未接通') {
                            return '0分0秒';
                        }
                        return text;
                    }
                },
                { title: '通话结束时间', dataIndex: 'callEndTime', key: 'callEndTime', width: 170 },
                {
                    title: '接通状态',
                    dataIndex: 'connectStatus',
                    key: 'connectStatus',
                    width: 110,
                    render: (text) => {
                        const isConnected = text === '已接通';
                        return (
                            <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                                <span 
                                    style={{ 
                                        display: 'inline-block',
                                        width: '8px',
                                        height: '8px',
                                        borderRadius: '50%',
                                        backgroundColor: isConnected ? '#52c41a' : '#ff4d4f'
                                    }}
                                />
                                <span>{text}</span>
                            </div>
                        );
                    }
                },
                { title: '未接通原因', dataIndex: 'noConnectReason', key: 'noConnectReason', width: 120 },
                {
                    title: '操作',
                    key: 'action',
                    width: 100,
                    fixed: 'right',
                    render: (_, record) => (
                        <a 
                            href="#" 
                            style={{ color: '#1890ff' }}
                            onClick={(e) => {
                                e.preventDefault();
                                setCurrentDetailRecord(record);
                                setDetailDrawerVisible(true);
                            }}
                        >
                            查看详情
                        </a>
                    )
                }
            ];

            return (
                <div className="content-card">
                    {/* 固定标题栏 */}
                    <div className="fixed-header">
                        <h1 style={{ fontSize: '20px', fontWeight: 600, marginBottom: '12px', color: '#262626' }}>
                            智能外呼记录
                        </h1>
                        
                        {/* 选项卡标签 */}
                        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0' }}>
                            <div style={{ display: 'flex', borderBottom: '1px solid #f0f0f0' }}>
                                <div
                                    onClick={() => setActiveTab('records')}
                                    style={{
                                        padding: '8px 16px',
                                        cursor: 'pointer',
                                        borderBottom: activeTab === 'records' ? '2px solid #1890ff' : '2px solid transparent',
                                        color: activeTab === 'records' ? '#1890ff' : '#666',
                                        fontWeight: activeTab === 'records' ? 500 : 400,
                                        marginBottom: '-1px'
                                    }}
                                >
                                    外呼记录
                                </div>
                                <div
                                    onClick={() => setActiveTab('statistics')}
                                    style={{
                                        padding: '8px 16px',
                                        cursor: 'pointer',
                                        borderBottom: activeTab === 'statistics' ? '2px solid #1890ff' : '2px solid transparent',
                                        color: activeTab === 'statistics' ? '#1890ff' : '#666',
                                        fontWeight: activeTab === 'statistics' ? 500 : 400,
                                        marginBottom: '-1px'
                                    }}
                                >
                                    统计
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* 外呼记录选项卡内容 */}
                    {activeTab === 'records' && (
                        <>
                            {/* 操作按钮区域 */}
                            <div style={{ 
                                display: 'flex', 
                                justifyContent: 'flex-end', 
                                alignItems: 'center',
                                marginBottom: '12px',
                                gap: '12px'
                            }}>
                                <span style={{ fontSize: '14px', color: '#666' }}>最近刷新时间: {refreshTime}</span>
                                <div className="icon-btn" onClick={handleRefresh} style={{ cursor: 'pointer', padding: '4px', borderRadius: '4px', transition: 'background-color 0.3s' }} onMouseEnter={(e) => e.currentTarget.style.backgroundColor = '#f5f5f5'} onMouseLeave={(e) => e.currentTarget.style.backgroundColor = 'transparent'}>
                                    <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>
                                </div>
                                <div className="icon-btn" style={{ cursor: 'pointer', padding: '4px', borderRadius: '4px', transition: 'background-color 0.3s' }} onMouseEnter={(e) => e.currentTarget.style.backgroundColor = '#f5f5f5'} onMouseLeave={(e) => e.currentTarget.style.backgroundColor = 'transparent'}>
                                    <i data-lucide="settings" style={{ width: '16px', height: '16px' }}></i>
                                </div>
                            </div>

                            {/* 筛选区域 */}
                            <div style={{ 
                                background: '#fafafa', 
                                padding: '16px', 
                                borderRadius: '8px', 
                                marginBottom: '16px'
                            }}>
                                <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap', alignItems: 'flex-end' }}>
                                    {/* 搜索字段选择和输入 */}
                                    <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
                                        <span style={{ fontSize: '14px', color: '#666', whiteSpace: 'nowrap' }}>搜索：</span>
                                        <div style={{ display: 'flex', gap: '0' }}>
                                            <Select
                                                defaultValue="callId"
                                                style={{ width: 140 }}
                                                onChange={(value) => {
                                                    // TODO: 处理字段选择变化
                                                    console.log('搜索字段:', value);
                                                }}
                                            >
                                                <Option value="callId">通话ID</Option>
                                                <Option value="leadId">线索ID</Option>
                                                <Option value="uid">UID</Option>
                                                <Option value="contactName">联系人姓名</Option>
                                                <Option value="calleeNumber">被叫号码</Option>
                                                <Option value="robotName">外呼机器人</Option>
                                                <Option value="taskName">外呼任务名称</Option>
                                            </Select>
                                            <Input
                                                placeholder="请输入搜索内容"
                                                style={{ width: 200 }}
                                                allowClear
                                                onChange={(e) => {
                                                    // TODO: 处理搜索内容变化
                                                    console.log('搜索内容:', e.target.value);
                                                }}
                                            />
                                        </div>
                                    </div>

                                    {/* 通话日期 */}
                                    <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
                                        <span style={{ fontSize: '14px', color: '#666', whiteSpace: 'nowrap' }}>通话日期：</span>
                                        <RangePicker
                                            style={{ width: 280 }}
                                            placeholder={['开始时间', '结束时间']}
                                            onChange={(dates, dateStrings) => {
                                                // TODO: 处理日期范围变化
                                                console.log('日期范围:', dateStrings);
                                            }}
                                        />
                                    </div>

                                    {/* 接通状态 */}
                                    <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
                                        <span style={{ fontSize: '14px', color: '#666', whiteSpace: 'nowrap' }}>接通状态：</span>
                                        <Select
                                            defaultValue="all"
                                            style={{ width: 120 }}
                                            onChange={(value) => {
                                                // TODO: 处理接通状态变化
                                                console.log('接通状态:', value);
                                            }}
                                        >
                                            <Option value="all">全部</Option>
                                            <Option value="connected">已接通</Option>
                                            <Option value="notConnected">未接通</Option>
                                        </Select>
                                    </div>

                                    {/* 查询和重置按钮 */}
                                    <div style={{ display: 'flex', gap: '8px', marginLeft: 'auto' }}>
                                        <Button type="primary" onClick={() => {
                                            // TODO: 执行查询
                                            console.log('执行查询');
                                        }}>
                                            查询
                                        </Button>
                                        <Button onClick={() => {
                                            // TODO: 重置筛选条件
                                            console.log('重置筛选');
                                        }}>
                                            重置
                                        </Button>
                                    </div>
                                </div>
                            </div>

                            {/* 数据表格 - 恢复原有布局 */}
                            <div style={{ 
                                overflowX: 'auto',
                                overflowY: 'visible',
                                position: 'relative'
                            }}>
                                <Table
                                    columns={columns}
                                    dataSource={transformedRecords}
                                    pagination={{
                                        total: transformedRecords.length,
                                        pageSize: 20,
                                        showSizeChanger: true,
                                        pageSizeOptions: ['20', '50', '100'],
                                        showTotal: (total) => `共 ${total} 条`,
                                        showQuickJumper: true
                                    }}
                                    scroll={{ x: 'max-content', y: undefined }}
                                />
                            </div>
                        </>
                    )}

                    {/* 统计选项卡内容 - 外呼统计 */}
                    {activeTab === 'statistics' && (
                        <div style={{ padding: '16px 0' }}>
                            {/* AI提示信息 */}
                            <div style={{ 
                                display: 'flex',
                                alignItems: 'center',
                                gap: '6px',
                                marginBottom: '20px',
                                fontSize: '13px',
                                color: '#8c8c8c'
                            }}>
                                <i data-lucide="info" style={{ width: '14px', height: '14px' }}></i>
                                <span>统计结论由AI总结生成，当日数据将在次日生成。</span>
                            </div>

                            {/* 行业与场景统计 */}
                            <div style={{ marginBottom: '24px' }}>
                                <h3 style={{ fontSize: '16px', fontWeight: 500, marginBottom: '16px', color: '#262626' }}>行业与场景统计</h3>
                                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                                    {/* 行业分布 Top 10 空心饼图 */}
                                    <div style={{ background: '#fff', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0' }}>
                                        <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959' }}>行业分布 Top 10</h4>
                                        <div id="industryPieChart" style={{ width: '100%', height: '350px' }}></div>
                                    </div>
                                    
                                    {/* 应用场景 Top 10 条形图 */}
                                    <div style={{ background: '#fff', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0' }}>
                                        <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959' }}>应用场景 Top 10</h4>
                                        <div id="scenarioBarChart" style={{ width: '100%', height: '350px' }}></div>
                                    </div>
                                </div>
                            </div>

                            {/* 满意度统计 */}
                            <div style={{ marginBottom: '24px' }}>
                                <h3 style={{ fontSize: '16px', fontWeight: 500, marginBottom: '16px', color: '#262626' }}>满意度统计</h3>
                                <div style={{ display: 'grid', gridTemplateColumns: '400px 1fr 1fr', gap: '16px' }}>
                                    {/* 总体满意度仪表盘 */}
                                    <div style={{ background: '#fff', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0' }}>
                                        <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959' }}>总体满意度</h4>
                                        <div id="satisfactionGauge" style={{ width: '100%', height: '300px' }}></div>
                                    </div>
                                    
                                    {/* 正面反馈标签云 */}
                                    <div style={{ background: '#fff', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0' }}>
                                        <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959' }}>正面反馈</h4>
                                        <div id="positiveFeedbackTags" style={{ width: '100%', height: '300px' }}></div>
                                    </div>
                                    
                                    {/* 负面反馈标签云 */}
                                    <div style={{ background: '#fff', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0' }}>
                                        <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959' }}>负面反馈</h4>
                                        <div id="negativeFeedbackTags" style={{ width: '100%', height: '300px' }}></div>
                                    </div>
                                </div>
                            </div>

                            {/* 用户问题统计 */}
                            <div style={{ marginBottom: '24px' }}>
                                <h3 style={{ fontSize: '16px', fontWeight: 500, marginBottom: '16px', color: '#262626' }}>用户问题统计</h3>
                                <div style={{ background: '#fff', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0' }}>
                                    <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959' }}>高频问题 Top 10</h4>
                                    <div id="userQuestionsChart" style={{ width: '100%', height: '450px' }}></div>
                                </div>
                            </div>

                            {/* 竞品信息统计 */}
                            <div style={{ marginBottom: '24px' }}>
                                <h3 style={{ fontSize: '16px', fontWeight: 500, marginBottom: '16px', color: '#262626' }}>竞品信息统计</h3>
                                <div style={{ display: 'grid', gridTemplateColumns: '450px 1fr', gap: '16px' }}>
                                    {/* 竞品提及次数 */}
                                    <div style={{ background: '#fff', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0', display: 'flex', flexDirection: 'column', height: '400px' }}>
                                        <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959', flexShrink: 0 }}>竞品提及次数</h4>
                                        <div id="competitorMentionsChart" style={{ width: '100%', flex: 1, minHeight: 0 }}></div>
                                    </div>
                                    
                                    {/* 竞品对比分析 */}
                                    <div style={{ background: '#fafafa', padding: '16px', borderRadius: '8px', border: '1px solid #f0f0f0', display: 'flex', flexDirection: 'column', height: '400px' }}>
                                        <h4 style={{ fontSize: '14px', fontWeight: 500, marginBottom: '12px', color: '#595959', flexShrink: 0 }}>竞品对比分析</h4>
                                        <div id="competitorComparisonCards" style={{ width: '100%', flex: 1, minHeight: 0, overflowY: 'auto', overflowX: 'hidden', paddingRight: '8px' }}></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* 录音转文字弹窗 */}
                    <TranscriptModal />

                    {/* 通话详情抽屉 */}
                    <Drawer
                        title={null}
                        placement="right"
                        onClose={() => {
                            setDetailDrawerVisible(false);
                            setCurrentDetailRecord(null);
                        }}
                        open={detailDrawerVisible}
                        width="66.666%"
                        closable={true}
                        style={{ zIndex: 1000 }}
                        bodyStyle={{ padding: 0, height: '100%', overflow: 'hidden' }}
                        headerStyle={{ display: 'none' }}
                    >
                        {currentDetailRecord && (
                            <div style={{ display: 'flex', height: '100%' }}>
                                {/* 左侧通话内容区域 */}
                                <div style={{ flex: 1, display: 'flex', flexDirection: 'column', borderRight: '1px solid #f0f0f0' }}>
                                    {/* 顶部标题栏 */}
                                    <div style={{ 
                                        padding: '16px 20px', 
                                        borderBottom: '1px solid #f0f0f0',
                                        display: 'flex',
                                        alignItems: 'center',
                                        background: '#fff'
                                    }}>
                                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                            <span style={{ fontSize: '16px', fontWeight: 600, color: '#262626' }}>通话详情</span>
                                        </div>
                                    </div>

                                    {/* 通话内容滚动区域 */}
                                    <div style={{ 
                                        flex: 1, 
                                        overflow: 'auto', 
                                        padding: '20px',
                                        background: '#f5f5f5'
                                    }}>
                                        {/* 检查接通状态 */}
                                        {currentDetailRecord.connectStatus === '未接通' ? (
                                            <div style={{ textAlign: 'center', padding: '60px 20px', color: '#8c8c8c' }}>
                                                <i data-lucide="phone-off" style={{ width: '48px', height: '48px', marginBottom: '16px', color: '#d9d9d9' }}></i>
                                                <h4 style={{ fontSize: '16px', marginBottom: '8px', color: '#262626' }}>未接通</h4>
                                                <p>通话未能接通，没有录音记录</p>
                                                <p style={{ fontSize: '12px', marginTop: '4px', color: '#999' }}>
                                                    未接通原因：{currentDetailRecord.noConnectReason || '未知'}
                                                </p>
                                            </div>
                                        ) : (
                                            <>
                                                {/* 时间标记 - 仅已接通显示 */}
                                                <div style={{ textAlign: 'center', marginBottom: '20px' }}>
                                                    <span style={{ 
                                                        fontSize: '12px', 
                                                        color: '#8c8c8c', 
                                                        background: '#e8e8e8',
                                                        padding: '4px 12px',
                                                        borderRadius: '10px'
                                                    }}>
                                                        {currentDetailRecord.callStartTime}
                                                    </span>
                                                </div>

                                                {/* 对话消息列表 - 仅已接通显示 */}
                                                {callTranscripts[currentDetailRecord.key] && callTranscripts[currentDetailRecord.key].length > 0 ? (
                                                    callTranscripts[currentDetailRecord.key].map((msg, index) => {
                                                        const isRobot = msg.role === 'robot';
                                                        return (
                                                            <div 
                                                                key={msg.id || index}
                                                                style={{ 
                                                                    display: 'flex', 
                                                                    justifyContent: isRobot ? 'flex-end' : 'flex-start',
                                                                    marginBottom: '16px'
                                                                }}
                                                            >
                                                                {/* 被叫用户消息 - 左侧 */}
                                                                {!isRobot && (
                                                                    <div style={{ display: 'flex', maxWidth: '70%' }}>
                                                                        <Avatar 
                                                                            style={{ 
                                                                                backgroundColor: '#52c41a', 
                                                                                marginRight: '8px',
                                                                                flexShrink: 0
                                                                            }} 
                                                                            size={36}
                                                                            icon={<i data-lucide="user" style={{ width: '16px', height: '16px' }}></i>}
                                                                        />
                                                                        <div>
                                                                            <div style={{ fontSize: '12px', color: '#8c8c8c', marginBottom: '4px' }}>
                                                                                被叫用户
                                                                            </div>
                                                                            <div style={{ 
                                                                                background: '#fff', 
                                                                                padding: '10px 14px', 
                                                                                borderRadius: '0 12px 12px 12px',
                                                                                fontSize: '14px',
                                                                                lineHeight: 1.6,
                                                                                color: '#262626',
                                                                                boxShadow: '0 1px 2px rgba(0,0,0,0.06)'
                                                                            }}>
                                                                                {msg.text}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                )}

                                                                {/* 机器人消息 - 右侧 */}
                                                                {isRobot && (
                                                                    <div style={{ display: 'flex', maxWidth: '70%' }}>
                                                                        <div style={{ textAlign: 'right' }}>
                                                                            <div style={{ fontSize: '12px', color: '#8c8c8c', marginBottom: '4px' }}>
                                                                                机器人名称
                                                                            </div>
                                                                            <div style={{ 
                                                                                background: '#1890ff', 
                                                                                padding: '10px 14px', 
                                                                                borderRadius: '12px 0 12px 12px',
                                                                                fontSize: '14px',
                                                                                lineHeight: 1.6,
                                                                                color: '#fff',
                                                                                boxShadow: '0 1px 2px rgba(0,0,0,0.1)'
                                                                            }}>
                                                                                {msg.text}
                                                                            </div>
                                                                        </div>
                                                                        <Avatar 
                                                                            style={{ 
                                                                                backgroundColor: '#722ed1',
                                                                                marginLeft: '8px',
                                                                                flexShrink: 0
                                                                            }} 
                                                                            size={36}
                                                                            icon={<i data-lucide="bot" style={{ width: '16px', height: '16px' }}></i>}
                                                                        />
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })
                                                ) : (
                                                    <div style={{ textAlign: 'center', padding: '40px', color: '#8c8c8c' }}>
                                                        <i data-lucide="message-square" style={{ width: '32px', height: '32px', marginBottom: '12px', color: '#d9d9d9' }}></i>
                                                        <p>暂无通话记录内容</p>
                                                    </div>
                                                )}
                                            </>
                                        )}
                                    </div>

                                    {/* 底部音频播放器 */}
                                    {currentDetailRecord.connectStatus === '已接通' && currentDetailRecord.recordingUrl && (
                                        <div style={{ 
                                            padding: '12px 20px', 
                                            borderTop: '1px solid #f0f0f0',
                                            background: '#fff',
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '12px'
                                        }}>
                                            <Button type="primary" shape="circle" icon={<i data-lucide="play" style={{ width: '14px', height: '14px' }}></i>} />
                                            <div style={{ flex: 1 }}>
                                                <audio 
                                                    controls 
                                                    src={currentDetailRecord.recordingUrl}
                                                    style={{ width: '100%', height: '32px' }}
                                                />
                                            </div>
                                        </div>
                                    )}
                                </div>

                                {/* 右侧信息面板 */}
                                <div style={{ width: '320px', display: 'flex', flexDirection: 'column', background: '#fff' }}>
                                    {/* 右侧选项卡 */}
                                    <div style={{ 
                                        display: 'flex', 
                                        borderBottom: '1px solid #f0f0f0',
                                        padding: '0 16px'
                                    }}>
                                        <div
                                            onClick={() => setDetailTab('callDetail')}
                                            style={{
                                                padding: '12px 16px',
                                                cursor: 'pointer',
                                                borderBottom: detailTab === 'callDetail' ? '2px solid #1890ff' : '2px solid transparent',
                                                color: detailTab === 'callDetail' ? '#1890ff' : '#666',
                                                fontWeight: detailTab === 'callDetail' ? 500 : 400,
                                                marginBottom: '-1px',
                                                fontSize: '14px'
                                            }}
                                        >
                                            通话详情
                                        </div>
                                        <div
                                            onClick={() => setDetailTab('customerVar')}
                                            style={{
                                                padding: '12px 16px',
                                                cursor: 'pointer',
                                                borderBottom: detailTab === 'customerVar' ? '2px solid #1890ff' : '2px solid transparent',
                                                color: detailTab === 'customerVar' ? '#1890ff' : '#666',
                                                fontWeight: detailTab === 'customerVar' ? 500 : 400,
                                                marginBottom: '-1px',
                                                fontSize: '14px'
                                            }}
                                        >
                                            通话总结
                                        </div>
                                    </div>

                                    {/* 右侧内容区域 */}
                                    <div style={{ flex: 1, overflow: 'auto', padding: '16px' }}>
                                        {detailTab === 'callDetail' && (
                                            <div>
                                                {/* 基本信息 */}
                                                <div style={{ marginBottom: '24px' }}>
                                                    <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>基本信息</h4>
                                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话ID</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                {currentDetailRecord.callId || '无'}
                                                            </span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>线索ID</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.leadId || '无'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>客户ID</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.uid || '无'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>联系人姓名</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.contactName || '-'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>被叫号码</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.calleeNumber || '-'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>外呼任务名称</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.taskName || '未知任务'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>外呼机器人</span>
                                                            <span style={{ color: '#1890ff', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.robotName || '默认机器人'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>触发短信</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.smsTriggered || '否'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话开始时间</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.callStartTime || '-'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话时长</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.callDuration || '0分0秒'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>通话结束时间</span>
                                                            <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>{currentDetailRecord.callEndTime || '-'}</span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>接通状态</span>
                                                            <span style={{ 
                                                                color: currentDetailRecord.connectStatus === '已接通' ? '#52c41a' : '#ff4d4f', 
                                                                fontSize: '13px',
                                                                marginLeft: '10px'
                                                            }}>
                                                                {currentDetailRecord.connectStatus || '未知'}
                                                            </span>
                                                        </div>
                                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                            <span style={{ color: '#8c8c8c', fontSize: '13px' }}>未接通原因</span>
                                                            <span style={{ 
                                                                color: currentDetailRecord.connectStatus === '未接通' ? '#ff4d4f' : '#8c8c8c', 
                                                                fontSize: '13px',
                                                                marginLeft: '10px'
                                                            }}>
                                                                {currentDetailRecord.noConnectReason || '-'}
                                                            </span>
                                                        </div>

                                                    </div>
                                                </div>

                                                {/* 意向标签 */}
                                                <div style={{ marginBottom: '24px' }}>
                                                    <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>意向标签</h4>
                                                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>
                                                        <Tag color="green">{currentDetailRecord.aiTags?.overallIntent || '高'}意向</Tag>
                                                        <Tag>{currentDetailRecord.aiTags?.industry || '未知行业'}</Tag>
                                                        {currentDetailRecord.aiTags?.businessScene && (
                                                            <Tag color="blue">{currentDetailRecord.aiTags.businessScene}</Tag>
                                                        )}
                                                    </div>
                                                </div>

                                            </div>
                                        )}

                                        {detailTab === 'customerVar' && (
                                            <div>
                                                {/* 大模型标签信息 */}
                                                <div style={{ marginBottom: '24px' }}>
                                                    <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>大模型标签信息</h4>
                                                    {currentDetailRecord.connectStatus === '已接通' ? (
                                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '10px' }}>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>是否再次回电</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.callAgain || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>业务应用场景</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.businessScene || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>整体意向</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.overallIntent || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>竞品情况</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.competitorInfo || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>正面评价</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.positiveFeedback || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>负面评价</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.negativeFeedback || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>持续调用的原因</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.continueReason || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>项目情况</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.projectStatus || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>未申请商用授权原因</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.noCommercialReason || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>行业</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.industry || '未获取'}
                                                                </span>
                                                            </div>
                                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                                <span style={{ color: '#8c8c8c', fontSize: '13px' }}>客户采购预算</span>
                                                                <span style={{ color: '#262626', fontSize: '13px', marginLeft: '10px' }}>
                                                                    {currentDetailRecord.aiTags?.budget || '未获取'}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    ) : (
                                                        <div style={{ fontSize: '13px', color: '#8c8c8c', fontStyle: 'italic', padding: '12px 0' }}>
                                                            未接通通话无大模型分析标签
                                                        </div>
                                                    )}
                                                </div>

                                                {/* 用户问题 */}
                                                <div>
                                                    <h4 style={{ fontSize: '14px', fontWeight: 600, color: '#262626', marginBottom: '12px' }}>用户问题</h4>
                                                    {currentDetailRecord.connectStatus === '已接通' ? (
                                                        <div style={{ fontSize: '13px', color: '#595959' }}>
                                                            {currentDetailRecord.pendingQuestions && currentDetailRecord.pendingQuestions.length > 0 ? (
                                                                currentDetailRecord.pendingQuestions.map((question, index) => (
                                                                    <div key={index} style={{ marginBottom: '8px', paddingLeft: '12px', borderLeft: '2px solid #e8e8e8' }}>
                                                                        {question}
                                                                    </div>
                                                                ))
                                                            ) : (
                                                                <div style={{ color: '#8c8c8c', fontStyle: 'italic' }}>暂无待明确问题</div>
                                                            )}
                                                        </div>
                                                    ) : (
                                                        <div style={{ fontSize: '13px', color: '#8c8c8c', fontStyle: 'italic', padding: '12px 0' }}>
                                                            未接通通话无用户问题记录
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}
                    </Drawer>
                </div>
            );
        };

        const App = () => {
            const [collapsed, setCollapsed] = useState(false);
            const [selectedKeys, setSelectedKeys] = useState(['workbench']);
            const [openKeys, setOpenKeys] = useState([]);
            const [showWeChatClient, setShowWeChatClient] = useState(false);

            // 刷新图标
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            });

            // 菜单配置
            const menuItems = [
                {
                    key: 'workbench',
                    label: '工作台',
                    icon: React.createElement('i', { 'data-lucide': 'layout-dashboard' })
                },
                {
                    key: 'lead_management',
                    label: '线索管理',
                    icon: React.createElement('i', { 'data-lucide': 'users' }),
                    children: [
                        {
                            key: 'lead_public_sea',
                            label: '线索公海',
                            children: [
                                { key: 'public_sea_dashboard', label: '公海大盘' },
                                { key: 'channel_public_sea', label: '渠道公海' },
                                { key: 'national_public_sea', label: '全国公海' },
                                { key: 'reserve_public_sea', label: '储备公海' }
                            ]
                        },
                        { key: 'lead_management_list', label: '线索管理' },
                        { key: 'my_leads', label: '我的线索' },
                        { key: 'lead_filing', label: '线索报备' }
                    ]
                },
                {
                    key: 'opportunity_management',
                    label: '商机管理',
                    icon: React.createElement('i', { 'data-lucide': 'target' })
                },
                {
                    key: 'order_management',
                    label: '订单管理',
                    icon: React.createElement('i', { 'data-lucide': 'shopping-cart' })
                },
                {
                    key: 'customer_management',
                    label: '客户管理',
                    icon: React.createElement('i', { 'data-lucide': 'user-check' })
                },
                {
                    key: 'contract_rebate',
                    label: '合同返点',
                    icon: React.createElement('i', { 'data-lucide': 'file-text' })
                },
                {
                    key: 'process_center',
                    label: '流程中心',
                    icon: React.createElement('i', { 'data-lucide': 'workflow' })
                },
                {
                    key: 'commercial_authorization',
                    label: '商用授权',
                    icon: React.createElement('i', { 'data-lucide': 'key' })
                },
                {
                    key: 'enterprise_wechat_management',
                    label: '企业微信管理',
                    icon: React.createElement('i', { 'data-lucide': 'message-square' }),
                    children: [
                        { key: 'global_search', label: '全局搜索' },
                        { key: 'employee_chat_records', label: '聊天记录' },
                        { key: 'voice_call_records', label: '语音通话记录' },
                        { key: 'employee_sensitive_records', label: '敏感行为记录' },
                        { key: 'data_statistics', label: '数据统计' },
                        {
                            key: 'wechat_settings',
                            label: '企业微信设置',
                            children: [
                                { key: 'sensitive_word_settings', label: '敏感词设置' },
                                { key: 'sensitive_behavior_settings', label: '敏感行为设置' }
                            ]
                        }
                    ]
                },
                {
                    key: 'call_center',
                    label: '呼叫中心',
                    icon: React.createElement('i', { 'data-lucide': 'phone' }),
                    children: [
                        { key: 'call_records', label: '通话记录', icon: React.createElement('i', { 'data-lucide': 'phone-call' }) },
                        { key: 'outbound_call_records', label: '智能外呼记录', icon: React.createElement('i', { 'data-lucide': 'phone-outgoing' }) }
                    ]
                },
                {
                    key: 'operation_management',
                    label: '运营管理',
                    icon: React.createElement('i', { 'data-lucide': 'settings' })
                },
                {
                    key: 'conflict_management',
                    label: '冲突管理',
                    icon: React.createElement('i', { 'data-lucide': 'alert-triangle' })
                },
                {
                    key: 'enterprise_management',
                    label: '企业管理',
                    icon: React.createElement('i', { 'data-lucide': 'building' })
                }
            ];

            // 表格数据
            const [tableData, setTableData] = useState([
                {
                    key: '1',
                    leadId: '479371',
                    uid: '5364506740',
                    rank: 0,
                    province: '江苏省',
                    certType: '企业认证',
                    certName: '连云港贵翔汽车销售服务有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '智能汽车',
                    region: '华东',
                    followUp: 0
                },
                {
                    key: '2',
                    leadId: '479370',
                    uid: '5364506739',
                    rank: 0,
                    province: '河北省',
                    certType: '企业认证',
                    certName: '河北邢临高速公路开发有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '交通管理',
                    region: '华北',
                    followUp: 0
                },
                {
                    key: '3',
                    leadId: '479369',
                    uid: '5364506738',
                    rank: 0,
                    province: '广东省',
                    certType: '企业认证',
                    certName: '深圳市某某科技有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '系统工具',
                    region: '华南',
                    followUp: 0
                },
                {
                    key: '4',
                    leadId: '479368',
                    uid: '5364506737',
                    rank: 0,
                    province: '北京市',
                    certType: '企业认证',
                    certName: '北京某某信息服务有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '信息服务',
                    region: '华北',
                    followUp: 0
                },
                {
                    key: '5',
                    leadId: '479367',
                    uid: '5364506736',
                    rank: 0,
                    province: '福建省',
                    certType: '企业认证',
                    certName: '厦门某某生活服务有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '生活服务',
                    region: '华东',
                    followUp: 0
                },
                {
                    key: '6',
                    leadId: '479366',
                    uid: '5364506735',
                    rank: 0,
                    province: '浙江省',
                    certType: '企业认证',
                    certName: '杭州某某科技有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '系统工具',
                    region: '华东',
                    followUp: 0
                },
                {
                    key: '7',
                    leadId: '479365',
                    uid: '5364506734',
                    rank: 0,
                    province: '山东省',
                    certType: '企业认证',
                    certName: '济南某某信息服务有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '信息服务',
                    region: '华东',
                    followUp: 0
                },
                {
                    key: '8',
                    leadId: '479364',
                    uid: '5364506733',
                    rank: 0,
                    province: '江苏省',
                    certType: '企业认证',
                    certName: '南京某某汽车服务有限公司',
                    leadSource: '企业认证',
                    specialPromo: '-',
                    industry: '智能汽车',
                    region: '华东',
                    followUp: 0
                }
            ]);

            const [selectedRowKeys, setSelectedRowKeys] = useState([]);

            // 表格列定义
            const columns = [
                {
                    title: <input 
                        type="checkbox" 
                        checked={selectedRowKeys.length === tableData.length && tableData.length > 0}
                        onChange={(e) => {
                            if (e.target.checked) {
                                setSelectedRowKeys(tableData.map(item => item.key));
                            } else {
                                setSelectedRowKeys([]);
                            }
                        }}
                    />,
                    dataIndex: 'checkbox',
                    key: 'checkbox',
                    width: 60,
                    fixed: 'left',
                    render: (_, record) => (
                        <input 
                            type="checkbox" 
                            checked={selectedRowKeys.includes(record.key)}
                            onChange={(e) => {
                                if (e.target.checked) {
                                    setSelectedRowKeys([...selectedRowKeys, record.key]);
                                } else {
                                    setSelectedRowKeys(selectedRowKeys.filter(key => key !== record.key));
                                }
                            }}
                        />
                    )
                },
                {
                    title: '线索ID',
                    dataIndex: 'leadId',
                    key: 'leadId',
                    width: 100,
                    render: (text) => <a href="#" style={{ color: '#1890ff' }}>{text}</a>
                },
                {
                    title: 'UID',
                    dataIndex: 'uid',
                    key: 'uid',
                    width: 120
                },
                {
                    title: (
                        <span style={{ display: 'inline-flex', alignItems: 'center' }}>
                            Rank
                            <span className="rank-sorter">
                                <span className="rank-sorter-icon active"></span>
                            </span>
                        </span>
                    ),
                    dataIndex: 'rank',
                    key: 'rank',
                    width: 100,
                    sorter: true,
                    render: (text) => text
                },
                {
                    title: '省',
                    dataIndex: 'province',
                    key: 'province',
                    width: 100
                },
                {
                    title: '认证类型',
                    dataIndex: 'certType',
                    key: 'certType',
                    width: 120
                },
                {
                    title: '认证名称',
                    dataIndex: 'certName',
                    key: 'certName',
                    width: 250
                },
                {
                    title: '线索来源',
                    dataIndex: 'leadSource',
                    key: 'leadSource',
                    width: 120
                },
                {
                    title: '专项推广',
                    dataIndex: 'specialPromo',
                    key: 'specialPromo',
                    width: 120
                },
                {
                    title: '行业',
                    dataIndex: 'industry',
                    key: 'industry',
                    width: 120
                },
                {
                    title: '区域',
                    dataIndex: 'region',
                    key: 'region',
                    width: 100
                },
                {
                    title: '跟进',
                    dataIndex: 'followUp',
                    key: 'followUp',
                    width: 80
                },
                {
                    title: '操作',
                    key: 'action',
                    width: 220,
                    fixed: 'right',
                    render: () => (
                        <Space>
                            <a href="#" style={{ color: '#1890ff' }}>编辑</a>
                            <a href="#" style={{ color: '#1890ff' }}>分发线索</a>
                            <a href="#" style={{ color: '#1890ff' }}>认领线索</a>
                        </Space>
                    )
                }
            ];

            // 获取当前时间
            const getCurrentTime = () => {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
            };

            const [refreshTime, setRefreshTime] = useState(getCurrentTime());

            const handleRefresh = () => {
                setRefreshTime(getCurrentTime());
                setTimeout(() => {
                    if (window.lucide) {
                        window.lucide.createIcons();
                    }
                }, 100);
            };

            // 确保图标在组件更新后重新渲染
            useEffect(() => {
                const timer = setInterval(() => {
                    if (window.lucide) {
                        window.lucide.createIcons();
                    }
                }, 500);
                return () => clearInterval(timer);
            }, []);

            return (
                <ConfigProvider>
                    <Layout style={{ minHeight: '100vh' }}>
                        <Sider
                            collapsible
                            collapsed={collapsed}
                            onCollapse={setCollapsed}
                            width={240}
                            className="dark-sider"
                            theme="dark"
                        >
                            <div className="sider-logo" style={{ padding: collapsed ? '8px' : '8px 16px', justifyContent: collapsed ? 'center' : 'flex-start' }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                                    {/* 图标 - 始终显示 */}
                                    <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ flexShrink: 0 }}>
                                        {/* 白色圆角背景 */}
                                        <rect width="36" height="36" rx="6" fill="white"/>
                                        {/* 红色定位针 */}
                                        <path d="M18 7C14.6863 7 12 9.68629 12 13C12 18 18 27 18 27C18 27 24 18 24 13C24 9.68629 21.3137 7 18 7Z" fill="#FF4D4F"/>
                                        <text x="18" y="15" fontFamily="Arial, sans-serif" fontSize="9" fill="white" textAnchor="middle" fontWeight="bold">du</text>
                                        {/* 底部装饰 */}
                                        <rect x="14" y="29" width="8" height="2" rx="1" fill="url(#iconGradient)"/>
                                        <defs>
                                            <linearGradient id="iconGradient" x1="0" y1="0" x2="8" y2="0">
                                                <stop offset="0%" stopColor="#FF4D4F"/>
                                                <stop offset="50%" stopColor="#FF4D4F"/>
                                                <stop offset="50%" stopColor="#4A90E2"/>
                                                <stop offset="100%" stopColor="#4A90E2"/>
                                            </linearGradient>
                                        </defs>
                                        {/* 地图底纹 - 简化 */}
                                        <path d="M6 22 L30 22" stroke="#E5E7EB" strokeWidth="0.5" />
                                        <path d="M10 22 L14 26" stroke="#E5E7EB" strokeWidth="0.5" />
                                        <path d="M26 22 L22 26" stroke="#E5E7EB" strokeWidth="0.5" />
                                    </svg>
                                    
                                    {/* 文字 - 仅展开显示 */}
                                    {!collapsed && (
                                        <div style={{ display: 'flex', flexDirection: 'column', lineHeight: '1.1' }}>
                                            <span style={{ color: 'white', fontSize: '15px', fontWeight: 'bold', letterSpacing: '0.5px' }}>百度地图</span>
                                            <div style={{ display: 'flex', alignItems: 'baseline' }}>
                                                <span style={{ color: 'rgba(255,255,255,0.85)', fontSize: '11px' }}>开放平台</span>
                                                <span style={{ color: 'white', fontSize: '12px', fontWeight: '800', marginLeft: '2px' }}>CRM</span>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                            <div className="menu-scroll-container">
                                <Menu
                                    mode="inline"
                                    selectedKeys={selectedKeys}
                                    openKeys={openKeys}
                                    onSelect={({ key }) => setSelectedKeys([key])}
                                    onOpenChange={(keys) => setOpenKeys(keys)}
                                    items={menuItems}
                                    theme="dark"
                                    style={{ borderRight: 0 }}
                                />
                            </div>
                        </Sider>
                        <Layout>
                            <Header className="light-header">
                                <div></div>
                                <div className="header-right">
                                    <button
                                        onClick={() => setShowWeChatClient(true)}
                                        style={{
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '6px',
                                            background: 'none',
                                            border: 'none',
                                            cursor: 'pointer',
                                            padding: '4px 8px',
                                            borderRadius: '4px',
                                            fontSize: '14px',
                                            color: '#333',
                                            transition: 'background-color 0.2s'
                                        }}
                                        onMouseEnter={(e) => {
                                            e.currentTarget.style.backgroundColor = '#f5f5f5';
                                        }}
                                        onMouseLeave={(e) => {
                                            e.currentTarget.style.backgroundColor = 'transparent';
                                        }}
                                    >
                                        <i data-lucide="message-circle" style={{ width: '16px', height: '16px' }}></i>
                                        <span>企业微信端</span>
                                    </button>
                                    <div className="notification-icon">
                                        <i data-lucide="bell" style={{ width: '16px', height: '16px' }}></i>
                                        <span className="notification-badge"></span>
                                    </div>
                                    <span style={{ fontSize: '14px', lineHeight: '40px' }}>田博文 (v_tianbowen)</span>
                                </div>
                            </Header>
                            <Content className="main-content">
                                {showWeChatClient ? (
                                    <WeChatClientPage onBack={() => setShowWeChatClient(false)} />
                                ) : selectedKeys.includes('workbench') ? (
                                    <Workbench />
                                ) : selectedKeys.includes('global_search') ? (
                                    <GlobalSearch />
                                ) : selectedKeys.includes('employee_chat_records') ? (
                                    <EmployeeChatRecords />
                                ) : selectedKeys.includes('my_leads') ? (
                                    <MyLeads />
                                ) : selectedKeys.includes('call_records') ? (
                                    <CallRecords />
                                ) : selectedKeys.includes('outbound_call_records') ? (
                                    <OutboundCallRecords />
                                ) : selectedKeys.includes('public_sea_dashboard') ? (
                                    <div className="content-card">
                                    <h1 style={{ fontSize: '20px', fontWeight: 600, marginBottom: '2px', color: '#262626' }}>
                                        公海大盘
                                    </h1>
                                    
                                    {/* 搜索筛选区域 */}
                                    <div className="search-section">
                                        <div className="search-left">
                                            <Select
                                                placeholder="认证名称"
                                                style={{ width: 120 }}
                                            >
                                                <Option value="all">全部</Option>
                                            </Select>
                                            <Input
                                                placeholder="请输入认证名称"
                                                style={{ width: 200 }}
                                            />
                                            <span style={{ color: '#666' }}>Rank:</span>
                                            <Input
                                                placeholder="最小值"
                                                style={{ width: 100 }}
                                            />
                                            <span style={{ color: '#666' }}>~</span>
                                            <Input
                                                placeholder="最大值"
                                                style={{ width: 100 }}
                                            />
                                        </div>
                                        <div className="search-right">
                                            <Button>重置</Button>
                                            <Button type="primary">查询</Button>
                                            <Button>
                                                展开 <i data-lucide="chevron-down" style={{ width: '14px', height: '14px', marginLeft: '4px' }}></i>
                                            </Button>
                                        </div>
                                    </div>

                                    {/* 表格操作按钮 */}
                                    <div className="table-actions">
                                        <div className="table-actions-left">
                                            <Button type="primary">新建线索</Button>
                                            <Button>批量分发</Button>
                                        </div>
                                        <div className="table-actions-right">
                                            <span>最近刷新时间: {refreshTime}</span>
                                            <div className="icon-btn" onClick={handleRefresh}>
                                                <i data-lucide="refresh-cw" style={{ width: '16px', height: '16px' }}></i>
                                            </div>
                                            <div className="icon-btn">
                                                <i data-lucide="info" style={{ width: '16px', height: '16px' }}></i>
                                            </div>
                                            <div className="icon-btn">
                                                <i data-lucide="settings" style={{ width: '16px', height: '16px' }}></i>
                                            </div>
                                        </div>
                                    </div>

                                    {/* 数据表格 */}
                                    <div style={{ 
                                        overflowX: 'auto',
                                        overflowY: 'visible',
                                        position: 'relative'
                                    }}>
                                        <Table
                                            columns={columns}
                                            dataSource={tableData}
                                            pagination={{
                                                total: tableData.length,
                                                pageSize: 10,
                                                showSizeChanger: true,
                                                showTotal: (total) => `共 ${total} 条`,
                                                showQuickJumper: true
                                            }}
                                            scroll={{ x: 'max-content', y: undefined }}
                                        />
                                    </div>
                                    </div>
                                ) : (
                                    <ComingSoon />
                                )}
                            </Content>
                        </Layout>
                    </Layout>
                </ConfigProvider>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>